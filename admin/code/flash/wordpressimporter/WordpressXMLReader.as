package  {		import flash.external.ExternalInterface;		public class WordpressXMLReader {		private var xmlData:XML;				// //////////////////////////////////////////////////////////////		public function WordpressXMLReader() {			// constructor code					}				// //////////////////////////////////////////////////////////////		public function process(data:String){						this.xmlData = new XML(data);			this.parseChannel();			this.parsePosts();		}				// //////////////////////////////////////////////////////////////				private function parseChannel(){			var channelData:XMLList = this.xmlData.channel;						var title:String = channelData.@title;			var nodeName:String = "";			var subNodeName:String = "";			var categories:String = ""; // csv list of categories 			var tags:String = ""; // csv list of tags 								// Get category list..........			var cat_nicename:String = "";			var cat_name:String = "";			var category_parent:String = "";			// <wp:category>			//     <wp:category_nicename>all</wp:category_nicename>			//     <wp:category_parent></wp:category_parent>			//     <wp:cat_name><![CDATA[All posts]]></wp:cat_name>			// </wp:category>			for each(var catNode:XML in channelData.*){				    				nodeName = catNode.name();				cat_nicename = "";				cat_name = "";				category_parent = "";								//trace(nodeName + " -- " + nodeName.indexOf("category"));							    if (nodeName.indexOf("category") > 0){										cat_nicename = ""; cat_name = ""; category_parent = ""; 										for each(var subNode:XML in catNode.*){						subNodeName = subNode.name();						if (subNodeName.indexOf("category_nicename") > 0){ cat_nicename = subNode.text();}						if (subNodeName.indexOf("cat_name") > 0){ cat_name = subNode.text();}						if (subNodeName.indexOf("category_parent") > 0){ category_parent = subNode.text();}					}										if (categories != ""){						categories += ",";					}					categories += cat_name;										//trace("Category: name = '" + cat_name + "' nice_name = '" + cat_nicename + "' category_parent = '" + category_parent + "'");				}											}									// Get tag list..........						var tag_name:String = "";			var tag_slug:String = "";						// <wp:tag>			//     <wp:tag_slug>awards</wp:tag_slug>			//     <wp:tag_name><![CDATA[awards]]></wp:tag_name>			// </wp:tag>						for each(var tagNode:XML in channelData.*){				    				nodeName = tagNode.name();				tag_name = ""; tag_slug = "";								//trace(nodeName + " -- " + nodeName.indexOf("category"));							    if (nodeName.indexOf("tag") > 0){										tag_name = ""; tag_slug = "";										for each(var subNode2:XML in tagNode.*){						subNodeName = subNode2.name();						if (subNodeName.indexOf("tag_slug") > 0){ tag_slug = subNode2.text();}						if (subNodeName.indexOf("tag_name") > 0){ tag_name = subNode2.text();}					}										if (tags != ""){						tags += ",";					}					tags += tag_name;										//trace("Tag: name = '" + tag_name + "' tag_slug = '" + tag_slug + "'");				}											}									var noPosts:int = 0;			var postType:String = "";						for each(var postNode:XML in this.xmlData.channel.item){				for each(var subNode3:XML in postNode.*){					subNodeName = subNode3.name();					if (subNodeName.indexOf("post_type") > 0){ postType = subNode3.text();}							}				if (postType == 'post'){					noPosts++;						}			}						ExternalInterface.call('WordpressImporter.onMeta', noPosts, tags, categories);					}		// //////////////////////////////////////////////////////////////		private function parsePosts(){			// <item>			//     <title></title>			//     <link>http://www.charlottegeary.com/blog/2005/01/24/207/</link>			//     <pubDate>Mon, 24 Jan 2005 16:26:00 +0000</pubDate>			//     <dc:creator><![CDATA[charlottegeary]]></dc:creator>			//     <category><![CDATA[All posts]]></category>			//     <category domain="category" nicename="all"><![CDATA[All posts]]></category>			//     <category domain="tag"><![CDATA[my family]]></category>			//     <category domain="tag" nicename="my-family"><![CDATA[my family]]></category>			//     <category domain="tag"><![CDATA[my pets]]></category>			//     <category domain="tag" nicename="my-pets"><![CDATA[my pets]]></category>			//     <category domain="tag"><![CDATA[personal photos]]></category>			//     <category domain="tag" nicename="personal-photos"><![CDATA[personal photos]]></category>			//     <guid isPermaLink="false">http://www.charlottegeary.com/blog/?p=207</guid>			//     <description></description>			//     <content:encoded><![CDATA[..POST HTML...]]></content:encoded>			//     <excerpt:encoded><![CDATA[]]></excerpt:encoded>			//     <wp:post_id>207</wp:post_id>			//     <wp:post_date>2005-01-24 10:26:00</wp:post_date>			//     <wp:post_date_gmt>2005-01-24 16:26:00</wp:post_date_gmt>			//     <wp:comment_status>open</wp:comment_status>			//     <wp:ping_status>open</wp:ping_status>			//     <wp:post_name>207</wp:post_name>			//     <wp:status>publish</wp:status>			//     <wp:post_parent>0</wp:post_parent>			//     <wp:menu_order>0</wp:menu_order>			//     <wp:post_type>post</wp:post_type>			//     <wp:post_password></wp:post_password>			//     <wp:postmeta>			//         <wp:meta_key>lj_itemid</wp:meta_key>			//         <wp:meta_value>58</wp:meta_value>			//     </wp:postmeta>			//     <wp:postmeta>			//         <wp:meta_key>lj_permalink</wp:meta_key>			//        <wp:meta_value>http://charlottegeary.livejournal.com/14885.html</wp:meta_value>			//     </wp:postmeta>			// </item>						for each(var postNode:XML in this.xmlData.channel.item){								var postType:String = "";				var postStatus:String = "";				var postID:String = "";				var postDate:String = "";				var postDateGMT:String = "";				var commentStatus:String = "";				var pingStatus:String = "";				var postName:String = "";				var postTitle:String = "";				var postLink:String = "";				var pubDate:String = "";				var postContent:String = "";				var postExcerpt:String = "";				//var post_parent:String = "";				//var menu_order:String = "";				var postPassword:String = "";				var postCreator:String = "";				var postCategories:String = ""; // csv list of categories for this post				var postTags:String = ""; // csv list of tags for this post												// Get the post type...				for each(var subNode:XML in postNode.*){					var subNodeName:String = subNode.name();					if (subNodeName.indexOf("post_type") > 0){ postType = subNode.text();}					if (subNodeName.indexOf("post_id") > 0){ postID = subNode.text();}					if (subNodeName.indexOf("status") > 0){ postStatus = subNode.text();}					if (subNodeName.indexOf("post_date") > 0){ postDate = subNode.text();}					if (subNodeName.indexOf("post_date_gmt") > 0){ postDateGMT = subNode.text();}					if (subNodeName.indexOf("comment_status") > 0){ commentStatus = subNode.text();}					if (subNodeName.indexOf("ping_status") > 0){ pingStatus = subNode.text();}					if (subNodeName.indexOf("post_name") > 0){ postName = subNode.text();}					if (subNodeName.indexOf("post_password") > 0){ postPassword = subNode.text();}					if (subNodeName.indexOf("creator") > 0){ postCreator = subNode.text();}					if (subNodeName.indexOf("content") > 0){ postContent = subNode.text();}					if (subNodeName.indexOf("excerpt") > 0){ postExcerpt = subNode.text();}				}				// If this is a post, then process it...				if (postType == 'post'){					postTitle = postNode.title;					postLink = postNode.link;					pubDate = postNode.pubDate;										// Get categories and tags					for each(var catNode:XML in postNode.category){						if (catNode.attribute("domain") == 'tag'){							if (catNode.attribute("nicename").length() == 0){								if (postTags != ""){									postTags += ",";								}								postTags += catNode.text();															}						}						else {							if (postCategories != ""){								postCategories += ",";							}							postCategories += catNode.text();						}					}										// Send to JS......					var canComment:Boolean = false;					if (commentStatus == 'open') {						canComment = true;					}					else {						canComment = false;					}										//trace(postTags);										ExternalInterface.call('WordpressImporter.onPost', [{title:postTitle, date:postDate, date_gmt:postDateGMT, can_comment:canComment, password: postPassword, author: postCreator, tags: postTags, categories: postCategories, content: postContent, excerpt: postExcerpt}]);									}			}		}	}}