
(function($){var ColorPicker=function(){var
ids={},inAction,charMin=65,visible,tpl='<div class="colorpicker"><div class="colorpicker_color"><div><div></div></div></div><div class="colorpicker_hue"><div></div></div><div class="colorpicker_new_color"></div><div class="colorpicker_current_color"></div><div class="colorpicker_hex"><input type="text" maxlength="6" size="6" /></div><div class="colorpicker_rgb_r colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_g colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_h colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_s colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_submit"></div></div>',defaults={eventName:'click',onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},color:'ff0000',livePreview:true,flat:false},fillRGBFields=function(hsb,cal){var rgb=HSBToRGB(hsb);$(cal).data('colorpicker').fields.eq(1).val(rgb.r).end().eq(2).val(rgb.g).end().eq(3).val(rgb.b).end();},fillHSBFields=function(hsb,cal){$(cal).data('colorpicker').fields.eq(4).val(hsb.h).end().eq(5).val(hsb.s).end().eq(6).val(hsb.b).end();},fillHexFields=function(hsb,cal){$(cal).data('colorpicker').fields.eq(0).val(HSBToHex(hsb)).end();},setSelector=function(hsb,cal){$(cal).data('colorpicker').selector.css('backgroundColor','#'+HSBToHex({h:hsb.h,s:100,b:100}));$(cal).data('colorpicker').selectorIndic.css({left:parseInt(150*hsb.s/100,10),top:parseInt(150*(100-hsb.b)/100,10)});},setHue=function(hsb,cal){$(cal).data('colorpicker').hue.css('top',parseInt(150-150*hsb.h/360,10));},setCurrentColor=function(hsb,cal){$(cal).data('colorpicker').currentColor.css('backgroundColor','#'+HSBToHex(hsb));},setNewColor=function(hsb,cal){$(cal).data('colorpicker').newColor.css('backgroundColor','#'+HSBToHex(hsb));},keyDown=function(ev){var pressedKey=ev.charCode||ev.keyCode||-1;if((pressedKey>charMin&&pressedKey<=90)||pressedKey==32){return false;}
var cal=$(this).parent().parent();if(cal.data('colorpicker').livePreview===true){change.apply(this);}},change=function(ev){var cal=$(this).parent().parent(),col;if(this.parentNode.className.indexOf('_hex')>0){cal.data('colorpicker').color=col=HexToHSB(fixHex(this.value));}else if(this.parentNode.className.indexOf('_hsb')>0){cal.data('colorpicker').color=col=fixHSB({h:parseInt(cal.data('colorpicker').fields.eq(4).val(),10),s:parseInt(cal.data('colorpicker').fields.eq(5).val(),10),b:parseInt(cal.data('colorpicker').fields.eq(6).val(),10)});}else{cal.data('colorpicker').color=col=RGBToHSB(fixRGB({r:parseInt(cal.data('colorpicker').fields.eq(1).val(),10),g:parseInt(cal.data('colorpicker').fields.eq(2).val(),10),b:parseInt(cal.data('colorpicker').fields.eq(3).val(),10)}));}
if(ev){fillRGBFields(col,cal.get(0));fillHexFields(col,cal.get(0));fillHSBFields(col,cal.get(0));}
setSelector(col,cal.get(0));setHue(col,cal.get(0));setNewColor(col,cal.get(0));cal.data('colorpicker').onChange.apply(cal,[col,HSBToHex(col),HSBToRGB(col)]);},blur=function(ev){var cal=$(this).parent().parent();cal.data('colorpicker').fields.parent().removeClass('colorpicker_focus');},focus=function(){charMin=this.parentNode.className.indexOf('_hex')>0?70:65;$(this).parent().parent().data('colorpicker').fields.parent().removeClass('colorpicker_focus');$(this).parent().addClass('colorpicker_focus');},downIncrement=function(ev){var field=$(this).parent().find('input').focus();var current={el:$(this).parent().addClass('colorpicker_slider'),max:this.parentNode.className.indexOf('_hsb_h')>0?360:(this.parentNode.className.indexOf('_hsb')>0?100:255),y:ev.pageY,field:field,val:parseInt(field.val(),10),preview:$(this).parent().parent().data('colorpicker').livePreview};$(document).bind('mouseup',current,upIncrement);$(document).bind('mousemove',current,moveIncrement);},moveIncrement=function(ev){ev.data.field.val(Math.max(0,Math.min(ev.data.max,parseInt(ev.data.val+ev.pageY-ev.data.y,10))));if(ev.data.preview){change.apply(ev.data.field.get(0),[true]);}
return false;},upIncrement=function(ev){change.apply(ev.data.field.get(0),[true]);ev.data.el.removeClass('colorpicker_slider').find('input').focus();$(document).unbind('mouseup',upIncrement);$(document).unbind('mousemove',moveIncrement);return false;},downHue=function(ev){var current={cal:$(this).parent(),y:$(this).offset().top};current.preview=current.cal.data('colorpicker').livePreview;$(document).bind('mouseup',current,upHue);$(document).bind('mousemove',current,moveHue);},moveHue=function(ev){change.apply(ev.data.cal.data('colorpicker').fields.eq(4).val(parseInt(360*(150-Math.max(0,Math.min(150,(ev.pageY-ev.data.y))))/150,10)).get(0),[ev.data.preview]);return false;},upHue=function(ev){fillRGBFields(ev.data.cal.data('colorpicker').color,ev.data.cal.get(0));fillHexFields(ev.data.cal.data('colorpicker').color,ev.data.cal.get(0));$(document).unbind('mouseup',upHue);$(document).unbind('mousemove',moveHue);return false;},downSelector=function(ev){var current={cal:$(this).parent(),pos:$(this).offset()};current.preview=current.cal.data('colorpicker').livePreview;$(document).bind('mouseup',current,upSelector);$(document).bind('mousemove',current,moveSelector);},moveSelector=function(ev){change.apply(ev.data.cal.data('colorpicker').fields.eq(6).val(parseInt(100*(150-Math.max(0,Math.min(150,(ev.pageY-ev.data.pos.top))))/150,10)).end().eq(5).val(parseInt(100*(Math.max(0,Math.min(150,(ev.pageX-ev.data.pos.left))))/150,10)).get(0),[ev.data.preview]);return false;},upSelector=function(ev){fillRGBFields(ev.data.cal.data('colorpicker').color,ev.data.cal.get(0));fillHexFields(ev.data.cal.data('colorpicker').color,ev.data.cal.get(0));$(document).unbind('mouseup',upSelector);$(document).unbind('mousemove',moveSelector);return false;},enterSubmit=function(ev){$(this).addClass('colorpicker_focus');},leaveSubmit=function(ev){$(this).removeClass('colorpicker_focus');},clickSubmit=function(ev){var cal=$(this).parent();var col=cal.data('colorpicker').color;cal.data('colorpicker').origColor=col;setCurrentColor(col,cal.get(0));cal.data('colorpicker').onSubmit(col,HSBToHex(col),HSBToRGB(col),cal.data('colorpicker').el);},show=function(ev){var cal=$('#'+$(this).data('colorpickerId'));cal.data('colorpicker').onBeforeShow.apply(this,[cal.get(0)]);var pos=$(this).offset();var viewPort=getViewport();var top=pos.top+this.offsetHeight;var left=pos.left;if(top+176>viewPort.t+viewPort.h){top-=this.offsetHeight+176;}
if(left+356>viewPort.l+viewPort.w){left-=356;}
cal.css({left:left+'px',top:top+'px'});if(cal.data('colorpicker').onShow.apply(this,[cal.get(0)])!=false){cal.show();}
$(document).bind('mousedown',{cal:cal},hide);return false;},hide=function(ev){if(!isChildOf(ev.data.cal.get(0),ev.target,ev.data.cal.get(0))){if(ev.data.cal.data('colorpicker').onHide.apply(this,[ev.data.cal.get(0)])!=false){ev.data.cal.hide();}
$(document).unbind('mousedown',hide);}},isChildOf=function(parentEl,el,container){if(parentEl==el){return true;}
if(parentEl.contains){return parentEl.contains(el);}
if(parentEl.compareDocumentPosition){return!!(parentEl.compareDocumentPosition(el)&16);}
var prEl=el.parentNode;while(prEl&&prEl!=container){if(prEl==parentEl)
return true;prEl=prEl.parentNode;}
return false;},getViewport=function(){var m=document.compatMode=='CSS1Compat';return{l:window.pageXOffset||(m?document.documentElement.scrollLeft:document.body.scrollLeft),t:window.pageYOffset||(m?document.documentElement.scrollTop:document.body.scrollTop),w:window.innerWidth||(m?document.documentElement.clientWidth:document.body.clientWidth),h:window.innerHeight||(m?document.documentElement.clientHeight:document.body.clientHeight)};},fixHSB=function(hsb){return{h:Math.min(360,Math.max(0,hsb.h)),s:Math.min(100,Math.max(0,hsb.s)),b:Math.min(100,Math.max(0,hsb.b))};},fixRGB=function(rgb){return{r:Math.min(255,Math.max(0,rgb.r)),g:Math.min(255,Math.max(0,rgb.g)),b:Math.min(255,Math.max(0,rgb.b))};},fixHex=function(hex){var len=6-hex.length;if(len>0){var o=[];for(var i=0;i<len;i++){o.push('0');}
o.push(hex);hex=o.join('');}
return hex;},HexToRGB=function(hex){var hex=parseInt(((hex.indexOf('#')>-1)?hex.substring(1):hex),16);return{r:hex>>16,g:(hex&0x00FF00)>>8,b:(hex&0x0000FF)};},HexToHSB=function(hex){return RGBToHSB(HexToRGB(hex));},RGBToHSB=function(rgb){var hsb={h:0,s:0,b:0};var min=Math.min(rgb.r,rgb.g,rgb.b);var max=Math.max(rgb.r,rgb.g,rgb.b);var delta=max-min;hsb.b=max;if(max!=0){}
hsb.s=max!=0?255*delta/max:0;if(hsb.s!=0){if(rgb.r==max){hsb.h=(rgb.g-rgb.b)/delta;}else if(rgb.g==max){hsb.h=2+(rgb.b-rgb.r)/delta;}else{hsb.h=4+(rgb.r-rgb.g)/delta;}}else{hsb.h=-1;}
hsb.h*=60;if(hsb.h<0){hsb.h+=360;}
hsb.s*=100/255;hsb.b*=100/255;return hsb;},HSBToRGB=function(hsb){var rgb={};var h=Math.round(hsb.h);var s=Math.round(hsb.s*255/100);var v=Math.round(hsb.b*255/100);if(s==0){rgb.r=rgb.g=rgb.b=v;}else{var t1=v;var t2=(255-s)*v/255;var t3=(t1-t2)*(h%60)/60;if(h==360)h=0;if(h<60){rgb.r=t1;rgb.b=t2;rgb.g=t2+t3}
else if(h<120){rgb.g=t1;rgb.b=t2;rgb.r=t1-t3}
else if(h<180){rgb.g=t1;rgb.r=t2;rgb.b=t2+t3}
else if(h<240){rgb.b=t1;rgb.r=t2;rgb.g=t1-t3}
else if(h<300){rgb.b=t1;rgb.g=t2;rgb.r=t2+t3}
else if(h<360){rgb.r=t1;rgb.g=t2;rgb.b=t1-t3}
else{rgb.r=0;rgb.g=0;rgb.b=0}}
return{r:Math.round(rgb.r),g:Math.round(rgb.g),b:Math.round(rgb.b)};},RGBToHex=function(rgb){var hex=[rgb.r.toString(16),rgb.g.toString(16),rgb.b.toString(16)];$.each(hex,function(nr,val){if(val.length==1){hex[nr]='0'+val;}});return hex.join('');},HSBToHex=function(hsb){return RGBToHex(HSBToRGB(hsb));},restoreOriginal=function(){var cal=$(this).parent();var col=cal.data('colorpicker').origColor;cal.data('colorpicker').color=col;fillRGBFields(col,cal.get(0));fillHexFields(col,cal.get(0));fillHSBFields(col,cal.get(0));setSelector(col,cal.get(0));setHue(col,cal.get(0));setNewColor(col,cal.get(0));};return{init:function(opt){opt=$.extend({},defaults,opt||{});if(typeof opt.color=='string'){opt.color=HexToHSB(opt.color);}else if(opt.color.r!=undefined&&opt.color.g!=undefined&&opt.color.b!=undefined){opt.color=RGBToHSB(opt.color);}else if(opt.color.h!=undefined&&opt.color.s!=undefined&&opt.color.b!=undefined){opt.color=fixHSB(opt.color);}else{return this;}
return this.each(function(){if(!$(this).data('colorpickerId')){var options=$.extend({},opt);options.origColor=opt.color;var id='collorpicker_'+parseInt(Math.random()*1000);$(this).data('colorpickerId',id);var cal=$(tpl).attr('id',id);if(options.flat){cal.appendTo(this).show();}else{cal.appendTo(document.body);}
options.fields=cal.find('input').bind('keyup',keyDown).bind('change',change).bind('blur',blur).bind('focus',focus);cal.find('span').bind('mousedown',downIncrement).end().find('>div.colorpicker_current_color').bind('click',restoreOriginal);options.selector=cal.find('div.colorpicker_color').bind('mousedown',downSelector);options.selectorIndic=options.selector.find('div div');options.el=this;options.hue=cal.find('div.colorpicker_hue div');cal.find('div.colorpicker_hue').bind('mousedown',downHue);options.newColor=cal.find('div.colorpicker_new_color');options.currentColor=cal.find('div.colorpicker_current_color');cal.data('colorpicker',options);cal.find('div.colorpicker_submit').bind('mouseenter',enterSubmit).bind('mouseleave',leaveSubmit).bind('click',clickSubmit);fillRGBFields(options.color,cal.get(0));fillHSBFields(options.color,cal.get(0));fillHexFields(options.color,cal.get(0));setHue(options.color,cal.get(0));setSelector(options.color,cal.get(0));setCurrentColor(options.color,cal.get(0));setNewColor(options.color,cal.get(0));if(options.flat){cal.css({position:'relative',display:'block'});}else{$(this).bind(options.eventName,show);}}});},showPicker:function(){return this.each(function(){if($(this).data('colorpickerId')){show.apply(this);}});},hidePicker:function(){return this.each(function(){if($(this).data('colorpickerId')){$('#'+$(this).data('colorpickerId')).hide();}});},setColor:function(col){if(typeof col=='string'){col=HexToHSB(col);}else if(col.r!=undefined&&col.g!=undefined&&col.b!=undefined){col=RGBToHSB(col);}else if(col.h!=undefined&&col.s!=undefined&&col.b!=undefined){col=fixHSB(col);}else{return this;}
return this.each(function(){if($(this).data('colorpickerId')){var cal=$('#'+$(this).data('colorpickerId'));cal.data('colorpicker').color=col;cal.data('colorpicker').origColor=col;fillRGBFields(col,cal.get(0));fillHSBFields(col,cal.get(0));fillHexFields(col,cal.get(0));setHue(col,cal.get(0));setSelector(col,cal.get(0));setCurrentColor(col,cal.get(0));setNewColor(col,cal.get(0));}});}};}();$.fn.extend({ColorPicker:ColorPicker.init,ColorPickerHide:ColorPicker.hidePicker,ColorPickerShow:ColorPicker.showPicker,ColorPickerSetColor:ColorPicker.setColor});})(jQuery)

(function($){$.extend($.fn,{validate:function(options){if(!this.length){options&&options.debug&&window.console&&console.warn("nothing selected, can't validate, returning nothing");return;}var validator=$.data(this[0],'validator');if(validator){return validator;}validator=new $.validator(options,this[0]);$.data(this[0],'validator',validator);if(validator.settings.onsubmit){this.find("input, button").filter(".cancel").click(function(){validator.cancelSubmit=true;});if(validator.settings.submitHandler){this.find("input, button").filter(":submit").click(function(){validator.submitButton=this;});}this.submit(function(event){if(validator.settings.debug)event.preventDefault();function handle(){if(validator.settings.submitHandler){if(validator.submitButton){var hidden=$("<input type='hidden'/>").attr("name",validator.submitButton.name).val(validator.submitButton.value).appendTo(validator.currentForm);}validator.settings.submitHandler.call(validator,validator.currentForm);if(validator.submitButton){hidden.remove();}return false;}return true;}if(validator.cancelSubmit){validator.cancelSubmit=false;return handle();}if(validator.form()){if(validator.pendingRequest){validator.formSubmitted=true;return false;}return handle();}else{validator.focusInvalid();return false;}});}return validator;},valid:function(){if($(this[0]).is('form')){return this.validate().form();}else{var valid=true;var validator=$(this[0].form).validate();this.each(function(){valid&=validator.element(this);});return valid;}},removeAttrs:function(attributes){var result={},$element=this;$.each(attributes.split(/\s/),function(index,value){result[value]=$element.attr(value);$element.removeAttr(value);});return result;},rules:function(command,argument){var element=this[0];if(command){var settings=$.data(element.form,'validator').settings;var staticRules=settings.rules;var existingRules=$.validator.staticRules(element);switch(command){case"add":$.extend(existingRules,$.validator.normalizeRule(argument));staticRules[element.name]=existingRules;if(argument.messages)settings.messages[element.name]=$.extend(settings.messages[element.name],argument.messages);break;case"remove":if(!argument){delete staticRules[element.name];return existingRules;}var filtered={};$.each(argument.split(/\s/),function(index,method){filtered[method]=existingRules[method];delete existingRules[method];});return filtered;}}var data=$.validator.normalizeRules($.extend({},$.validator.metadataRules(element),$.validator.classRules(element),$.validator.attributeRules(element),$.validator.staticRules(element)),element);if(data.required){var param=data.required;delete data.required;data=$.extend({required:param},data);}return data;}});$.extend($.expr[":"],{blank:function(a){return!$.trim(a.value);},filled:function(a){return!!$.trim(a.value);},unchecked:function(a){return!a.checked;}});$.validator=function(options,form){this.settings=$.extend({},$.validator.defaults,options);this.currentForm=form;this.init();};$.validator.format=function(source,params){if(arguments.length==1)return function(){var args=$.makeArray(arguments);args.unshift(source);return $.validator.format.apply(this,args);};if(arguments.length>2&&params.constructor!=Array){params=$.makeArray(arguments).slice(1);}if(params.constructor!=Array){params=[params];}$.each(params,function(i,n){source=source.replace(new RegExp("\\{"+i+"\\}","g"),n);});return source;};$.extend($.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusInvalid:true,errorContainer:$([]),errorLabelContainer:$([]),onsubmit:true,ignore:[],ignoreTitle:false,onfocusin:function(element){this.lastActive=element;if(this.settings.focusCleanup&&!this.blockFocusCleanup){this.settings.unhighlight&&this.settings.unhighlight.call(this,element,this.settings.errorClass,this.settings.validClass);this.errorsFor(element).hide();}},onfocusout:function(element){if(!this.checkable(element)&&(element.name in this.submitted||!this.optional(element))){this.element(element);}},onkeyup:function(element){if(element.name in this.submitted||element==this.lastElement){this.element(element);}},onclick:function(element){if(element.name in this.submitted)this.element(element);},highlight:function(element,errorClass,validClass){$(element).addClass(errorClass).removeClass(validClass);},unhighlight:function(element,errorClass,validClass){$(element).removeClass(errorClass).addClass(validClass);}},setDefaults:function(settings){$.extend($.validator.defaults,settings);},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",dateDE:"Bitte geben Sie ein g√ºltiges Datum ein.",number:"Please enter a valid number.",numberDE:"Bitte geben Sie eine Nummer ein.",digits:"Please enter only digits",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",accept:"Please enter a value with a valid extension.",maxlength:$.validator.format("Please enter no more than {0} characters."),minlength:$.validator.format("Please enter at least {0} characters."),rangelength:$.validator.format("Please enter a value between {0} and {1} characters long."),range:$.validator.format("Please enter a value between {0} and {1}."),max:$.validator.format("Please enter a value less than or equal to {0}."),min:$.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:false,prototype:{init:function(){this.labelContainer=$(this.settings.errorLabelContainer);this.errorContext=this.labelContainer.length&&this.labelContainer||$(this.currentForm);this.containers=$(this.settings.errorContainer).add(this.settings.errorLabelContainer);this.submitted={};this.valueCache={};this.pendingRequest=0;this.pending={};this.invalid={};this.reset();var groups=(this.groups={});$.each(this.settings.groups,function(key,value){$.each(value.split(/\s/),function(index,name){groups[name]=key;});});var rules=this.settings.rules;$.each(rules,function(key,value){rules[key]=$.validator.normalizeRule(value);});function delegate(event){var validator=$.data(this[0].form,"validator");validator.settings["on"+event.type]&&validator.settings["on"+event.type].call(validator,this[0]);}$(this.currentForm).delegate("focusin focusout keyup",":text, :password, :file, select, textarea",delegate).delegate("click",":radio, :checkbox",delegate);if(this.settings.invalidHandler)$(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler);},form:function(){this.checkForm();$.extend(this.submitted,this.errorMap);this.invalid=$.extend({},this.errorMap);if(!this.valid())$(this.currentForm).triggerHandler("invalid-form",[this]);this.showErrors();return this.valid();},checkForm:function(){this.prepareForm();for(var i=0,elements=(this.currentElements=this.elements());elements[i];i++){this.check(elements[i]);}return this.valid();},element:function(element){element=this.clean(element);this.lastElement=element;this.prepareElement(element);this.currentElements=$(element);var result=this.check(element);if(result){delete this.invalid[element.name];}else{this.invalid[element.name]=true;}if(!this.numberOfInvalids()){this.toHide=this.toHide.add(this.containers);}this.showErrors();return result;},showErrors:function(errors){if(errors){$.extend(this.errorMap,errors);this.errorList=[];for(var name in errors){this.errorList.push({message:errors[name],element:this.findByName(name)[0]});}this.successList=$.grep(this.successList,function(element){return!(element.name in errors);});}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors();},resetForm:function(){if($.fn.resetForm)$(this.currentForm).resetForm();this.submitted={};this.prepareForm();this.hideErrors();this.elements().removeClass(this.settings.errorClass);},numberOfInvalids:function(){return this.objectLength(this.invalid);},objectLength:function(obj){var count=0;for(var i in obj)count++;return count;},hideErrors:function(){this.addWrapper(this.toHide).hide();},valid:function(){return this.size()==0;},size:function(){return this.errorList.length;},focusInvalid:function(){if(this.settings.focusInvalid){try{$(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus();}catch(e){}}},findLastActive:function(){var lastActive=this.lastActive;return lastActive&&$.grep(this.errorList,function(n){return n.element.name==lastActive.name;}).length==1&&lastActive;},elements:function(){var validator=this,rulesCache={};return $([]).add(this.currentForm.elements).filter(":input").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){!this.name&&validator.settings.debug&&window.console&&console.error("%o has no name assigned",this);if(this.name in rulesCache||!validator.objectLength($(this).rules()))return false;rulesCache[this.name]=true;return true;});},clean:function(selector){return $(selector)[0];},errors:function(){return $(this.settings.errorElement+"."+this.settings.errorClass,this.errorContext);},reset:function(){this.successList=[];this.errorList=[];this.errorMap={};this.toShow=$([]);this.toHide=$([]);this.formSubmitted=false;this.currentElements=$([]);},prepareForm:function(){this.reset();this.toHide=this.errors().add(this.containers);},prepareElement:function(element){this.reset();this.toHide=this.errorsFor(element);},check:function(element){element=this.clean(element);if(this.checkable(element)){element=this.findByName(element.name)[0];}var rules=$(element).rules();var dependencyMismatch=false;for(method in rules){var rule={method:method,parameters:rules[method]};try{var result=$.validator.methods[method].call(this,element.value.replace(/\r/g,""),element,rule.parameters);if(result=="dependency-mismatch"){dependencyMismatch=true;continue;}dependencyMismatch=false;if(result=="pending"){this.toHide=this.toHide.not(this.errorsFor(element));return;}if(!result){this.formatAndAdd(element,rule);return false;}}catch(e){this.settings.debug&&window.console&&console.log("exception occured when checking element "+element.id
+", check the '"+rule.method+"' method");throw e;}}if(dependencyMismatch)return;if(this.objectLength(rules))this.successList.push(element);return true;},customMetaMessage:function(element,method){if(!$.metadata)return;var meta=this.settings.meta?$(element).metadata()[this.settings.meta]:$(element).metadata();return meta&&meta.messages&&meta.messages[method];},customMessage:function(name,method){var m=this.settings.messages[name];return m&&(m.constructor==String?m:m[method]);},findDefined:function(){for(var i=0;i<arguments.length;i++){if(arguments[i]!==undefined)return arguments[i];}return undefined;},defaultMessage:function(element,method){return this.findDefined(this.customMessage(element.name,method),this.customMetaMessage(element,method),!this.settings.ignoreTitle&&element.title||undefined,$.validator.messages[method],"<strong>Warning: No message defined for "+element.name+"</strong>");},formatAndAdd:function(element,rule){var message=this.defaultMessage(element,rule.method);if(typeof message=="function")message=message.call(this,rule.parameters,element);this.errorList.push({message:message,element:element});this.errorMap[element.name]=message;this.submitted[element.name]=message;},addWrapper:function(toToggle){if(this.settings.wrapper)toToggle=toToggle.add(toToggle.parent(this.settings.wrapper));return toToggle;},defaultShowErrors:function(){for(var i=0;this.errorList[i];i++){var error=this.errorList[i];this.settings.highlight&&this.settings.highlight.call(this,error.element,this.settings.errorClass,this.settings.validClass);this.showLabel(error.element,error.message);}if(this.errorList.length){this.toShow=this.toShow.add(this.containers);}if(this.settings.success){for(var i=0;this.successList[i];i++){this.showLabel(this.successList[i]);}}if(this.settings.unhighlight){for(var i=0,elements=this.validElements();elements[i];i++){this.settings.unhighlight.call(this,elements[i],this.settings.errorClass,this.settings.validClass);}}this.toHide=this.toHide.not(this.toShow);this.hideErrors();this.addWrapper(this.toShow).show();},validElements:function(){return this.currentElements.not(this.invalidElements());},invalidElements:function(){return $(this.errorList).map(function(){return this.element;});},showLabel:function(element,message){var label=this.errorsFor(element);if(label.length){label.removeClass().addClass(this.settings.errorClass);label.attr("generated")&&label.html(message);}else{label=$("<"+this.settings.errorElement+"/>").attr({"for":this.idOrName(element),generated:true}).addClass(this.settings.errorClass).html(message||"");if(this.settings.wrapper){label=label.hide().show().wrap("<"+this.settings.wrapper+"/>").parent();}if(!this.labelContainer.append(label).length)this.settings.errorPlacement?this.settings.errorPlacement(label,$(element)):label.insertAfter(element);}if(!message&&this.settings.success){label.text("");typeof this.settings.success=="string"?label.addClass(this.settings.success):this.settings.success(label);}this.toShow=this.toShow.add(label);},errorsFor:function(element){return this.errors().filter("[for='"+this.idOrName(element)+"']");},idOrName:function(element){return this.groups[element.name]||(this.checkable(element)?element.name:element.id||element.name);},checkable:function(element){return/radio|checkbox/i.test(element.type);},findByName:function(name){var form=this.currentForm;return $(document.getElementsByName(name)).map(function(index,element){return element.form==form&&element.name==name&&element||null;});},getLength:function(value,element){switch(element.nodeName.toLowerCase()){case'select':return $("option:selected",element).length;case'input':if(this.checkable(element))return this.findByName(element.name).filter(':checked').length;}return value.length;},depend:function(param,element){return this.dependTypes[typeof param]?this.dependTypes[typeof param](param,element):true;},dependTypes:{"boolean":function(param,element){return param;},"string":function(param,element){return!!$(param,element.form).length;},"function":function(param,element){return param(element);}},optional:function(element){return!$.validator.methods.required.call(this,$.trim(element.value),element)&&"dependency-mismatch";},startRequest:function(element){if(!this.pending[element.name]){this.pendingRequest++;this.pending[element.name]=true;}},stopRequest:function(element,valid){this.pendingRequest--;if(this.pendingRequest<0)this.pendingRequest=0;delete this.pending[element.name];if(valid&&this.pendingRequest==0&&this.formSubmitted&&this.form()){$(this.currentForm).submit();}else if(!valid&&this.pendingRequest==0&&this.formSubmitted){$(this.currentForm).triggerHandler("invalid-form",[this]);}},previousValue:function(element){return $.data(element,"previousValue")||$.data(element,"previousValue",previous={old:null,valid:true,message:this.defaultMessage(element,"remote")});}},classRuleSettings:{required:{required:true},email:{email:true},url:{url:true},date:{date:true},dateISO:{dateISO:true},dateDE:{dateDE:true},number:{number:true},numberDE:{numberDE:true},digits:{digits:true},creditcard:{creditcard:true}},addClassRules:function(className,rules){className.constructor==String?this.classRuleSettings[className]=rules:$.extend(this.classRuleSettings,className);},classRules:function(element){var rules={};var classes=$(element).attr('class');classes&&$.each(classes.split(' '),function(){if(this in $.validator.classRuleSettings){$.extend(rules,$.validator.classRuleSettings[this]);}});return rules;},attributeRules:function(element){var rules={};var $element=$(element);for(method in $.validator.methods){var value=$element.attr(method);if(value){rules[method]=value;}}if(rules.maxlength&&/-1|2147483647|524288/.test(rules.maxlength)){delete rules.maxlength;}return rules;},metadataRules:function(element){if(!$.metadata)return{};var meta=$.data(element.form,'validator').settings.meta;return meta?$(element).metadata()[meta]:$(element).metadata();},staticRules:function(element){var rules={};var validator=$.data(element.form,'validator');if(validator.settings.rules){rules=$.validator.normalizeRule(validator.settings.rules[element.name])||{};}return rules;},normalizeRules:function(rules,element){$.each(rules,function(prop,val){if(val===false){delete rules[prop];return;}if(val.param||val.depends){var keepRule=true;switch(typeof val.depends){case"string":keepRule=!!$(val.depends,element.form).length;break;case"function":keepRule=val.depends.call(element,element);break;}if(keepRule){rules[prop]=val.param!==undefined?val.param:true;}else{delete rules[prop];}}});$.each(rules,function(rule,parameter){rules[rule]=$.isFunction(parameter)?parameter(element):parameter;});$.each(['minlength','maxlength','min','max'],function(){if(rules[this]){rules[this]=Number(rules[this]);}});$.each(['rangelength','range'],function(){if(rules[this]){rules[this]=[Number(rules[this][0]),Number(rules[this][1])];}});if($.validator.autoCreateRanges){if(rules.min&&rules.max){rules.range=[rules.min,rules.max];delete rules.min;delete rules.max;}if(rules.minlength&&rules.maxlength){rules.rangelength=[rules.minlength,rules.maxlength];delete rules.minlength;delete rules.maxlength;}}if(rules.messages){delete rules.messages}return rules;},normalizeRule:function(data){if(typeof data=="string"){var transformed={};$.each(data.split(/\s/),function(){transformed[this]=true;});data=transformed;}return data;},addMethod:function(name,method,message){$.validator.methods[name]=method;$.validator.messages[name]=message||$.validator.messages[name];if(method.length<3){$.validator.addClassRules(name,$.validator.normalizeRule(name));}},methods:{required:function(value,element,param){if(!this.depend(param,element))return"dependency-mismatch";switch(element.nodeName.toLowerCase()){case'select':var options=$("option:selected",element);return options.length>0&&(element.type=="select-multiple"||($.browser.msie&&!(options[0].attributes['value'].specified)?options[0].text:options[0].value).length>0);case'input':if(this.checkable(element))return this.getLength(value,element)>0;default:return $.trim(value).length>0;}},remote:function(value,element,param){if(this.optional(element))return"dependency-mismatch";var previous=this.previousValue(element);if(!this.settings.messages[element.name])this.settings.messages[element.name]={};this.settings.messages[element.name].remote=typeof previous.message=="function"?previous.message(value):previous.message;param=typeof param=="string"&&{url:param}||param;if(previous.old!==value){previous.old=value;var validator=this;this.startRequest(element);var data={};data[element.name]=value;$.ajax($.extend(true,{url:param,mode:"abort",port:"validate"+element.name,dataType:"json",data:data,success:function(response){var valid=response===true;if(valid){var submitted=validator.formSubmitted;validator.prepareElement(element);validator.formSubmitted=submitted;validator.successList.push(element);validator.showErrors();}else{var errors={};errors[element.name]=previous.message=response||validator.defaultMessage(element,"remote");validator.showErrors(errors);}previous.valid=valid;validator.stopRequest(element,valid);}},param));return"pending";}else if(this.pending[element.name]){return"pending";}return previous.valid;},minlength:function(value,element,param){return this.optional(element)||this.getLength($.trim(value),element)>=param;},maxlength:function(value,element,param){return this.optional(element)||this.getLength($.trim(value),element)<=param;},rangelength:function(value,element,param){var length=this.getLength($.trim(value),element);return this.optional(element)||(length>=param[0]&&length<=param[1]);},min:function(value,element,param){return this.optional(element)||value>=param;},max:function(value,element,param){return this.optional(element)||value<=param;},range:function(value,element,param){return this.optional(element)||(value>=param[0]&&value<=param[1]);},email:function(value,element){return this.optional(element)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(value);},url:function(value,element){return this.optional(element)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(value);},date:function(value,element){return this.optional(element)||!/Invalid|NaN/.test(new Date(value));},dateISO:function(value,element){return this.optional(element)||/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(value);},dateDE:function(value,element){return this.optional(element)||/^\d\d?\.\d\d?\.\d\d\d?\d?$/.test(value);},number:function(value,element){return this.optional(element)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(value);},numberDE:function(value,element){return this.optional(element)||/^-?(?:\d+|\d{1,3}(?:\.\d{3})+)(?:,\d+)?$/.test(value);},digits:function(value,element){return this.optional(element)||/^\d+$/.test(value);},creditcard:function(value,element){if(this.optional(element))return"dependency-mismatch";if(/[^0-9-]+/.test(value))return false;var nCheck=0,nDigit=0,bEven=false;value=value.replace(/\D/g,"");for(n=value.length-1;n>=0;n--){var cDigit=value.charAt(n);var nDigit=parseInt(cDigit,10);if(bEven){if((nDigit*=2)>9)nDigit-=9;}nCheck+=nDigit;bEven=!bEven;}return(nCheck%10)==0;},accept:function(value,element,param){param=typeof param=="string"?param.replace(/,/g,'|'):"png|jpe?g|gif";return this.optional(element)||value.match(new RegExp(".("+param+")$","i"));},equalTo:function(value,element,param){return value==$(param).val();}}});$.format=$.validator.format;})(jQuery);;(function($){var ajax=$.ajax;var pendingRequests={};$.ajax=function(settings){settings=$.extend(settings,$.extend({},$.ajaxSettings,settings));var port=settings.port;if(settings.mode=="abort"){if(pendingRequests[port]){pendingRequests[port].abort();}return(pendingRequests[port]=ajax.apply(this,arguments));}return ajax.apply(this,arguments);};})(jQuery);;(function($){$.each({focus:'focusin',blur:'focusout'},function(original,fix){$.event.special[fix]={setup:function(){if($.browser.msie)return false;this.addEventListener(original,$.event.special[fix].handler,true);},teardown:function(){if($.browser.msie)return false;this.removeEventListener(original,$.event.special[fix].handler,true);},handler:function(e){arguments[0]=$.event.fix(e);arguments[0].type=fix;return $.event.handle.apply(this,arguments);}};});$.extend($.fn,{delegate:function(type,delegate,handler){return this.bind(type,function(event){var target=$(event.target);if(target.is(delegate)){return handler.apply(target,arguments);}});},triggerEvent:function(type,target){return this.triggerHandler(type,[$.event.fix({type:type,target:target})]);}})})(jQuery);

(function(f){function l(g,h){function d(a){if(!e){e=true;c.start&&c.start(a,b)}}function i(a,j){if(e){clearTimeout(k);k=setTimeout(function(){e=false;c.stop&&c.stop(a,b)},j>=0?j:c.delay)}}var c=f.extend({start:null,stop:null,delay:400},h),b=f(g),e=false,k;b.keypress(d);b.keydown(function(a){if(a.keyCode===8||a.keyCode===46)d(a)});b.keyup(i);b.blur(function(a){i(a,0)})}f.fn.typing=function(g){return this.each(function(h,d){l(d,g)})}})(jQuery);

(function($){$.toJSON=function(o)
{if(typeof(JSON)=='object'&&JSON.stringify)
return JSON.stringify(o);var type=typeof(o);if(o===null)
return"null";if(type=="undefined")
return undefined;if(type=="number"||type=="boolean")
return o+"";if(type=="string")
return $.quoteString(o);if(type=='object')
{if(typeof o.toJSON=="function")
return $.toJSON(o.toJSON());if(o.constructor===Date)
{var month=o.getUTCMonth()+1;if(month<10)month='0'+month;var day=o.getUTCDate();if(day<10)day='0'+day;var year=o.getUTCFullYear();var hours=o.getUTCHours();if(hours<10)hours='0'+hours;var minutes=o.getUTCMinutes();if(minutes<10)minutes='0'+minutes;var seconds=o.getUTCSeconds();if(seconds<10)seconds='0'+seconds;var milli=o.getUTCMilliseconds();if(milli<100)milli='0'+milli;if(milli<10)milli='0'+milli;return'"'+year+'-'+month+'-'+day+'T'+
hours+':'+minutes+':'+seconds+'.'+milli+'Z"';}
if(o.constructor===Array)
{var ret=[];for(var i=0;i<o.length;i++)
ret.push($.toJSON(o[i])||"null");return"["+ret.join(",")+"]";}
var pairs=[];for(var k in o){var name;var type=typeof k;if(type=="number")
name='"'+k+'"';else if(type=="string")
name=$.quoteString(k);else
continue;if(typeof o[k]=="function")
continue;var val=$.toJSON(o[k]);pairs.push(name+":"+val);}
return"{"+pairs.join(", ")+"}";}};$.evalJSON=function(src)
{if(typeof(JSON)=='object'&&JSON.parse)
return JSON.parse(src);return eval("("+src+")");};$.secureEvalJSON=function(src)
{if(typeof(JSON)=='object'&&JSON.parse)
return JSON.parse(src);var filtered=src;filtered=filtered.replace(/\\["\\\/bfnrtu]/g,'@');filtered=filtered.replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']');filtered=filtered.replace(/(?:^|:|,)(?:\s*\[)+/g,'');if(/^[\],:{}\s]*$/.test(filtered))
return eval("("+src+")");else
throw new SyntaxError("Error parsing JSON, source is not valid.");};$.quoteString=function(string)
{if(string.match(_escapeable))
{return'"'+string.replace(_escapeable,function(a)
{var c=_meta[a];if(typeof c==='string')return c;c=a.charCodeAt();return'\\u00'+Math.floor(c/16).toString(16)+(c%16).toString(16);})+'"';}
return'"'+string+'"';};var _escapeable=/["\\\x00-\x1f\x7f-\x9f]/g;var _meta={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'};})(jQuery);

if(!document.createElement("canvas").getContext){(function(){var z=Math;var K=z.round;var J=z.sin;var U=z.cos;var b=z.abs;var k=z.sqrt;var D=10;var F=D/2;function T(){return this.context_||(this.context_=new W(this))}var O=Array.prototype.slice;function G(i,j,m){var Z=O.call(arguments,2);return function(){return i.apply(j,Z.concat(O.call(arguments)))}}function AD(Z){return String(Z).replace(/&/g,"&amp;").replace(/"/g,"&quot;")}function r(i){if(!i.namespaces.g_vml_){i.namespaces.add("g_vml_","urn:schemas-microsoft-com:vml","#default#VML")}if(!i.namespaces.g_o_){i.namespaces.add("g_o_","urn:schemas-microsoft-com:office:office","#default#VML")}if(!i.styleSheets.ex_canvas_){var Z=i.createStyleSheet();Z.owningElement.id="ex_canvas_";Z.cssText="canvas{display:inline-block;overflow:hidden;text-align:left;width:300px;height:150px}"}}r(document);var E={init:function(Z){if(/MSIE/.test(navigator.userAgent)&&!window.opera){var i=Z||document;i.createElement("canvas");i.attachEvent("onreadystatechange",G(this.init_,this,i))}},init_:function(m){var j=m.getElementsByTagName("canvas");for(var Z=0;Z<j.length;Z++){this.initElement(j[Z])}},initElement:function(i){if(!i.getContext){i.getContext=T;r(i.ownerDocument);i.innerHTML="";i.attachEvent("onpropertychange",S);i.attachEvent("onresize",w);var Z=i.attributes;if(Z.width&&Z.width.specified){i.style.width=Z.width.nodeValue+"px"}else{i.width=i.clientWidth}if(Z.height&&Z.height.specified){i.style.height=Z.height.nodeValue+"px"}else{i.height=i.clientHeight}}return i}};function S(i){var Z=i.srcElement;switch(i.propertyName){case"width":Z.getContext().clearRect();Z.style.width=Z.attributes.width.nodeValue+"px";Z.firstChild.style.width=Z.clientWidth+"px";break;case"height":Z.getContext().clearRect();Z.style.height=Z.attributes.height.nodeValue+"px";Z.firstChild.style.height=Z.clientHeight+"px";break}}function w(i){var Z=i.srcElement;if(Z.firstChild){Z.firstChild.style.width=Z.clientWidth+"px";Z.firstChild.style.height=Z.clientHeight+"px"}}E.init();var I=[];for(var AC=0;AC<16;AC++){for(var AB=0;AB<16;AB++){I[AC*16+AB]=AC.toString(16)+AB.toString(16)}}function V(){return[[1,0,0],[0,1,0],[0,0,1]]}function d(m,j){var i=V();for(var Z=0;Z<3;Z++){for(var AF=0;AF<3;AF++){var p=0;for(var AE=0;AE<3;AE++){p+=m[Z][AE]*j[AE][AF]}i[Z][AF]=p}}return i}function Q(i,Z){Z.fillStyle=i.fillStyle;Z.lineCap=i.lineCap;Z.lineJoin=i.lineJoin;Z.lineWidth=i.lineWidth;Z.miterLimit=i.miterLimit;Z.shadowBlur=i.shadowBlur;Z.shadowColor=i.shadowColor;Z.shadowOffsetX=i.shadowOffsetX;Z.shadowOffsetY=i.shadowOffsetY;Z.strokeStyle=i.strokeStyle;Z.globalAlpha=i.globalAlpha;Z.font=i.font;Z.textAlign=i.textAlign;Z.textBaseline=i.textBaseline;Z.arcScaleX_=i.arcScaleX_;Z.arcScaleY_=i.arcScaleY_;Z.lineScale_=i.lineScale_}var B={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgreen:"#006400",darkgrey:"#A9A9A9",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",grey:"#808080",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgreen:"#90EE90",lightgrey:"#D3D3D3",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",oldlace:"#FDF5E6",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",whitesmoke:"#F5F5F5",yellowgreen:"#9ACD32"};function g(i){var m=i.indexOf("(",3);var Z=i.indexOf(")",m+1);var j=i.substring(m+1,Z).split(",");if(j.length==4&&i.substr(3,1)=="a"){alpha=Number(j[3])}else{j[3]=1}return j}function C(Z){return parseFloat(Z)/100}function N(i,j,Z){return Math.min(Z,Math.max(j,i))}function c(AF){var j,i,Z;h=parseFloat(AF[0])/360%360;if(h<0){h++}s=N(C(AF[1]),0,1);l=N(C(AF[2]),0,1);if(s==0){j=i=Z=l}else{var m=l<0.5?l*(1+s):l+s-l*s;var AE=2*l-m;j=A(AE,m,h+1/3);i=A(AE,m,h);Z=A(AE,m,h-1/3)}return"#"+I[Math.floor(j*255)]+I[Math.floor(i*255)]+I[Math.floor(Z*255)]}function A(i,Z,j){if(j<0){j++}if(j>1){j--}if(6*j<1){return i+(Z-i)*6*j}else{if(2*j<1){return Z}else{if(3*j<2){return i+(Z-i)*(2/3-j)*6}else{return i}}}}function Y(Z){var AE,p=1;Z=String(Z);if(Z.charAt(0)=="#"){AE=Z}else{if(/^rgb/.test(Z)){var m=g(Z);var AE="#",AF;for(var j=0;j<3;j++){if(m[j].indexOf("%")!=-1){AF=Math.floor(C(m[j])*255)}else{AF=Number(m[j])}AE+=I[N(AF,0,255)]}p=m[3]}else{if(/^hsl/.test(Z)){var m=g(Z);AE=c(m);p=m[3]}else{AE=B[Z]||Z}}}return{color:AE,alpha:p}}var L={style:"normal",variant:"normal",weight:"normal",size:10,family:"sans-serif"};var f={};function X(Z){if(f[Z]){return f[Z]}var m=document.createElement("div");var j=m.style;try{j.font=Z}catch(i){}return f[Z]={style:j.fontStyle||L.style,variant:j.fontVariant||L.variant,weight:j.fontWeight||L.weight,size:j.fontSize||L.size,family:j.fontFamily||L.family}}function P(j,i){var Z={};for(var AF in j){Z[AF]=j[AF]}var AE=parseFloat(i.currentStyle.fontSize),m=parseFloat(j.size);if(typeof j.size=="number"){Z.size=j.size}else{if(j.size.indexOf("px")!=-1){Z.size=m}else{if(j.size.indexOf("em")!=-1){Z.size=AE*m}else{if(j.size.indexOf("%")!=-1){Z.size=(AE/100)*m}else{if(j.size.indexOf("pt")!=-1){Z.size=m/0.75}else{Z.size=AE}}}}}Z.size*=0.981;return Z}function AA(Z){return Z.style+" "+Z.variant+" "+Z.weight+" "+Z.size+"px "+Z.family}function t(Z){switch(Z){case"butt":return"flat";case"round":return"round";case"square":default:return"square"}}function W(i){this.m_=V();this.mStack_=[];this.aStack_=[];this.currentPath_=[];this.strokeStyle="#000";this.fillStyle="#000";this.lineWidth=1;this.lineJoin="miter";this.lineCap="butt";this.miterLimit=D*1;this.globalAlpha=1;this.font="10px sans-serif";this.textAlign="left";this.textBaseline="alphabetic";this.canvas=i;var Z=i.ownerDocument.createElement("div");Z.style.width=i.clientWidth+"px";Z.style.height=i.clientHeight+"px";Z.style.overflow="hidden";Z.style.position="absolute";i.appendChild(Z);this.element_=Z;this.arcScaleX_=1;this.arcScaleY_=1;this.lineScale_=1}var M=W.prototype;M.clearRect=function(){if(this.textMeasureEl_){this.textMeasureEl_.removeNode(true);this.textMeasureEl_=null}this.element_.innerHTML=""};M.beginPath=function(){this.currentPath_=[]};M.moveTo=function(i,Z){var j=this.getCoords_(i,Z);this.currentPath_.push({type:"moveTo",x:j.x,y:j.y});this.currentX_=j.x;this.currentY_=j.y};M.lineTo=function(i,Z){var j=this.getCoords_(i,Z);this.currentPath_.push({type:"lineTo",x:j.x,y:j.y});this.currentX_=j.x;this.currentY_=j.y};M.bezierCurveTo=function(j,i,AI,AH,AG,AE){var Z=this.getCoords_(AG,AE);var AF=this.getCoords_(j,i);var m=this.getCoords_(AI,AH);e(this,AF,m,Z)};function e(Z,m,j,i){Z.currentPath_.push({type:"bezierCurveTo",cp1x:m.x,cp1y:m.y,cp2x:j.x,cp2y:j.y,x:i.x,y:i.y});Z.currentX_=i.x;Z.currentY_=i.y}M.quadraticCurveTo=function(AG,j,i,Z){var AF=this.getCoords_(AG,j);var AE=this.getCoords_(i,Z);var AH={x:this.currentX_+2/3*(AF.x-this.currentX_),y:this.currentY_+2/3*(AF.y-this.currentY_)};var m={x:AH.x+(AE.x-this.currentX_)/3,y:AH.y+(AE.y-this.currentY_)/3};e(this,AH,m,AE)};M.arc=function(AJ,AH,AI,AE,i,j){AI*=D;var AN=j?"at":"wa";var AK=AJ+U(AE)*AI-F;var AM=AH+J(AE)*AI-F;var Z=AJ+U(i)*AI-F;var AL=AH+J(i)*AI-F;if(AK==Z&&!j){AK+=0.125}var m=this.getCoords_(AJ,AH);var AG=this.getCoords_(AK,AM);var AF=this.getCoords_(Z,AL);this.currentPath_.push({type:AN,x:m.x,y:m.y,radius:AI,xStart:AG.x,yStart:AG.y,xEnd:AF.x,yEnd:AF.y})};M.rect=function(j,i,Z,m){this.moveTo(j,i);this.lineTo(j+Z,i);this.lineTo(j+Z,i+m);this.lineTo(j,i+m);this.closePath()};M.strokeRect=function(j,i,Z,m){var p=this.currentPath_;this.beginPath();this.moveTo(j,i);this.lineTo(j+Z,i);this.lineTo(j+Z,i+m);this.lineTo(j,i+m);this.closePath();this.stroke();this.currentPath_=p};M.fillRect=function(j,i,Z,m){var p=this.currentPath_;this.beginPath();this.moveTo(j,i);this.lineTo(j+Z,i);this.lineTo(j+Z,i+m);this.lineTo(j,i+m);this.closePath();this.fill();this.currentPath_=p};M.createLinearGradient=function(i,m,Z,j){var p=new v("gradient");p.x0_=i;p.y0_=m;p.x1_=Z;p.y1_=j;return p};M.createRadialGradient=function(m,AE,j,i,p,Z){var AF=new v("gradientradial");AF.x0_=m;AF.y0_=AE;AF.r0_=j;AF.x1_=i;AF.y1_=p;AF.r1_=Z;return AF};M.drawImage=function(AO,j){var AH,AF,AJ,AV,AM,AK,AQ,AX;var AI=AO.runtimeStyle.width;var AN=AO.runtimeStyle.height;AO.runtimeStyle.width="auto";AO.runtimeStyle.height="auto";var AG=AO.width;var AT=AO.height;AO.runtimeStyle.width=AI;AO.runtimeStyle.height=AN;if(arguments.length==3){AH=arguments[1];AF=arguments[2];AM=AK=0;AQ=AJ=AG;AX=AV=AT}else{if(arguments.length==5){AH=arguments[1];AF=arguments[2];AJ=arguments[3];AV=arguments[4];AM=AK=0;AQ=AG;AX=AT}else{if(arguments.length==9){AM=arguments[1];AK=arguments[2];AQ=arguments[3];AX=arguments[4];AH=arguments[5];AF=arguments[6];AJ=arguments[7];AV=arguments[8]}else{throw Error("Invalid number of arguments")}}}var AW=this.getCoords_(AH,AF);var m=AQ/2;var i=AX/2;var AU=[];var Z=10;var AE=10;AU.push(" <g_vml_:group",' coordsize="',D*Z,",",D*AE,'"',' coordorigin="0,0"',' style="width:',Z,"px;height:",AE,"px;position:absolute;");if(this.m_[0][0]!=1||this.m_[0][1]||this.m_[1][1]!=1||this.m_[1][0]){var p=[];p.push("M11=",this.m_[0][0],",","M12=",this.m_[1][0],",","M21=",this.m_[0][1],",","M22=",this.m_[1][1],",","Dx=",K(AW.x/D),",","Dy=",K(AW.y/D),"");var AS=AW;var AR=this.getCoords_(AH+AJ,AF);var AP=this.getCoords_(AH,AF+AV);var AL=this.getCoords_(AH+AJ,AF+AV);AS.x=z.max(AS.x,AR.x,AP.x,AL.x);AS.y=z.max(AS.y,AR.y,AP.y,AL.y);AU.push("padding:0 ",K(AS.x/D),"px ",K(AS.y/D),"px 0;filter:progid:DXImageTransform.Microsoft.Matrix(",p.join(""),", sizingmethod='clip');")}else{AU.push("top:",K(AW.y/D),"px;left:",K(AW.x/D),"px;")}AU.push(' ">','<g_vml_:image src="',AO.src,'"',' style="width:',D*AJ,"px;"," height:",D*AV,'px"',' cropleft="',AM/AG,'"',' croptop="',AK/AT,'"',' cropright="',(AG-AM-AQ)/AG,'"',' cropbottom="',(AT-AK-AX)/AT,'"'," />","</g_vml_:group>");this.element_.insertAdjacentHTML("BeforeEnd",AU.join(""))};M.stroke=function(AM){var m=10;var AN=10;var AE=5000;var AG={x:null,y:null};var AL={x:null,y:null};for(var AH=0;AH<this.currentPath_.length;AH+=AE){var AK=[];var AF=false;AK.push("<g_vml_:shape",' filled="',!!AM,'"',' style="position:absolute;width:',m,"px;height:",AN,'px;"',' coordorigin="0,0"',' coordsize="',D*m,",",D*AN,'"',' stroked="',!AM,'"',' path="');var AO=false;for(var AI=AH;AI<Math.min(AH+AE,this.currentPath_.length);AI++){if(AI%AE==0&&AI>0){AK.push(" m ",K(this.currentPath_[AI-1].x),",",K(this.currentPath_[AI-1].y))}var Z=this.currentPath_[AI];var AJ;switch(Z.type){case"moveTo":AJ=Z;AK.push(" m ",K(Z.x),",",K(Z.y));break;case"lineTo":AK.push(" l ",K(Z.x),",",K(Z.y));break;case"close":AK.push(" x ");Z=null;break;case"bezierCurveTo":AK.push(" c ",K(Z.cp1x),",",K(Z.cp1y),",",K(Z.cp2x),",",K(Z.cp2y),",",K(Z.x),",",K(Z.y));break;case"at":case"wa":AK.push(" ",Z.type," ",K(Z.x-this.arcScaleX_*Z.radius),",",K(Z.y-this.arcScaleY_*Z.radius)," ",K(Z.x+this.arcScaleX_*Z.radius),",",K(Z.y+this.arcScaleY_*Z.radius)," ",K(Z.xStart),",",K(Z.yStart)," ",K(Z.xEnd),",",K(Z.yEnd));break}if(Z){if(AG.x==null||Z.x<AG.x){AG.x=Z.x}if(AL.x==null||Z.x>AL.x){AL.x=Z.x}if(AG.y==null||Z.y<AG.y){AG.y=Z.y}if(AL.y==null||Z.y>AL.y){AL.y=Z.y}}}AK.push(' ">');if(!AM){R(this,AK)}else{a(this,AK,AG,AL)}AK.push("</g_vml_:shape>");this.element_.insertAdjacentHTML("beforeEnd",AK.join(""))}};function R(j,AE){var i=Y(j.strokeStyle);var m=i.color;var p=i.alpha*j.globalAlpha;var Z=j.lineScale_*j.lineWidth;if(Z<1){p*=Z}AE.push("<g_vml_:stroke",' opacity="',p,'"',' joinstyle="',j.lineJoin,'"',' miterlimit="',j.miterLimit,'"',' endcap="',t(j.lineCap),'"',' weight="',Z,'px"',' color="',m,'" />')}function a(AO,AG,Ah,AP){var AH=AO.fillStyle;var AY=AO.arcScaleX_;var AX=AO.arcScaleY_;var Z=AP.x-Ah.x;var m=AP.y-Ah.y;if(AH instanceof v){var AL=0;var Ac={x:0,y:0};var AU=0;var AK=1;if(AH.type_=="gradient"){var AJ=AH.x0_/AY;var j=AH.y0_/AX;var AI=AH.x1_/AY;var Aj=AH.y1_/AX;var Ag=AO.getCoords_(AJ,j);var Af=AO.getCoords_(AI,Aj);var AE=Af.x-Ag.x;var p=Af.y-Ag.y;AL=Math.atan2(AE,p)*180/Math.PI;if(AL<0){AL+=360}if(AL<0.000001){AL=0}}else{var Ag=AO.getCoords_(AH.x0_,AH.y0_);Ac={x:(Ag.x-Ah.x)/Z,y:(Ag.y-Ah.y)/m};Z/=AY*D;m/=AX*D;var Aa=z.max(Z,m);AU=2*AH.r0_/Aa;AK=2*AH.r1_/Aa-AU}var AS=AH.colors_;AS.sort(function(Ak,i){return Ak.offset-i.offset});var AN=AS.length;var AR=AS[0].color;var AQ=AS[AN-1].color;var AW=AS[0].alpha*AO.globalAlpha;var AV=AS[AN-1].alpha*AO.globalAlpha;var Ab=[];for(var Ae=0;Ae<AN;Ae++){var AM=AS[Ae];Ab.push(AM.offset*AK+AU+" "+AM.color)}AG.push('<g_vml_:fill type="',AH.type_,'"',' method="none" focus="100%"',' color="',AR,'"',' color2="',AQ,'"',' colors="',Ab.join(","),'"',' opacity="',AV,'"',' g_o_:opacity2="',AW,'"',' angle="',AL,'"',' focusposition="',Ac.x,",",Ac.y,'" />')}else{if(AH instanceof u){if(Z&&m){var AF=-Ah.x;var AZ=-Ah.y;AG.push("<g_vml_:fill",' position="',AF/Z*AY*AY,",",AZ/m*AX*AX,'"',' type="tile"',' src="',AH.src_,'" />')}}else{var Ai=Y(AO.fillStyle);var AT=Ai.color;var Ad=Ai.alpha*AO.globalAlpha;AG.push('<g_vml_:fill color="',AT,'" opacity="',Ad,'" />')}}}M.fill=function(){this.stroke(true)};M.closePath=function(){this.currentPath_.push({type:"close"})};M.getCoords_=function(j,i){var Z=this.m_;return{x:D*(j*Z[0][0]+i*Z[1][0]+Z[2][0])-F,y:D*(j*Z[0][1]+i*Z[1][1]+Z[2][1])-F}};M.save=function(){var Z={};Q(this,Z);this.aStack_.push(Z);this.mStack_.push(this.m_);this.m_=d(V(),this.m_)};M.restore=function(){if(this.aStack_.length){Q(this.aStack_.pop(),this);this.m_=this.mStack_.pop()}};function H(Z){return isFinite(Z[0][0])&&isFinite(Z[0][1])&&isFinite(Z[1][0])&&isFinite(Z[1][1])&&isFinite(Z[2][0])&&isFinite(Z[2][1])}function y(i,Z,j){if(!H(Z)){return}i.m_=Z;if(j){var p=Z[0][0]*Z[1][1]-Z[0][1]*Z[1][0];i.lineScale_=k(b(p))}}M.translate=function(j,i){var Z=[[1,0,0],[0,1,0],[j,i,1]];y(this,d(Z,this.m_),false)};M.rotate=function(i){var m=U(i);var j=J(i);var Z=[[m,j,0],[-j,m,0],[0,0,1]];y(this,d(Z,this.m_),false)};M.scale=function(j,i){this.arcScaleX_*=j;this.arcScaleY_*=i;var Z=[[j,0,0],[0,i,0],[0,0,1]];y(this,d(Z,this.m_),true)};M.transform=function(p,m,AF,AE,i,Z){var j=[[p,m,0],[AF,AE,0],[i,Z,1]];y(this,d(j,this.m_),true)};M.setTransform=function(AE,p,AG,AF,j,i){var Z=[[AE,p,0],[AG,AF,0],[j,i,1]];y(this,Z,true)};M.drawText_=function(AK,AI,AH,AN,AG){var AM=this.m_,AQ=1000,i=0,AP=AQ,AF={x:0,y:0},AE=[];var Z=P(X(this.font),this.element_);var j=AA(Z);var AR=this.element_.currentStyle;var p=this.textAlign.toLowerCase();switch(p){case"left":case"center":case"right":break;case"end":p=AR.direction=="ltr"?"right":"left";break;case"start":p=AR.direction=="rtl"?"right":"left";break;default:p="left"}switch(this.textBaseline){case"hanging":case"top":AF.y=Z.size/1.75;break;case"middle":break;default:case null:case"alphabetic":case"ideographic":case"bottom":AF.y=-Z.size/2.25;break}switch(p){case"right":i=AQ;AP=0.05;break;case"center":i=AP=AQ/2;break}var AO=this.getCoords_(AI+AF.x,AH+AF.y);AE.push('<g_vml_:line from="',-i,' 0" to="',AP,' 0.05" ',' coordsize="100 100" coordorigin="0 0"',' filled="',!AG,'" stroked="',!!AG,'" style="position:absolute;width:1px;height:1px;">');if(AG){R(this,AE)}else{a(this,AE,{x:-i,y:0},{x:AP,y:Z.size})}var AL=AM[0][0].toFixed(3)+","+AM[1][0].toFixed(3)+","+AM[0][1].toFixed(3)+","+AM[1][1].toFixed(3)+",0,0";var AJ=K(AO.x/D)+","+K(AO.y/D);AE.push('<g_vml_:skew on="t" matrix="',AL,'" ',' offset="',AJ,'" origin="',i,' 0" />','<g_vml_:path textpathok="true" />','<g_vml_:textpath on="true" string="',AD(AK),'" style="v-text-align:',p,";font:",AD(j),'" /></g_vml_:line>');this.element_.insertAdjacentHTML("beforeEnd",AE.join(""))};M.fillText=function(j,Z,m,i){this.drawText_(j,Z,m,i,false)};M.strokeText=function(j,Z,m,i){this.drawText_(j,Z,m,i,true)};M.measureText=function(j){if(!this.textMeasureEl_){var Z='<span style="position:absolute;top:-20000px;left:0;padding:0;margin:0;border:none;white-space:pre;"></span>';this.element_.insertAdjacentHTML("beforeEnd",Z);this.textMeasureEl_=this.element_.lastChild}var i=this.element_.ownerDocument;this.textMeasureEl_.innerHTML="";this.textMeasureEl_.style.font=this.font;this.textMeasureEl_.appendChild(i.createTextNode(j));return{width:this.textMeasureEl_.offsetWidth}};M.clip=function(){};M.arcTo=function(){};M.createPattern=function(i,Z){return new u(i,Z)};function v(Z){this.type_=Z;this.x0_=0;this.y0_=0;this.r0_=0;this.x1_=0;this.y1_=0;this.r1_=0;this.colors_=[]}v.prototype.addColorStop=function(i,Z){Z=Y(Z);this.colors_.push({offset:i,color:Z.color,alpha:Z.alpha})};function u(i,Z){q(i);switch(Z){case"repeat":case null:case"":this.repetition_="repeat";break;case"repeat-x":case"repeat-y":case"no-repeat":this.repetition_=Z;break;default:n("SYNTAX_ERR")}this.src_=i.src;this.width_=i.width;this.height_=i.height}function n(Z){throw new o(Z)}function q(Z){if(!Z||Z.nodeType!=1||Z.tagName!="IMG"){n("TYPE_MISMATCH_ERR")}if(Z.readyState!="complete"){n("INVALID_STATE_ERR")}}function o(Z){this.code=this[Z];this.message=Z+": DOM Exception "+this.code}var x=o.prototype=new Error;x.INDEX_SIZE_ERR=1;x.DOMSTRING_SIZE_ERR=2;x.HIERARCHY_REQUEST_ERR=3;x.WRONG_DOCUMENT_ERR=4;x.INVALID_CHARACTER_ERR=5;x.NO_DATA_ALLOWED_ERR=6;x.NO_MODIFICATION_ALLOWED_ERR=7;x.NOT_FOUND_ERR=8;x.NOT_SUPPORTED_ERR=9;x.INUSE_ATTRIBUTE_ERR=10;x.INVALID_STATE_ERR=11;x.SYNTAX_ERR=12;x.INVALID_MODIFICATION_ERR=13;x.NAMESPACE_ERR=14;x.INVALID_ACCESS_ERR=15;x.VALIDATION_ERR=16;x.TYPE_MISMATCH_ERR=17;G_vmlCanvasManager=E;CanvasRenderingContext2D=W;CanvasGradient=v;CanvasPattern=u;DOMException=o})()};

(function(){jQuery.color={};jQuery.color.make=function(G,H,J,I){var A={};A.r=G||0;A.g=H||0;A.b=J||0;A.a=I!=null?I:1;A.add=function(C,D){for(var E=0;E<C.length;++E){A[C.charAt(E)]+=D}return A.normalize()};A.scale=function(C,D){for(var E=0;E<C.length;++E){A[C.charAt(E)]*=D}return A.normalize()};A.toString=function(){if(A.a>=1){return"rgb("+[A.r,A.g,A.b].join(",")+")"}else{return"rgba("+[A.r,A.g,A.b,A.a].join(",")+")"}};A.normalize=function(){function C(E,D,F){return D<E?E:(D>F?F:D)}A.r=C(0,parseInt(A.r),255);A.g=C(0,parseInt(A.g),255);A.b=C(0,parseInt(A.b),255);A.a=C(0,A.a,1);return A};A.clone=function(){return jQuery.color.make(A.r,A.b,A.g,A.a)};return A.normalize()};jQuery.color.extract=function(E,F){var A;do{A=E.css(F).toLowerCase();if(A!=""&&A!="transparent"){break}E=E.parent()}while(!jQuery.nodeName(E.get(0),"body"));if(A=="rgba(0, 0, 0, 0)"){A="transparent"}return jQuery.color.parse(A)};jQuery.color.parse=function(A){var F,H=jQuery.color.make;if(F=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(A)){return H(parseInt(F[1],10),parseInt(F[2],10),parseInt(F[3],10))}if(F=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(A)){return H(parseInt(F[1],10),parseInt(F[2],10),parseInt(F[3],10),parseFloat(F[4]))}if(F=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(A)){return H(parseFloat(F[1])*2.55,parseFloat(F[2])*2.55,parseFloat(F[3])*2.55)}if(F=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(A)){return H(parseFloat(F[1])*2.55,parseFloat(F[2])*2.55,parseFloat(F[3])*2.55,parseFloat(F[4]))}if(F=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(A)){return H(parseInt(F[1],16),parseInt(F[2],16),parseInt(F[3],16))}if(F=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(A)){return H(parseInt(F[1]+F[1],16),parseInt(F[2]+F[2],16),parseInt(F[3]+F[3],16))}var G=jQuery.trim(A).toLowerCase();if(G=="transparent"){return H(255,255,255,0)}else{F=B[G];return H(F[0],F[1],F[2])}};var B={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})();(function(C){function B(l,W,X,E){var O=[],g={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:true,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:0.85},xaxis:{mode:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,tickDecimals:null,tickSize:null,minTickSize:null,monthNames:null,timeformat:null,twelveHourClock:false},yaxis:{autoscaleMargin:0.02},x2axis:{autoscaleMargin:null},y2axis:{autoscaleMargin:0.02},series:{points:{show:false,radius:3,lineWidth:2,fill:true,fillColor:"#ffffff"},lines:{lineWidth:2,fill:false,fillColor:null,steps:false},bars:{show:false,lineWidth:2,barWidth:1,fill:true,fillColor:null,align:"left",horizontal:false},shadowSize:3},grid:{show:true,aboveData:false,color:"#545454",backgroundColor:null,tickColor:"rgba(0,0,0,0.15)",labelMargin:5,borderWidth:2,borderColor:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:false,hoverable:false,autoHighlight:true,mouseActiveRadius:10},hooks:{}},P=null,AC=null,AD=null,Y=null,AJ=null,s={xaxis:{},yaxis:{},x2axis:{},y2axis:{}},e={left:0,right:0,top:0,bottom:0},y=0,Q=0,I=0,t=0,L={processOptions:[],processRawData:[],processDatapoints:[],draw:[],bindEvents:[],drawOverlay:[]},G=this;G.setData=f;G.setupGrid=k;G.draw=AH;G.getPlaceholder=function(){return l};G.getCanvas=function(){return P};G.getPlotOffset=function(){return e};G.width=function(){return I};G.height=function(){return t};G.offset=function(){var AK=AD.offset();AK.left+=e.left;AK.top+=e.top;return AK};G.getData=function(){return O};G.getAxes=function(){return s};G.getOptions=function(){return g};G.highlight=AE;G.unhighlight=x;G.triggerRedrawOverlay=q;G.pointOffset=function(AK){return{left:parseInt(T(AK,"xaxis").p2c(+AK.x)+e.left),top:parseInt(T(AK,"yaxis").p2c(+AK.y)+e.top)}};G.hooks=L;b(G);r(X);c();f(W);k();AH();AG();function Z(AM,AK){AK=[G].concat(AK);for(var AL=0;AL<AM.length;++AL){AM[AL].apply(this,AK)}}function b(){for(var AK=0;AK<E.length;++AK){var AL=E[AK];AL.init(G);if(AL.options){C.extend(true,g,AL.options)}}}function r(AK){C.extend(true,g,AK);if(g.grid.borderColor==null){g.grid.borderColor=g.grid.color}if(g.xaxis.noTicks&&g.xaxis.ticks==null){g.xaxis.ticks=g.xaxis.noTicks}if(g.yaxis.noTicks&&g.yaxis.ticks==null){g.yaxis.ticks=g.yaxis.noTicks}if(g.grid.coloredAreas){g.grid.markings=g.grid.coloredAreas}if(g.grid.coloredAreasColor){g.grid.markingsColor=g.grid.coloredAreasColor}if(g.lines){C.extend(true,g.series.lines,g.lines)}if(g.points){C.extend(true,g.series.points,g.points)}if(g.bars){C.extend(true,g.series.bars,g.bars)}if(g.shadowSize){g.series.shadowSize=g.shadowSize}for(var AL in L){if(g.hooks[AL]&&g.hooks[AL].length){L[AL]=L[AL].concat(g.hooks[AL])}}Z(L.processOptions,[g])}function f(AK){O=M(AK);U();m()}function M(AN){var AL=[];for(var AK=0;AK<AN.length;++AK){var AM=C.extend(true,{},g.series);if(AN[AK].data){AM.data=AN[AK].data;delete AN[AK].data;C.extend(true,AM,AN[AK]);AN[AK].data=AM.data}else{AM.data=AN[AK]}AL.push(AM)}return AL}function T(AM,AK){var AL=AM[AK];if(!AL||AL==1){return s[AK]}if(typeof AL=="number"){return s[AK.charAt(0)+AL+AK.slice(1)]}return AL}function U(){var AP;var AV=O.length,AK=[],AN=[];for(AP=0;AP<O.length;++AP){var AS=O[AP].color;if(AS!=null){--AV;if(typeof AS=="number"){AN.push(AS)}else{AK.push(C.color.parse(O[AP].color))}}}for(AP=0;AP<AN.length;++AP){AV=Math.max(AV,AN[AP]+1)}var AL=[],AO=0;AP=0;while(AL.length<AV){var AR;if(g.colors.length==AP){AR=C.color.make(100,100,100)}else{AR=C.color.parse(g.colors[AP])}var AM=AO%2==1?-1:1;AR.scale("rgb",1+AM*Math.ceil(AO/2)*0.2);AL.push(AR);++AP;if(AP>=g.colors.length){AP=0;++AO}}var AQ=0,AW;for(AP=0;AP<O.length;++AP){AW=O[AP];if(AW.color==null){AW.color=AL[AQ].toString();++AQ}else{if(typeof AW.color=="number"){AW.color=AL[AW.color].toString()}}if(AW.lines.show==null){var AU,AT=true;for(AU in AW){if(AW[AU].show){AT=false;break}}if(AT){AW.lines.show=true}}AW.xaxis=T(AW,"xaxis");AW.yaxis=T(AW,"yaxis")}}function m(){var AW=Number.POSITIVE_INFINITY,AQ=Number.NEGATIVE_INFINITY,Ac,Aa,AZ,AV,AL,AR,Ab,AX,AP,AO,AK,Ai,Af,AT;for(AK in s){s[AK].datamin=AW;s[AK].datamax=AQ;s[AK].used=false}function AN(Al,Ak,Aj){if(Ak<Al.datamin){Al.datamin=Ak}if(Aj>Al.datamax){Al.datamax=Aj}}for(Ac=0;Ac<O.length;++Ac){AR=O[Ac];AR.datapoints={points:[]};Z(L.processRawData,[AR,AR.data,AR.datapoints])}for(Ac=0;Ac<O.length;++Ac){AR=O[Ac];var Ah=AR.data,Ae=AR.datapoints.format;if(!Ae){Ae=[];Ae.push({x:true,number:true,required:true});Ae.push({y:true,number:true,required:true});if(AR.bars.show){Ae.push({y:true,number:true,required:false,defaultValue:0})}AR.datapoints.format=Ae}if(AR.datapoints.pointsize!=null){continue}if(AR.datapoints.pointsize==null){AR.datapoints.pointsize=Ae.length}AX=AR.datapoints.pointsize;Ab=AR.datapoints.points;insertSteps=AR.lines.show&&AR.lines.steps;AR.xaxis.used=AR.yaxis.used=true;for(Aa=AZ=0;Aa<Ah.length;++Aa,AZ+=AX){AT=Ah[Aa];var AM=AT==null;if(!AM){for(AV=0;AV<AX;++AV){Ai=AT[AV];Af=Ae[AV];if(Af){if(Af.number&&Ai!=null){Ai=+Ai;if(isNaN(Ai)){Ai=null}}if(Ai==null){if(Af.required){AM=true}if(Af.defaultValue!=null){Ai=Af.defaultValue}}}Ab[AZ+AV]=Ai}}if(AM){for(AV=0;AV<AX;++AV){Ai=Ab[AZ+AV];if(Ai!=null){Af=Ae[AV];if(Af.x){AN(AR.xaxis,Ai,Ai)}if(Af.y){AN(AR.yaxis,Ai,Ai)}}Ab[AZ+AV]=null}}else{if(insertSteps&&AZ>0&&Ab[AZ-AX]!=null&&Ab[AZ-AX]!=Ab[AZ]&&Ab[AZ-AX+1]!=Ab[AZ+1]){for(AV=0;AV<AX;++AV){Ab[AZ+AX+AV]=Ab[AZ+AV]}Ab[AZ+1]=Ab[AZ-AX+1];AZ+=AX}}}}for(Ac=0;Ac<O.length;++Ac){AR=O[Ac];Z(L.processDatapoints,[AR,AR.datapoints])}for(Ac=0;Ac<O.length;++Ac){AR=O[Ac];Ab=AR.datapoints.points,AX=AR.datapoints.pointsize;var AS=AW,AY=AW,AU=AQ,Ad=AQ;for(Aa=0;Aa<Ab.length;Aa+=AX){if(Ab[Aa]==null){continue}for(AV=0;AV<AX;++AV){Ai=Ab[Aa+AV];Af=Ae[AV];if(!Af){continue}if(Af.x){if(Ai<AS){AS=Ai}if(Ai>AU){AU=Ai}}if(Af.y){if(Ai<AY){AY=Ai}if(Ai>Ad){Ad=Ai}}}}if(AR.bars.show){var Ag=AR.bars.align=="left"?0:-AR.bars.barWidth/2;if(AR.bars.horizontal){AY+=Ag;Ad+=Ag+AR.bars.barWidth}else{AS+=Ag;AU+=Ag+AR.bars.barWidth}}AN(AR.xaxis,AS,AU);AN(AR.yaxis,AY,Ad)}for(AK in s){if(s[AK].datamin==AW){s[AK].datamin=null}if(s[AK].datamax==AQ){s[AK].datamax=null}}}function c(){function AK(AM,AL){var AN=document.createElement("canvas");AN.width=AM;AN.height=AL;if(C.browser.msie){AN=window.G_vmlCanvasManager.initElement(AN)}return AN}y=l.width();Q=l.height();l.html("");if(l.css("position")=="static"){l.css("position","relative")}if(y<=0||Q<=0){throw"Invalid dimensions for plot, width = "+y+", height = "+Q}if(C.browser.msie){window.G_vmlCanvasManager.init_(document)}P=C(AK(y,Q)).appendTo(l).get(0);Y=P.getContext("2d");AC=C(AK(y,Q)).css({position:"absolute",left:0,top:0}).appendTo(l).get(0);AJ=AC.getContext("2d");AJ.stroke()}function AG(){AD=C([AC,P]);if(g.grid.hoverable){AD.mousemove(D)}if(g.grid.clickable){AD.click(d)}Z(L.bindEvents,[AD])}function k(){function AL(AT,AU){function AP(AV){return AV}var AS,AO,AQ=AU.transform||AP,AR=AU.inverseTransform;if(AT==s.xaxis||AT==s.x2axis){AS=AT.scale=I/(AQ(AT.max)-AQ(AT.min));AO=AQ(AT.min);if(AQ==AP){AT.p2c=function(AV){return(AV-AO)*AS}}else{AT.p2c=function(AV){return(AQ(AV)-AO)*AS}}if(!AR){AT.c2p=function(AV){return AO+AV/AS}}else{AT.c2p=function(AV){return AR(AO+AV/AS)}}}else{AS=AT.scale=t/(AQ(AT.max)-AQ(AT.min));AO=AQ(AT.max);if(AQ==AP){AT.p2c=function(AV){return(AO-AV)*AS}}else{AT.p2c=function(AV){return(AO-AQ(AV))*AS}}if(!AR){AT.c2p=function(AV){return AO-AV/AS}}else{AT.c2p=function(AV){return AR(AO-AV/AS)}}}}function AN(AR,AT){var AQ,AS=[],AP;AR.labelWidth=AT.labelWidth;AR.labelHeight=AT.labelHeight;if(AR==s.xaxis||AR==s.x2axis){if(AR.labelWidth==null){AR.labelWidth=y/(AR.ticks.length>0?AR.ticks.length:1)}if(AR.labelHeight==null){AS=[];for(AQ=0;AQ<AR.ticks.length;++AQ){AP=AR.ticks[AQ].label;if(AP){AS.push('<div class="tickLabel" style="float:left;width:'+AR.labelWidth+'px">'+AP+"</div>")}}if(AS.length>0){var AO=C('<div style="position:absolute;top:-10000px;width:10000px;font-size:smaller">'+AS.join("")+'<div style="clear:left"></div></div>').appendTo(l);AR.labelHeight=AO.height();AO.remove()}}}else{if(AR.labelWidth==null||AR.labelHeight==null){for(AQ=0;AQ<AR.ticks.length;++AQ){AP=AR.ticks[AQ].label;if(AP){AS.push('<div class="tickLabel">'+AP+"</div>")}}if(AS.length>0){var AO=C('<div style="position:absolute;top:-10000px;font-size:smaller">'+AS.join("")+"</div>").appendTo(l);if(AR.labelWidth==null){AR.labelWidth=AO.width()}if(AR.labelHeight==null){AR.labelHeight=AO.find("div").height()}AO.remove()}}}if(AR.labelWidth==null){AR.labelWidth=0}if(AR.labelHeight==null){AR.labelHeight=0}}function AM(){var AP=g.grid.borderWidth;for(i=0;i<O.length;++i){AP=Math.max(AP,2*(O[i].points.radius+O[i].points.lineWidth/2))}e.left=e.right=e.top=e.bottom=AP;var AO=g.grid.labelMargin+g.grid.borderWidth;if(s.xaxis.labelHeight>0){e.bottom=Math.max(AP,s.xaxis.labelHeight+AO)}if(s.yaxis.labelWidth>0){e.left=Math.max(AP,s.yaxis.labelWidth+AO)}if(s.x2axis.labelHeight>0){e.top=Math.max(AP,s.x2axis.labelHeight+AO)}if(s.y2axis.labelWidth>0){e.right=Math.max(AP,s.y2axis.labelWidth+AO)}I=y-e.left-e.right;t=Q-e.bottom-e.top}var AK;for(AK in s){K(s[AK],g[AK])}if(g.grid.show){for(AK in s){F(s[AK],g[AK]);p(s[AK],g[AK]);AN(s[AK],g[AK])}AM()}else{e.left=e.right=e.top=e.bottom=0;I=y;t=Q}for(AK in s){AL(s[AK],g[AK])}if(g.grid.show){h()}AI()}function K(AN,AQ){var AM=+(AQ.min!=null?AQ.min:AN.datamin),AK=+(AQ.max!=null?AQ.max:AN.datamax),AP=AK-AM;if(AP==0){var AL=AK==0?1:0.01;if(AQ.min==null){AM-=AL}if(AQ.max==null||AQ.min!=null){AK+=AL}}else{var AO=AQ.autoscaleMargin;if(AO!=null){if(AQ.min==null){AM-=AP*AO;if(AM<0&&AN.datamin!=null&&AN.datamin>=0){AM=0}}if(AQ.max==null){AK+=AP*AO;if(AK>0&&AN.datamax!=null&&AN.datamax<=0){AK=0}}}}AN.min=AM;AN.max=AK}function F(AP,AS){var AO;if(typeof AS.ticks=="number"&&AS.ticks>0){AO=AS.ticks}else{if(AP==s.xaxis||AP==s.x2axis){AO=0.3*Math.sqrt(y)}else{AO=0.3*Math.sqrt(Q)}}var AX=(AP.max-AP.min)/AO,AZ,AT,AV,AW,AR,AM,AL;if(AS.mode=="time"){var AU={second:1000,minute:60*1000,hour:60*60*1000,day:24*60*60*1000,month:30*24*60*60*1000,year:365.2425*24*60*60*1000};var AY=[[1,"second"],[2,"second"],[5,"second"],[10,"second"],[30,"second"],[1,"minute"],[2,"minute"],[5,"minute"],[10,"minute"],[30,"minute"],[1,"hour"],[2,"hour"],[4,"hour"],[8,"hour"],[12,"hour"],[1,"day"],[2,"day"],[3,"day"],[0.25,"month"],[0.5,"month"],[1,"month"],[2,"month"],[3,"month"],[6,"month"],[1,"year"]];var AN=0;if(AS.minTickSize!=null){if(typeof AS.tickSize=="number"){AN=AS.tickSize}else{AN=AS.minTickSize[0]*AU[AS.minTickSize[1]]}}for(AR=0;AR<AY.length-1;++AR){if(AX<(AY[AR][0]*AU[AY[AR][1]]+AY[AR+1][0]*AU[AY[AR+1][1]])/2&&AY[AR][0]*AU[AY[AR][1]]>=AN){break}}AZ=AY[AR][0];AV=AY[AR][1];if(AV=="year"){AM=Math.pow(10,Math.floor(Math.log(AX/AU.year)/Math.LN10));AL=(AX/AU.year)/AM;if(AL<1.5){AZ=1}else{if(AL<3){AZ=2}else{if(AL<7.5){AZ=5}else{AZ=10}}}AZ*=AM}if(AS.tickSize){AZ=AS.tickSize[0];AV=AS.tickSize[1]}AT=function(Ac){var Ah=[],Af=Ac.tickSize[0],Ai=Ac.tickSize[1],Ag=new Date(Ac.min);var Ab=Af*AU[Ai];if(Ai=="second"){Ag.setUTCSeconds(A(Ag.getUTCSeconds(),Af))}if(Ai=="minute"){Ag.setUTCMinutes(A(Ag.getUTCMinutes(),Af))}if(Ai=="hour"){Ag.setUTCHours(A(Ag.getUTCHours(),Af))}if(Ai=="month"){Ag.setUTCMonth(A(Ag.getUTCMonth(),Af))}if(Ai=="year"){Ag.setUTCFullYear(A(Ag.getUTCFullYear(),Af))}Ag.setUTCMilliseconds(0);if(Ab>=AU.minute){Ag.setUTCSeconds(0)}if(Ab>=AU.hour){Ag.setUTCMinutes(0)}if(Ab>=AU.day){Ag.setUTCHours(0)}if(Ab>=AU.day*4){Ag.setUTCDate(1)}if(Ab>=AU.year){Ag.setUTCMonth(0)}var Ak=0,Aj=Number.NaN,Ad;do{Ad=Aj;Aj=Ag.getTime();Ah.push({v:Aj,label:Ac.tickFormatter(Aj,Ac)});if(Ai=="month"){if(Af<1){Ag.setUTCDate(1);var Aa=Ag.getTime();Ag.setUTCMonth(Ag.getUTCMonth()+1);var Ae=Ag.getTime();Ag.setTime(Aj+Ak*AU.hour+(Ae-Aa)*Af);Ak=Ag.getUTCHours();Ag.setUTCHours(0)}else{Ag.setUTCMonth(Ag.getUTCMonth()+Af)}}else{if(Ai=="year"){Ag.setUTCFullYear(Ag.getUTCFullYear()+Af)}else{Ag.setTime(Aj+Ab)}}}while(Aj<Ac.max&&Aj!=Ad);return Ah};AW=function(Aa,Ad){var Af=new Date(Aa);if(AS.timeformat!=null){return C.plot.formatDate(Af,AS.timeformat,AS.monthNames)}var Ab=Ad.tickSize[0]*AU[Ad.tickSize[1]];var Ac=Ad.max-Ad.min;var Ae=(AS.twelveHourClock)?" %p":"";if(Ab<AU.minute){fmt="%h:%M:%S"+Ae}else{if(Ab<AU.day){if(Ac<2*AU.day){fmt="%h:%M"+Ae}else{fmt="%b %d %h:%M"+Ae}}else{if(Ab<AU.month){fmt="%b %d"}else{if(Ab<AU.year){if(Ac<AU.year){fmt="%b"}else{fmt="%b %y"}}else{fmt="%y"}}}}return C.plot.formatDate(Af,fmt,AS.monthNames)}}else{var AK=AS.tickDecimals;var AQ=-Math.floor(Math.log(AX)/Math.LN10);if(AK!=null&&AQ>AK){AQ=AK}AM=Math.pow(10,-AQ);AL=AX/AM;if(AL<1.5){AZ=1}else{if(AL<3){AZ=2;if(AL>2.25&&(AK==null||AQ+1<=AK)){AZ=2.5;++AQ}}else{if(AL<7.5){AZ=5}else{AZ=10}}}AZ*=AM;if(AS.minTickSize!=null&&AZ<AS.minTickSize){AZ=AS.minTickSize}if(AS.tickSize!=null){AZ=AS.tickSize}AP.tickDecimals=Math.max(0,(AK!=null)?AK:AQ);AT=function(Ac){var Ae=[];var Af=A(Ac.min,Ac.tickSize),Ab=0,Aa=Number.NaN,Ad;do{Ad=Aa;Aa=Af+Ab*Ac.tickSize;Ae.push({v:Aa,label:Ac.tickFormatter(Aa,Ac)});++Ab}while(Aa<Ac.max&&Aa!=Ad);return Ae};AW=function(Aa,Ab){return Aa.toFixed(Ab.tickDecimals)}}AP.tickSize=AV?[AZ,AV]:AZ;AP.tickGenerator=AT;if(C.isFunction(AS.tickFormatter)){AP.tickFormatter=function(Aa,Ab){return""+AS.tickFormatter(Aa,Ab)}}else{AP.tickFormatter=AW}}function p(AO,AQ){AO.ticks=[];if(!AO.used){return}if(AQ.ticks==null){AO.ticks=AO.tickGenerator(AO)}else{if(typeof AQ.ticks=="number"){if(AQ.ticks>0){AO.ticks=AO.tickGenerator(AO)}}else{if(AQ.ticks){var AP=AQ.ticks;if(C.isFunction(AP)){AP=AP({min:AO.min,max:AO.max})}var AN,AK;for(AN=0;AN<AP.length;++AN){var AL=null;var AM=AP[AN];if(typeof AM=="object"){AK=AM[0];if(AM.length>1){AL=AM[1]}}else{AK=AM}if(AL==null){AL=AO.tickFormatter(AK,AO)}AO.ticks[AN]={v:AK,label:AL}}}}}if(AQ.autoscaleMargin!=null&&AO.ticks.length>0){if(AQ.min==null){AO.min=Math.min(AO.min,AO.ticks[0].v)}if(AQ.max==null&&AO.ticks.length>1){AO.max=Math.max(AO.max,AO.ticks[AO.ticks.length-1].v)}}}function AH(){Y.clearRect(0,0,y,Q);var AL=g.grid;if(AL.show&&!AL.aboveData){S()}for(var AK=0;AK<O.length;++AK){AA(O[AK])}Z(L.draw,[Y]);if(AL.show&&AL.aboveData){S()}}function N(AL,AR){var AO=AR+"axis",AK=AR+"2axis",AN,AQ,AP,AM;if(AL[AO]){AN=s[AO];AQ=AL[AO].from;AP=AL[AO].to}else{if(AL[AK]){AN=s[AK];AQ=AL[AK].from;AP=AL[AK].to}else{AN=s[AO];AQ=AL[AR+"1"];AP=AL[AR+"2"]}}if(AQ!=null&&AP!=null&&AQ>AP){return{from:AP,to:AQ,axis:AN}}return{from:AQ,to:AP,axis:AN}}function S(){var AO;Y.save();Y.translate(e.left,e.top);if(g.grid.backgroundColor){Y.fillStyle=R(g.grid.backgroundColor,t,0,"rgba(255, 255, 255, 0)");Y.fillRect(0,0,I,t)}var AL=g.grid.markings;if(AL){if(C.isFunction(AL)){AL=AL({xmin:s.xaxis.min,xmax:s.xaxis.max,ymin:s.yaxis.min,ymax:s.yaxis.max,xaxis:s.xaxis,yaxis:s.yaxis,x2axis:s.x2axis,y2axis:s.y2axis})}for(AO=0;AO<AL.length;++AO){var AK=AL[AO],AQ=N(AK,"x"),AN=N(AK,"y");if(AQ.from==null){AQ.from=AQ.axis.min}if(AQ.to==null){AQ.to=AQ.axis.max}if(AN.from==null){AN.from=AN.axis.min}if(AN.to==null){AN.to=AN.axis.max}if(AQ.to<AQ.axis.min||AQ.from>AQ.axis.max||AN.to<AN.axis.min||AN.from>AN.axis.max){continue}AQ.from=Math.max(AQ.from,AQ.axis.min);AQ.to=Math.min(AQ.to,AQ.axis.max);AN.from=Math.max(AN.from,AN.axis.min);AN.to=Math.min(AN.to,AN.axis.max);if(AQ.from==AQ.to&&AN.from==AN.to){continue}AQ.from=AQ.axis.p2c(AQ.from);AQ.to=AQ.axis.p2c(AQ.to);AN.from=AN.axis.p2c(AN.from);AN.to=AN.axis.p2c(AN.to);if(AQ.from==AQ.to||AN.from==AN.to){Y.beginPath();Y.strokeStyle=AK.color||g.grid.markingsColor;Y.lineWidth=AK.lineWidth||g.grid.markingsLineWidth;Y.moveTo(AQ.from,AN.from);Y.lineTo(AQ.to,AN.to);Y.stroke()}else{Y.fillStyle=AK.color||g.grid.markingsColor;Y.fillRect(AQ.from,AN.to,AQ.to-AQ.from,AN.from-AN.to)}}}Y.lineWidth=1;Y.strokeStyle=g.grid.tickColor;Y.beginPath();var AM,AP=s.xaxis;for(AO=0;AO<AP.ticks.length;++AO){AM=AP.ticks[AO].v;if(AM<=AP.min||AM>=s.xaxis.max){continue}Y.moveTo(Math.floor(AP.p2c(AM))+Y.lineWidth/2,0);Y.lineTo(Math.floor(AP.p2c(AM))+Y.lineWidth/2,t)}AP=s.yaxis;for(AO=0;AO<AP.ticks.length;++AO){AM=AP.ticks[AO].v;if(AM<=AP.min||AM>=AP.max){continue}Y.moveTo(0,Math.floor(AP.p2c(AM))+Y.lineWidth/2);Y.lineTo(I,Math.floor(AP.p2c(AM))+Y.lineWidth/2)}AP=s.x2axis;for(AO=0;AO<AP.ticks.length;++AO){AM=AP.ticks[AO].v;if(AM<=AP.min||AM>=AP.max){continue}Y.moveTo(Math.floor(AP.p2c(AM))+Y.lineWidth/2,-5);Y.lineTo(Math.floor(AP.p2c(AM))+Y.lineWidth/2,5)}AP=s.y2axis;for(AO=0;AO<AP.ticks.length;++AO){AM=AP.ticks[AO].v;if(AM<=AP.min||AM>=AP.max){continue}Y.moveTo(I-5,Math.floor(AP.p2c(AM))+Y.lineWidth/2);Y.lineTo(I+5,Math.floor(AP.p2c(AM))+Y.lineWidth/2)}Y.stroke();if(g.grid.borderWidth){var AR=g.grid.borderWidth;Y.lineWidth=AR;Y.strokeStyle=g.grid.borderColor;Y.strokeRect(-AR/2,-AR/2,I+AR,t+AR)}Y.restore()}function h(){l.find(".tickLabels").remove();var AK=['<div class="tickLabels" style="font-size:smaller;color:'+g.grid.color+'">'];function AM(AP,AQ){for(var AO=0;AO<AP.ticks.length;++AO){var AN=AP.ticks[AO];if(!AN.label||AN.v<AP.min||AN.v>AP.max){continue}AK.push(AQ(AN,AP))}}var AL=g.grid.labelMargin+g.grid.borderWidth;AM(s.xaxis,function(AN,AO){return'<div style="position:absolute;top:'+(e.top+t+AL)+"px;left:"+Math.round(e.left+AO.p2c(AN.v)-AO.labelWidth/2)+"px;width:"+AO.labelWidth+'px;text-align:center" class="tickLabel">'+AN.label+"</div>"});AM(s.yaxis,function(AN,AO){return'<div style="position:absolute;top:'+Math.round(e.top+AO.p2c(AN.v)-AO.labelHeight/2)+"px;right:"+(e.right+I+AL)+"px;width:"+AO.labelWidth+'px;text-align:right" class="tickLabel">'+AN.label+"</div>"});AM(s.x2axis,function(AN,AO){return'<div style="position:absolute;bottom:'+(e.bottom+t+AL)+"px;left:"+Math.round(e.left+AO.p2c(AN.v)-AO.labelWidth/2)+"px;width:"+AO.labelWidth+'px;text-align:center" class="tickLabel">'+AN.label+"</div>"});AM(s.y2axis,function(AN,AO){return'<div style="position:absolute;top:'+Math.round(e.top+AO.p2c(AN.v)-AO.labelHeight/2)+"px;left:"+(e.left+I+AL)+"px;width:"+AO.labelWidth+'px;text-align:left" class="tickLabel">'+AN.label+"</div>"});AK.push("</div>");l.append(AK.join(""))}function AA(AK){if(AK.lines.show){a(AK)}if(AK.bars.show){n(AK)}if(AK.points.show){o(AK)}}function a(AN){function AM(AY,AZ,AR,Ad,Ac){var Ae=AY.points,AS=AY.pointsize,AW=null,AV=null;Y.beginPath();for(var AX=AS;AX<Ae.length;AX+=AS){var AU=Ae[AX-AS],Ab=Ae[AX-AS+1],AT=Ae[AX],Aa=Ae[AX+1];if(AU==null||AT==null){continue}if(Ab<=Aa&&Ab<Ac.min){if(Aa<Ac.min){continue}AU=(Ac.min-Ab)/(Aa-Ab)*(AT-AU)+AU;Ab=Ac.min}else{if(Aa<=Ab&&Aa<Ac.min){if(Ab<Ac.min){continue}AT=(Ac.min-Ab)/(Aa-Ab)*(AT-AU)+AU;Aa=Ac.min}}if(Ab>=Aa&&Ab>Ac.max){if(Aa>Ac.max){continue}AU=(Ac.max-Ab)/(Aa-Ab)*(AT-AU)+AU;Ab=Ac.max}else{if(Aa>=Ab&&Aa>Ac.max){if(Ab>Ac.max){continue}AT=(Ac.max-Ab)/(Aa-Ab)*(AT-AU)+AU;Aa=Ac.max}}if(AU<=AT&&AU<Ad.min){if(AT<Ad.min){continue}Ab=(Ad.min-AU)/(AT-AU)*(Aa-Ab)+Ab;AU=Ad.min}else{if(AT<=AU&&AT<Ad.min){if(AU<Ad.min){continue}Aa=(Ad.min-AU)/(AT-AU)*(Aa-Ab)+Ab;AT=Ad.min}}if(AU>=AT&&AU>Ad.max){if(AT>Ad.max){continue}Ab=(Ad.max-AU)/(AT-AU)*(Aa-Ab)+Ab;AU=Ad.max}else{if(AT>=AU&&AT>Ad.max){if(AU>Ad.max){continue}Aa=(Ad.max-AU)/(AT-AU)*(Aa-Ab)+Ab;AT=Ad.max}}if(AU!=AW||Ab!=AV){Y.moveTo(Ad.p2c(AU)+AZ,Ac.p2c(Ab)+AR)}AW=AT;AV=Aa;Y.lineTo(Ad.p2c(AT)+AZ,Ac.p2c(Aa)+AR)}Y.stroke()}function AO(AX,Ae,Ac){var Af=AX.points,AR=AX.pointsize,AS=Math.min(Math.max(0,Ac.min),Ac.max),Aa,AV=0,Ad=false;for(var AW=AR;AW<Af.length;AW+=AR){var AU=Af[AW-AR],Ab=Af[AW-AR+1],AT=Af[AW],AZ=Af[AW+1];if(Ad&&AU!=null&&AT==null){Y.lineTo(Ae.p2c(AV),Ac.p2c(AS));Y.fill();Ad=false;continue}if(AU==null||AT==null){continue}if(AU<=AT&&AU<Ae.min){if(AT<Ae.min){continue}Ab=(Ae.min-AU)/(AT-AU)*(AZ-Ab)+Ab;AU=Ae.min}else{if(AT<=AU&&AT<Ae.min){if(AU<Ae.min){continue}AZ=(Ae.min-AU)/(AT-AU)*(AZ-Ab)+Ab;AT=Ae.min}}if(AU>=AT&&AU>Ae.max){if(AT>Ae.max){continue}Ab=(Ae.max-AU)/(AT-AU)*(AZ-Ab)+Ab;AU=Ae.max}else{if(AT>=AU&&AT>Ae.max){if(AU>Ae.max){continue}AZ=(Ae.max-AU)/(AT-AU)*(AZ-Ab)+Ab;AT=Ae.max}}if(!Ad){Y.beginPath();Y.moveTo(Ae.p2c(AU),Ac.p2c(AS));Ad=true}if(Ab>=Ac.max&&AZ>=Ac.max){Y.lineTo(Ae.p2c(AU),Ac.p2c(Ac.max));Y.lineTo(Ae.p2c(AT),Ac.p2c(Ac.max));AV=AT;continue}else{if(Ab<=Ac.min&&AZ<=Ac.min){Y.lineTo(Ae.p2c(AU),Ac.p2c(Ac.min));Y.lineTo(Ae.p2c(AT),Ac.p2c(Ac.min));AV=AT;continue}}var Ag=AU,AY=AT;if(Ab<=AZ&&Ab<Ac.min&&AZ>=Ac.min){AU=(Ac.min-Ab)/(AZ-Ab)*(AT-AU)+AU;Ab=Ac.min}else{if(AZ<=Ab&&AZ<Ac.min&&Ab>=Ac.min){AT=(Ac.min-Ab)/(AZ-Ab)*(AT-AU)+AU;AZ=Ac.min}}if(Ab>=AZ&&Ab>Ac.max&&AZ<=Ac.max){AU=(Ac.max-Ab)/(AZ-Ab)*(AT-AU)+AU;Ab=Ac.max}else{if(AZ>=Ab&&AZ>Ac.max&&Ab<=Ac.max){AT=(Ac.max-Ab)/(AZ-Ab)*(AT-AU)+AU;AZ=Ac.max}}if(AU!=Ag){if(Ab<=Ac.min){Aa=Ac.min}else{Aa=Ac.max}Y.lineTo(Ae.p2c(Ag),Ac.p2c(Aa));Y.lineTo(Ae.p2c(AU),Ac.p2c(Aa))}Y.lineTo(Ae.p2c(AU),Ac.p2c(Ab));Y.lineTo(Ae.p2c(AT),Ac.p2c(AZ));if(AT!=AY){if(AZ<=Ac.min){Aa=Ac.min}else{Aa=Ac.max}Y.lineTo(Ae.p2c(AT),Ac.p2c(Aa));Y.lineTo(Ae.p2c(AY),Ac.p2c(Aa))}AV=Math.max(AT,AY)}if(Ad){Y.lineTo(Ae.p2c(AV),Ac.p2c(AS));Y.fill()}}Y.save();Y.translate(e.left,e.top);Y.lineJoin="round";var AP=AN.lines.lineWidth,AK=AN.shadowSize;if(AP>0&&AK>0){Y.lineWidth=AK;Y.strokeStyle="rgba(0,0,0,0.1)";var AQ=Math.PI/18;AM(AN.datapoints,Math.sin(AQ)*(AP/2+AK/2),Math.cos(AQ)*(AP/2+AK/2),AN.xaxis,AN.yaxis);Y.lineWidth=AK/2;AM(AN.datapoints,Math.sin(AQ)*(AP/2+AK/4),Math.cos(AQ)*(AP/2+AK/4),AN.xaxis,AN.yaxis)}Y.lineWidth=AP;Y.strokeStyle=AN.color;var AL=V(AN.lines,AN.color,0,t);if(AL){Y.fillStyle=AL;AO(AN.datapoints,AN.xaxis,AN.yaxis)}if(AP>0){AM(AN.datapoints,0,0,AN.xaxis,AN.yaxis)}Y.restore()}function o(AN){function AP(AU,AT,Ab,AR,AV,AZ,AY){var Aa=AU.points,AQ=AU.pointsize;for(var AS=0;AS<Aa.length;AS+=AQ){var AX=Aa[AS],AW=Aa[AS+1];if(AX==null||AX<AZ.min||AX>AZ.max||AW<AY.min||AW>AY.max){continue}Y.beginPath();Y.arc(AZ.p2c(AX),AY.p2c(AW)+AR,AT,0,AV,false);if(Ab){Y.fillStyle=Ab;Y.fill()}Y.stroke()}}Y.save();Y.translate(e.left,e.top);var AO=AN.lines.lineWidth,AL=AN.shadowSize,AK=AN.points.radius;if(AO>0&&AL>0){var AM=AL/2;Y.lineWidth=AM;Y.strokeStyle="rgba(0,0,0,0.1)";AP(AN.datapoints,AK,null,AM+AM/2,Math.PI,AN.xaxis,AN.yaxis);Y.strokeStyle="rgba(0,0,0,0.2)";AP(AN.datapoints,AK,null,AM/2,Math.PI,AN.xaxis,AN.yaxis)}Y.lineWidth=AO;Y.strokeStyle=AN.color;AP(AN.datapoints,AK,V(AN.points,AN.color),0,2*Math.PI,AN.xaxis,AN.yaxis);Y.restore()}function AB(AV,AU,Ad,AQ,AY,AN,AL,AT,AS,Ac,AZ){var AM,Ab,AR,AX,AO,AK,AW,AP,Aa;if(AZ){AP=AK=AW=true;AO=false;AM=Ad;Ab=AV;AX=AU+AQ;AR=AU+AY;if(Ab<AM){Aa=Ab;Ab=AM;AM=Aa;AO=true;AK=false}}else{AO=AK=AW=true;AP=false;AM=AV+AQ;Ab=AV+AY;AR=Ad;AX=AU;if(AX<AR){Aa=AX;AX=AR;AR=Aa;AP=true;AW=false}}if(Ab<AT.min||AM>AT.max||AX<AS.min||AR>AS.max){return}if(AM<AT.min){AM=AT.min;AO=false}if(Ab>AT.max){Ab=AT.max;AK=false}if(AR<AS.min){AR=AS.min;AP=false}if(AX>AS.max){AX=AS.max;AW=false}AM=AT.p2c(AM);AR=AS.p2c(AR);Ab=AT.p2c(Ab);AX=AS.p2c(AX);if(AL){Ac.beginPath();Ac.moveTo(AM,AR);Ac.lineTo(AM,AX);Ac.lineTo(Ab,AX);Ac.lineTo(Ab,AR);Ac.fillStyle=AL(AR,AX);Ac.fill()}if(AO||AK||AW||AP){Ac.beginPath();Ac.moveTo(AM,AR+AN);if(AO){Ac.lineTo(AM,AX+AN)}else{Ac.moveTo(AM,AX+AN)}if(AW){Ac.lineTo(Ab,AX+AN)}else{Ac.moveTo(Ab,AX+AN)}if(AK){Ac.lineTo(Ab,AR+AN)}else{Ac.moveTo(Ab,AR+AN)}if(AP){Ac.lineTo(AM,AR+AN)}else{Ac.moveTo(AM,AR+AN)}Ac.stroke()}}function n(AM){function AL(AS,AR,AU,AP,AT,AW,AV){var AX=AS.points,AO=AS.pointsize;for(var AQ=0;AQ<AX.length;AQ+=AO){if(AX[AQ]==null){continue}AB(AX[AQ],AX[AQ+1],AX[AQ+2],AR,AU,AP,AT,AW,AV,Y,AM.bars.horizontal)}}Y.save();Y.translate(e.left,e.top);Y.lineWidth=AM.bars.lineWidth;Y.strokeStyle=AM.color;var AK=AM.bars.align=="left"?0:-AM.bars.barWidth/2;var AN=AM.bars.fill?function(AO,AP){return V(AM.bars,AM.color,AO,AP)}:null;AL(AM.datapoints,AK,AK+AM.bars.barWidth,0,AN,AM.xaxis,AM.yaxis);Y.restore()}function V(AM,AK,AL,AO){var AN=AM.fill;if(!AN){return null}if(AM.fillColor){return R(AM.fillColor,AL,AO,AK)}var AP=C.color.parse(AK);AP.a=typeof AN=="number"?AN:0.4;AP.normalize();return AP.toString()}function AI(){l.find(".legend").remove();if(!g.legend.show){return}var AP=[],AN=false,AV=g.legend.labelFormatter,AU,AR;for(i=0;i<O.length;++i){AU=O[i];AR=AU.label;if(!AR){continue}if(i%g.legend.noColumns==0){if(AN){AP.push("</tr>")}AP.push("<tr>");AN=true}if(AV){AR=AV(AR,AU)}AP.push('<td class="legendColorBox"><div style="border:1px solid '+g.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+AU.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+AR+"</td>")}if(AN){AP.push("</tr>")}if(AP.length==0){return}var AT='<table style="font-size:smaller;color:'+g.grid.color+'">'+AP.join("")+"</table>";if(g.legend.container!=null){C(g.legend.container).html(AT)}else{var AQ="",AL=g.legend.position,AM=g.legend.margin;if(AM[0]==null){AM=[AM,AM]}if(AL.charAt(0)=="n"){AQ+="top:"+(AM[1]+e.top)+"px;"}else{if(AL.charAt(0)=="s"){AQ+="bottom:"+(AM[1]+e.bottom)+"px;"}}if(AL.charAt(1)=="e"){AQ+="right:"+(AM[0]+e.right)+"px;"}else{if(AL.charAt(1)=="w"){AQ+="left:"+(AM[0]+e.left)+"px;"}}var AS=C('<div class="legend">'+AT.replace('style="','style="position:absolute;'+AQ+";")+"</div>").appendTo(l);if(g.legend.backgroundOpacity!=0){var AO=g.legend.backgroundColor;if(AO==null){AO=g.grid.backgroundColor;if(AO&&typeof AO=="string"){AO=C.color.parse(AO)}else{AO=C.color.extract(AS,"background-color")}AO.a=1;AO=AO.toString()}var AK=AS.children();C('<div style="position:absolute;width:'+AK.width()+"px;height:"+AK.height()+"px;"+AQ+"background-color:"+AO+';"> </div>').prependTo(AS).css("opacity",g.legend.backgroundOpacity)}}}var w=[],J=null;function AF(AR,AP,AM){var AX=g.grid.mouseActiveRadius,Aj=AX*AX+1,Ah=null,Aa=false,Af,Ad;for(Af=0;Af<O.length;++Af){if(!AM(O[Af])){continue}var AY=O[Af],AQ=AY.xaxis,AO=AY.yaxis,Ae=AY.datapoints.points,Ac=AY.datapoints.pointsize,AZ=AQ.c2p(AR),AW=AO.c2p(AP),AL=AX/AQ.scale,AK=AX/AO.scale;if(AY.lines.show||AY.points.show){for(Ad=0;Ad<Ae.length;Ad+=Ac){var AT=Ae[Ad],AS=Ae[Ad+1];if(AT==null){continue}if(AT-AZ>AL||AT-AZ<-AL||AS-AW>AK||AS-AW<-AK){continue}var AV=Math.abs(AQ.p2c(AT)-AR),AU=Math.abs(AO.p2c(AS)-AP),Ab=AV*AV+AU*AU;if(Ab<=Aj){Aj=Ab;Ah=[Af,Ad/Ac]}}}if(AY.bars.show&&!Ah){var AN=AY.bars.align=="left"?0:-AY.bars.barWidth/2,Ag=AN+AY.bars.barWidth;for(Ad=0;Ad<Ae.length;Ad+=Ac){var AT=Ae[Ad],AS=Ae[Ad+1],Ai=Ae[Ad+2];if(AT==null){continue}if(O[Af].bars.horizontal?(AZ<=Math.max(Ai,AT)&&AZ>=Math.min(Ai,AT)&&AW>=AS+AN&&AW<=AS+Ag):(AZ>=AT+AN&&AZ<=AT+Ag&&AW>=Math.min(Ai,AS)&&AW<=Math.max(Ai,AS))){Ah=[Af,Ad/Ac]}}}}if(Ah){Af=Ah[0];Ad=Ah[1];Ac=O[Af].datapoints.pointsize;return{datapoint:O[Af].datapoints.points.slice(Ad*Ac,(Ad+1)*Ac),dataIndex:Ad,series:O[Af],seriesIndex:Af}}return null}function D(AK){if(g.grid.hoverable){H("plothover",AK,function(AL){return AL.hoverable!=false})}}function d(AK){H("plotclick",AK,function(AL){return AL.clickable!=false})}function H(AL,AK,AM){var AN=AD.offset(),AS={pageX:AK.pageX,pageY:AK.pageY},AQ=AK.pageX-AN.left-e.left,AO=AK.pageY-AN.top-e.top;if(s.xaxis.used){AS.x=s.xaxis.c2p(AQ)}if(s.yaxis.used){AS.y=s.yaxis.c2p(AO)}if(s.x2axis.used){AS.x2=s.x2axis.c2p(AQ)}if(s.y2axis.used){AS.y2=s.y2axis.c2p(AO)}var AT=AF(AQ,AO,AM);if(AT){AT.pageX=parseInt(AT.series.xaxis.p2c(AT.datapoint[0])+AN.left+e.left);AT.pageY=parseInt(AT.series.yaxis.p2c(AT.datapoint[1])+AN.top+e.top)}if(g.grid.autoHighlight){for(var AP=0;AP<w.length;++AP){var AR=w[AP];if(AR.auto==AL&&!(AT&&AR.series==AT.series&&AR.point==AT.datapoint)){x(AR.series,AR.point)}}if(AT){AE(AT.series,AT.datapoint,AL)}}l.trigger(AL,[AS,AT])}function q(){if(!J){J=setTimeout(v,30)}}function v(){J=null;AJ.save();AJ.clearRect(0,0,y,Q);AJ.translate(e.left,e.top);var AL,AK;for(AL=0;AL<w.length;++AL){AK=w[AL];if(AK.series.bars.show){z(AK.series,AK.point)}else{u(AK.series,AK.point)}}AJ.restore();Z(L.drawOverlay,[AJ])}function AE(AM,AK,AN){if(typeof AM=="number"){AM=O[AM]}if(typeof AK=="number"){AK=AM.data[AK]}var AL=j(AM,AK);if(AL==-1){w.push({series:AM,point:AK,auto:AN});q()}else{if(!AN){w[AL].auto=false}}}function x(AM,AK){if(AM==null&&AK==null){w=[];q()}if(typeof AM=="number"){AM=O[AM]}if(typeof AK=="number"){AK=AM.data[AK]}var AL=j(AM,AK);if(AL!=-1){w.splice(AL,1);q()}}function j(AM,AN){for(var AK=0;AK<w.length;++AK){var AL=w[AK];if(AL.series==AM&&AL.point[0]==AN[0]&&AL.point[1]==AN[1]){return AK}}return-1}function u(AN,AM){var AL=AM[0],AR=AM[1],AQ=AN.xaxis,AP=AN.yaxis;if(AL<AQ.min||AL>AQ.max||AR<AP.min||AR>AP.max){return}var AO=AN.points.radius+AN.points.lineWidth/2;AJ.lineWidth=AO;AJ.strokeStyle=C.color.parse(AN.color).scale("a",0.5).toString();var AK=1.5*AO;AJ.beginPath();AJ.arc(AQ.p2c(AL),AP.p2c(AR),AK,0,2*Math.PI,false);AJ.stroke()}function z(AN,AK){AJ.lineWidth=AN.bars.lineWidth;AJ.strokeStyle=C.color.parse(AN.color).scale("a",0.5).toString();var AM=C.color.parse(AN.color).scale("a",0.5).toString();var AL=AN.bars.align=="left"?0:-AN.bars.barWidth/2;AB(AK[0],AK[1],AK[2]||0,AL,AL+AN.bars.barWidth,0,function(){return AM},AN.xaxis,AN.yaxis,AJ,AN.bars.horizontal)}function R(AM,AL,AQ,AO){if(typeof AM=="string"){return AM}else{var AP=Y.createLinearGradient(0,AQ,0,AL);for(var AN=0,AK=AM.colors.length;AN<AK;++AN){var AR=AM.colors[AN];if(typeof AR!="string"){AR=C.color.parse(AO).scale("rgb",AR.brightness);AR.a*=AR.opacity;AR=AR.toString()}AP.addColorStop(AN/(AK-1),AR)}return AP}}}C.plot=function(G,E,D){var F=new B(C(G),E,D,C.plot.plugins);return F};C.plot.plugins=[];C.plot.formatDate=function(H,E,G){var L=function(N){N=""+N;return N.length==1?"0"+N:N};var D=[];var M=false;var K=H.getUTCHours();var I=K<12;if(G==null){G=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}if(E.search(/%p|%P/)!=-1){if(K>12){K=K-12}else{if(K==0){K=12}}}for(var F=0;F<E.length;++F){var J=E.charAt(F);if(M){switch(J){case"h":J=""+K;break;case"H":J=L(K);break;case"M":J=L(H.getUTCMinutes());break;case"S":J=L(H.getUTCSeconds());break;case"d":J=""+H.getUTCDate();break;case"m":J=""+(H.getUTCMonth()+1);break;case"y":J=""+H.getUTCFullYear();break;case"b":J=""+G[H.getUTCMonth()];break;case"p":J=(I)?("am"):("pm");break;case"P":J=(I)?("AM"):("PM");break}D.push(J);M=false}else{if(J=="%"){M=true}else{D.push(J)}}}return D.join("")};function A(E,D){return D*Math.floor(E/D)}})(jQuery);

(function($){var options={crosshair:{mode:null,color:"rgba(170, 0, 0, 0.80)",lineWidth:1}};function init(plot){var crosshair={x:-1,y:-1,locked:false};plot.setCrosshair=function setCrosshair(pos){if(!pos)
crosshair.x=-1;else{var axes=plot.getAxes();crosshair.x=Math.max(0,Math.min(pos.x!=null?axes.xaxis.p2c(pos.x):axes.x2axis.p2c(pos.x2),plot.width()));crosshair.y=Math.max(0,Math.min(pos.y!=null?axes.yaxis.p2c(pos.y):axes.y2axis.p2c(pos.y2),plot.height()));}
plot.triggerRedrawOverlay();};plot.clearCrosshair=plot.setCrosshair;plot.lockCrosshair=function lockCrosshair(pos){if(pos)
plot.setCrosshair(pos);crosshair.locked=true;}
plot.unlockCrosshair=function unlockCrosshair(){crosshair.locked=false;}
plot.hooks.bindEvents.push(function(plot,eventHolder){if(!plot.getOptions().crosshair.mode)
return;eventHolder.mouseout(function(){if(crosshair.x!=-1){crosshair.x=-1;plot.triggerRedrawOverlay();}});eventHolder.mousemove(function(e){if(plot.getSelection&&plot.getSelection()){crosshair.x=-1;return;}
if(crosshair.locked)
return;var offset=plot.offset();crosshair.x=Math.max(0,Math.min(e.pageX-offset.left,plot.width()));crosshair.y=Math.max(0,Math.min(e.pageY-offset.top,plot.height()));plot.triggerRedrawOverlay();});});plot.hooks.drawOverlay.push(function(plot,ctx){var c=plot.getOptions().crosshair;if(!c.mode)
return;var plotOffset=plot.getPlotOffset();ctx.save();ctx.translate(plotOffset.left,plotOffset.top);if(crosshair.x!=-1){ctx.strokeStyle=c.color;ctx.lineWidth=c.lineWidth;ctx.lineJoin="round";ctx.beginPath();if(c.mode.indexOf("x")!=-1){ctx.moveTo(crosshair.x,0);ctx.lineTo(crosshair.x,plot.height());}
if(c.mode.indexOf("y")!=-1){ctx.moveTo(0,crosshair.y);ctx.lineTo(plot.width(),crosshair.y);}
ctx.stroke();}
ctx.restore();});}
$.plot.plugins.push({init:init,options:options,name:'crosshair',version:'1.0'});})(jQuery);

(function(A){A.jScrollPane={active:[]};A.fn.jScrollPane=function(C){C=A.extend({},A.fn.jScrollPane.defaults,C);var B=function(){return false};return this.each(function(){var O=A(this);O.css("overflow","hidden");var X=this;if(A(this).parent().is(".jScrollPaneContainer")){var Ac=C.maintainPosition?O.position().top:0;var L=A(this).parent();var d=L.innerWidth();var Ad=L.outerHeight();var M=Ad;A(">.jScrollPaneTrack, >.jScrollArrowUp, >.jScrollArrowDown",L).remove();O.css({top:0})}else{var Ac=0;this.originalPadding=O.css("paddingTop")+" "+O.css("paddingRight")+" "+O.css("paddingBottom")+" "+O.css("paddingLeft");this.originalSidePaddingTotal=(parseInt(O.css("paddingLeft"))||0)+(parseInt(O.css("paddingRight"))||0);var d=O.innerWidth();var Ad=O.innerHeight();var M=Ad;O.wrap(A("<div></div>").attr({className:"jScrollPaneContainer"}).css({height:Ad+"px",width:d+"px"}));A(document).bind("emchange",function(Ae,Af,p){O.jScrollPane(C)})}if(C.reinitialiseOnImageLoad){var N=A.data(X,"jScrollPaneImagesToLoad")||A("img",O);var G=[];if(N.length){N.each(function(p,Ae){A(this).bind("load",function(){if(A.inArray(p,G)==-1){G.push(Ae);N=A.grep(N,function(Ag,Af){return Ag!=Ae});A.data(X,"jScrollPaneImagesToLoad",N);C.reinitialiseOnImageLoad=false;O.jScrollPane(C)}}).each(function(Af,Ag){if(this.complete||this.complete===undefined){this.src=this.src}})})}}var o=this.originalSidePaddingTotal;var l={height:"auto",width:d-C.scrollbarWidth-C.scrollbarMargin-o+"px"};if(C.scrollbarOnLeft){l.paddingLeft=C.scrollbarMargin+C.scrollbarWidth+"px"}else{l.paddingRight=C.scrollbarMargin+"px"}O.css(l);var m=O.outerHeight();var i=Ad/m;if(i<0.99){var H=O.parent();H.append(A("<div></div>").attr({className:"jScrollPaneTrack"}).css({width:C.scrollbarWidth+"px"}).append(A("<div></div>").attr({className:"jScrollPaneDrag"}).css({width:C.scrollbarWidth+"px"}).append(A("<div></div>").attr({className:"jScrollPaneDragTop"}).css({width:C.scrollbarWidth+"px"}),A("<div></div>").attr({className:"jScrollPaneDragBottom"}).css({width:C.scrollbarWidth+"px"}))));var z=A(">.jScrollPaneTrack",H);var P=A(">.jScrollPaneTrack .jScrollPaneDrag",H);if(C.showArrows){var g;var Ab;var S;var r;var j=function(){if(r>4||r%4==0){y(u+Ab*b)}r++};var K=function(p){A("html").unbind("mouseup",K);g.removeClass("jScrollActiveArrowButton");clearInterval(S)};var Z=function(){A("html").bind("mouseup",K);g.addClass("jScrollActiveArrowButton");r=0;j();S=setInterval(j,100)};H.append(A("<a></a>").attr({href:"javascript:;",className:"jScrollArrowUp"}).css({width:C.scrollbarWidth+"px"}).html("Scroll up").bind("mousedown",function(){g=A(this);Ab=-1;Z();this.blur();return false}).bind("click",B),A("<a></a>").attr({href:"javascript:;",className:"jScrollArrowDown"}).css({width:C.scrollbarWidth+"px"}).html("Scroll down").bind("mousedown",function(){g=A(this);Ab=1;Z();this.blur();return false}).bind("click",B));var Q=A(">.jScrollArrowUp",H);var J=A(">.jScrollArrowDown",H);if(C.arrowSize){M=Ad-C.arrowSize-C.arrowSize;z.css({height:M+"px",top:C.arrowSize+"px"})}else{var s=Q.height();C.arrowSize=s;M=Ad-s-J.height();z.css({height:M+"px",top:s+"px"})}}var w=A(this).css({position:"absolute",overflow:"visible"});var D;var Y;var b;var u=0;var V=i*Ad/2;var a=function(Ae,Ag){var Af=Ag=="X"?"Left":"Top";return Ae["page"+Ag]||(Ae["client"+Ag]+(document.documentElement["scroll"+Af]||document.body["scroll"+Af]))||0};var f=function(){return false};var v=function(){n();D=P.offset(false);D.top-=u;Y=M-P[0].offsetHeight;b=2*C.wheelSpeed*Y/m};var E=function(p){v();V=a(p,"Y")-u-D.top;A("html").bind("mouseup",T).bind("mousemove",h);if(A.browser.msie){A("html").bind("dragstart",f).bind("selectstart",f)}return false};var T=function(){A("html").unbind("mouseup",T).unbind("mousemove",h);V=i*Ad/2;if(A.browser.msie){A("html").unbind("dragstart",f).unbind("selectstart",f)}};var y=function(Ae){Ae=Ae<0?0:(Ae>Y?Y:Ae);u=Ae;P.css({top:Ae+"px"});var Af=Ae/Y;w.css({top:((Ad-m)*Af)+"px"});O.trigger("scroll");if(C.showArrows){Q[Ae==0?"addClass":"removeClass"]("disabled");J[Ae==Y?"addClass":"removeClass"]("disabled")}};var h=function(p){y(a(p,"Y")-D.top-V)};var q=Math.max(Math.min(i*(Ad-C.arrowSize*2),C.dragMaxHeight),C.dragMinHeight);P.css({height:q+"px"}).bind("mousedown",E);var k;var R;var I;var t=function(){if(R>8||R%4==0){y((u-((u-I)/2)))}R++};var Aa=function(){clearInterval(k);A("html").unbind("mouseup",Aa).unbind("mousemove",e)};var e=function(p){I=a(p,"Y")-D.top-V};var U=function(p){v();e(p);R=0;A("html").bind("mouseup",Aa).bind("mousemove",e);k=setInterval(t,100);t()};z.bind("mousedown",U);H.bind("mousewheel",function(Ae,Ag){v();n();var Af=u;y(u-Ag*b);var p=Af!=u;return!p});var F;var W;function c(){var p=(F-u)/C.animateStep;if(p>1||p<-1){y(u+p)}else{y(F);n()}}var n=function(){if(W){clearInterval(W);delete F}};var x=function(Af,p){if(typeof Af=="string"){$e=A(Af,O);if(!$e.length){return}Af=$e.offset().top-O.offset().top}H.scrollTop(0);n();var Ae=-Af/(Ad-m)*Y;if(p||!C.animateTo){y(Ae)}else{F=Ae;W=setInterval(c,C.animateInterval)}};O[0].scrollTo=x;O[0].scrollBy=function(Ae){var p=-parseInt(w.css("top"))||0;x(p+Ae)};v();x(-Ac,true);A("*",this).bind("focus",function(Ah){var Ag=A(this);var Aj=0;while(Ag[0]!=O[0]){Aj+=Ag.position().top;Ag=Ag.offsetParent()}var p=-parseInt(w.css("top"))||0;var Ai=p+Ad;var Af=Aj>p&&Aj<Ai;if(!Af){var Ae=Aj-C.scrollbarMargin;if(Aj>p){Ae+=A(this).height()+15+C.scrollbarMargin-Ad}x(Ae)}});if(location.hash){x(location.hash)}A(document).bind("click",function(Ae){$target=A(Ae.target);if($target.is("a")){var p=$target.attr("href");if(p.substr(0,1)=="#"){x(p)}}});A.jScrollPane.active.push(O[0])}else{O.css({height:Ad+"px",width:d-this.originalSidePaddingTotal+"px",padding:this.originalPadding});O.parent().unbind("mousewheel")}})};A.fn.jScrollPane.defaults={scrollbarWidth:10,scrollbarMargin:5,wheelSpeed:18,showArrows:false,arrowSize:0,animateTo:false,dragMinHeight:1,dragMaxHeight:99999,animateInterval:100,animateStep:3,maintainPosition:true,scrollbarOnLeft:false,reinitialiseOnImageLoad:false};A(window).bind("unload",function(){var C=A.jScrollPane.active;for(var B=0;B<C.length;B++){C[B].scrollTo=C[B].scrollBy=null}})})(jQuery);

Date.dayNames=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];Date.abbrDayNames=['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];Date.monthNames=['January','February','March','April','May','June','July','August','September','October','November','December'];Date.abbrMonthNames=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];Date.firstDayOfWeek=1;Date.format='dd/mm/yyyy';Date.fullYearStart='20';(function(){function add(name,method){if(!Date.prototype[name]){Date.prototype[name]=method;}};add("isLeapYear",function(){var y=this.getFullYear();return(y%4==0&&y%100!=0)||y%400==0;});add("isWeekend",function(){return this.getDay()==0||this.getDay()==6;});add("isWeekDay",function(){return!this.isWeekend();});add("getDaysInMonth",function(){return[31,(this.isLeapYear()?29:28),31,30,31,30,31,31,30,31,30,31][this.getMonth()];});add("getDayName",function(abbreviated){return abbreviated?Date.abbrDayNames[this.getDay()]:Date.dayNames[this.getDay()];});add("getMonthName",function(abbreviated){return abbreviated?Date.abbrMonthNames[this.getMonth()]:Date.monthNames[this.getMonth()];});add("getDayOfYear",function(){var tmpdtm=new Date("1/1/"+this.getFullYear());return Math.floor((this.getTime()-tmpdtm.getTime())/86400000);});add("getWeekOfYear",function(){return Math.ceil(this.getDayOfYear()/7);});add("setDayOfYear",function(day){this.setMonth(0);this.setDate(day);return this;});add("addYears",function(num){this.setFullYear(this.getFullYear()+num);return this;});add("addMonths",function(num){var tmpdtm=this.getDate();this.setMonth(this.getMonth()+num);if(tmpdtm>this.getDate())
this.addDays(-this.getDate());return this;});add("addDays",function(num){this.setTime(this.getTime()+(num*86400000));return this;});add("addHours",function(num){this.setHours(this.getHours()+num);return this;});add("addMinutes",function(num){this.setMinutes(this.getMinutes()+num);return this;});add("addSeconds",function(num){this.setSeconds(this.getSeconds()+num);return this;});add("zeroTime",function(){this.setMilliseconds(0);this.setSeconds(0);this.setMinutes(0);this.setHours(0);return this;});add("asString",function(format){var r=format||Date.format;return r.split('yyyy').join(this.getFullYear()).split('yy').join((this.getFullYear()+'').substring(2)).split('mmmm').join(this.getMonthName(false)).split('mmm').join(this.getMonthName(true)).split('mm').join(_zeroPad(this.getMonth()+1)).split('dd').join(_zeroPad(this.getDate()));});Date.fromString=function(s)
{var f=Date.format;var d=new Date('01/01/1977');var mLength=0;var iM=f.indexOf('mmmm');if(iM>-1){for(var i=0;i<Date.monthNames.length;i++){var mStr=s.substr(iM,Date.monthNames[i].length);if(Date.monthNames[i]==mStr){mLength=Date.monthNames[i].length-4;break;}}
d.setMonth(i);}else{iM=f.indexOf('mmm');if(iM>-1){var mStr=s.substr(iM,3);for(var i=0;i<Date.abbrMonthNames.length;i++){if(Date.abbrMonthNames[i]==mStr)break;}
d.setMonth(i);}else{d.setMonth(Number(s.substr(f.indexOf('mm'),2))-1);}}
var iY=f.indexOf('yyyy');if(iY>-1){if(iM<iY)
{iY+=mLength;}
d.setFullYear(Number(s.substr(iY,4)));}else{if(iM<iY)
{iY+=mLength;}
d.setFullYear(Number(Date.fullYearStart+s.substr(f.indexOf('yy'),2)));}
var iD=f.indexOf('dd');if(iM<iD)
{iD+=mLength;}
d.setDate(Number(s.substr(iD,2)));if(isNaN(d.getTime())){return false;}
return d;};var _zeroPad=function(num){var s='0'+num;return s.substring(s.length-2)};})();

(function($){$.fn.extend({renderCalendar:function(s)
{var dc=function(a)
{return document.createElement(a);};s=$.extend({},$.fn.datePicker.defaults,s);if(s.showHeader!=$.dpConst.SHOW_HEADER_NONE){var headRow=$(dc('tr'));for(var i=Date.firstDayOfWeek;i<Date.firstDayOfWeek+7;i++){var weekday=i%7;var day=Date.dayNames[weekday];headRow.append(jQuery(dc('th')).attr({'scope':'col','abbr':day,'title':day,'class':(weekday==0||weekday==6?'weekend':'weekday')}).html(s.showHeader==$.dpConst.SHOW_HEADER_SHORT?day.substr(0,1):day));}};var calendarTable=$(dc('table')).attr({'cellspacing':2,'className':'jCalendar'}).append((s.showHeader!=$.dpConst.SHOW_HEADER_NONE?$(dc('thead')).append(headRow):dc('thead')));var tbody=$(dc('tbody'));var today=(new Date()).zeroTime();var month=s.month==undefined?today.getMonth():s.month;var year=s.year||today.getFullYear();var currentDate=new Date(year,month,1);var firstDayOffset=Date.firstDayOfWeek-currentDate.getDay()+1;if(firstDayOffset>1)firstDayOffset-=7;var weeksToDraw=Math.ceil(((-1*firstDayOffset+1)+currentDate.getDaysInMonth())/7);currentDate.addDays(firstDayOffset-1);var doHover=function(firstDayInBounds)
{return function()
{if(s.hoverClass){var $this=$(this);if(!s.selectWeek){$this.addClass(s.hoverClass);}else if(firstDayInBounds&&!$this.is('.disabled')){$this.parent().addClass('activeWeekHover');}}}};var unHover=function()
{if(s.hoverClass){var $this=$(this);$this.removeClass(s.hoverClass);$this.parent().removeClass('activeWeekHover');}};var w=0;while(w++<weeksToDraw){var r=jQuery(dc('tr'));var firstDayInBounds=s.dpController?currentDate>s.dpController.startDate:false;for(var i=0;i<7;i++){var thisMonth=currentDate.getMonth()==month;var d=$(dc('td')).text(currentDate.getDate()+'').attr('className',(thisMonth?'current-month ':'other-month ')+
(currentDate.isWeekend()?'weekend ':'weekday ')+
(thisMonth&&currentDate.getTime()==today.getTime()?'today ':'')).data('datePickerDate',currentDate.asString()).hover(doHover(firstDayInBounds),unHover);r.append(d);if(s.renderCallback){s.renderCallback(d,currentDate,month,year);}
currentDate.addDays(1);}
tbody.append(r);}
calendarTable.append(tbody);return this.each(function()
{$(this).empty().append(calendarTable);});},datePicker:function(s)
{if(!$.event._dpCache)$.event._dpCache=[];s=$.extend({},$.fn.datePicker.defaults,s);return this.each(function()
{var $this=$(this);var alreadyExists=true;if(!this._dpId){this._dpId=$.event.guid++;$.event._dpCache[this._dpId]=new DatePicker(this);alreadyExists=false;}
if(s.inline){s.createButton=false;s.displayClose=false;s.closeOnSelect=false;$this.empty();}
var controller=$.event._dpCache[this._dpId];controller.init(s);if(!alreadyExists&&s.createButton){controller.button=$('<a href="#" class="dp-choose-date" title="'+$.dpText.TEXT_CHOOSE_DATE+'">'+$.dpText.TEXT_CHOOSE_DATE+'</a>').bind('click',function()
{$this.dpDisplay(this);this.blur();return false;});$this.after(controller.button);}
if(!alreadyExists&&$this.is(':text')){$this.bind('dateSelected',function(e,selectedDate,$td)
{this.value=selectedDate.asString();}).bind('change',function()
{if(this.value!=''){var d=Date.fromString(this.value);if(d){controller.setSelected(d,true,true);}}});if(s.clickInput){$this.bind('click',function()
{$this.dpDisplay();});}
var d=Date.fromString(this.value);if(this.value!=''&&d){controller.setSelected(d,true,true);}}
$this.addClass('dp-applied');})},dpSetDisabled:function(s)
{return _w.call(this,'setDisabled',s);},dpSetStartDate:function(d)
{return _w.call(this,'setStartDate',d);},dpSetEndDate:function(d)
{return _w.call(this,'setEndDate',d);},dpGetSelected:function()
{var c=_getController(this[0]);if(c){return c.getSelected();}
return null;},dpSetSelected:function(d,v,m)
{if(v==undefined)v=true;if(m==undefined)m=true;return _w.call(this,'setSelected',Date.fromString(d),v,m,true);},dpSetDisplayedMonth:function(m,y)
{return _w.call(this,'setDisplayedMonth',Number(m),Number(y),true);},dpDisplay:function(e)
{return _w.call(this,'display',e);},dpSetRenderCallback:function(a)
{return _w.call(this,'setRenderCallback',a);},dpSetPosition:function(v,h)
{return _w.call(this,'setPosition',v,h);},dpSetOffset:function(v,h)
{return _w.call(this,'setOffset',v,h);},dpClose:function()
{return _w.call(this,'_closeCalendar',false,this[0]);},_dpDestroy:function()
{}});var _w=function(f,a1,a2,a3,a4)
{return this.each(function()
{var c=_getController(this);if(c){c[f](a1,a2,a3,a4);}});};function DatePicker(ele)
{this.ele=ele;this.displayedMonth=null;this.displayedYear=null;this.startDate=null;this.endDate=null;this.showYearNavigation=null;this.closeOnSelect=null;this.displayClose=null;this.rememberViewedMonth=null;this.selectMultiple=null;this.numSelectable=null;this.numSelected=null;this.verticalPosition=null;this.horizontalPosition=null;this.verticalOffset=null;this.horizontalOffset=null;this.button=null;this.renderCallback=[];this.selectedDates={};this.inline=null;this.context='#dp-popup';this.settings={};};$.extend(DatePicker.prototype,{init:function(s)
{this.setStartDate(s.startDate);this.setEndDate(s.endDate);this.setDisplayedMonth(Number(s.month),Number(s.year));this.setRenderCallback(s.renderCallback);this.showYearNavigation=s.showYearNavigation;this.closeOnSelect=s.closeOnSelect;this.displayClose=s.displayClose;this.rememberViewedMonth=s.rememberViewedMonth;this.selectMultiple=s.selectMultiple;this.numSelectable=s.selectMultiple?s.numSelectable:1;this.numSelected=0;this.verticalPosition=s.verticalPosition;this.horizontalPosition=s.horizontalPosition;this.hoverClass=s.hoverClass;this.setOffset(s.verticalOffset,s.horizontalOffset);this.inline=s.inline;this.settings=s;if(this.inline){this.context=this.ele;this.display();}},setStartDate:function(d)
{if(d){this.startDate=Date.fromString(d);}
if(!this.startDate){this.startDate=(new Date()).zeroTime();}
this.setDisplayedMonth(this.displayedMonth,this.displayedYear);},setEndDate:function(d)
{if(d){this.endDate=Date.fromString(d);}
if(!this.endDate){this.endDate=(new Date('12/31/2999'));}
if(this.endDate.getTime()<this.startDate.getTime()){this.endDate=this.startDate;}
this.setDisplayedMonth(this.displayedMonth,this.displayedYear);},setPosition:function(v,h)
{this.verticalPosition=v;this.horizontalPosition=h;},setOffset:function(v,h)
{this.verticalOffset=parseInt(v)||0;this.horizontalOffset=parseInt(h)||0;},setDisabled:function(s)
{$e=$(this.ele);$e[s?'addClass':'removeClass']('dp-disabled');if(this.button){$but=$(this.button);$but[s?'addClass':'removeClass']('dp-disabled');$but.attr('title',s?'':$.dpText.TEXT_CHOOSE_DATE);}
if($e.is(':text')){$e.attr('disabled',s?'disabled':'');}},setDisplayedMonth:function(m,y,rerender)
{if(this.startDate==undefined||this.endDate==undefined){return;}
var s=new Date(this.startDate.getTime());s.setDate(1);var e=new Date(this.endDate.getTime());e.setDate(1);var t;if((!m&&!y)||(isNaN(m)&&isNaN(y))){t=new Date().zeroTime();t.setDate(1);}else if(isNaN(m)){t=new Date(y,this.displayedMonth,1);}else if(isNaN(y)){t=new Date(this.displayedYear,m,1);}else{t=new Date(y,m,1)}
if(t.getTime()<s.getTime()){t=s;}else if(t.getTime()>e.getTime()){t=e;}
var oldMonth=this.displayedMonth;var oldYear=this.displayedYear;this.displayedMonth=t.getMonth();this.displayedYear=t.getFullYear();if(rerender&&(this.displayedMonth!=oldMonth||this.displayedYear!=oldYear))
{this._rerenderCalendar();$(this.ele).trigger('dpMonthChanged',[this.displayedMonth,this.displayedYear]);}},setSelected:function(d,v,moveToMonth,dispatchEvents)
{var s=this.settings;if(s.selectWeek)
{d=d.addDays(-(d.getDay()-Date.firstDayOfWeek+7)%7);if(d<this.startDate)
{return;}}
if(v==this.isSelected(d))
{return;}
if(this.selectMultiple==false){this.selectedDates={};this.numSelected=0;$('td.selected',this.context).removeClass('selected').parent().removeClass('selectedWeek');}else if(v&&this.numSelected==this.numSelectable){return;}
if(moveToMonth&&(this.displayedMonth!=d.getMonth()||this.displayedYear!=d.getFullYear())){this.setDisplayedMonth(d.getMonth(),d.getFullYear(),true);}
this.selectedDates[d.toString()]=v;this.numSelected+=v?1:-1;var selectorString='td.'+(d.getMonth()==this.displayedMonth?'current-month':'other-month');var $td;$(selectorString,this.context).each(function()
{if($(this).data('datePickerDate')==d.asString()){$td=$(this);if(s.selectWeek)
{$td.parent()[v?'addClass':'removeClass']('selectedWeek');}
$td[v?'addClass':'removeClass']('selected');}});$('td',this.context).not('.selected')[this.selectMultiple&&this.numSelected==this.numSelectable?'addClass':'removeClass']('unselectable');if(dispatchEvents)
{var s=this.isSelected(d);$e=$(this.ele);var dClone=Date.fromString(d.asString());$e.trigger('dateSelected',[dClone,$td,s]);$e.trigger('change');}},isSelected:function(d)
{return this.selectedDates[d.toString()];},getSelected:function()
{var r=[];for(s in this.selectedDates){if(this.selectedDates[s]==true){r.push(Date.parse(s));}}
return r;},display:function(eleAlignTo)
{if($(this.ele).is('.dp-disabled'))return;eleAlignTo=eleAlignTo||this.ele;var c=this;var $ele=$(eleAlignTo);var eleOffset=$ele.offset();var $createIn;var attrs;var attrsCalendarHolder;var cssRules;if(c.inline){$createIn=$(this.ele);attrs={'id':'calendar-'+this.ele._dpId,'className':'dp-popup dp-popup-inline'};$('.dp-popup',$createIn).remove();cssRules={};}else{$createIn=$('body');attrs={'id':'dp-popup','className':'dp-popup'};cssRules={'top':eleOffset.top+c.verticalOffset,'left':eleOffset.left+c.horizontalOffset};var _checkMouse=function(e)
{var el=e.target;var cal=$('#dp-popup')[0];while(true){if(el==cal){return true;}else if(el==document){c._closeCalendar();return false;}else{el=$(el).parent()[0];}}};this._checkMouse=_checkMouse;c._closeCalendar(true);$(document).bind('keydown.datepicker',function(event)
{if(event.keyCode==27){c._closeCalendar();}});}
if(!c.rememberViewedMonth)
{var selectedDate=this.getSelected()[0];if(selectedDate){selectedDate=new Date(selectedDate);this.setDisplayedMonth(selectedDate.getMonth(),selectedDate.getFullYear(),false);}}
$createIn.append($('<div></div>').attr(attrs).css(cssRules).append($('<h2></h2>'),$('<div class="dp-nav-prev"></div>').append($('<a class="dp-nav-prev-year" href="#" title="'+$.dpText.TEXT_PREV_YEAR+'">&lt;&lt;</a>').bind('click',function()
{return c._displayNewMonth.call(c,this,0,-1);}),$('<a class="dp-nav-prev-month" href="#" title="'+$.dpText.TEXT_PREV_MONTH+'">&lt;</a>').bind('click',function()
{return c._displayNewMonth.call(c,this,-1,0);})),$('<div class="dp-nav-next"></div>').append($('<a class="dp-nav-next-year" href="#" title="'+$.dpText.TEXT_NEXT_YEAR+'">&gt;&gt;</a>').bind('click',function()
{return c._displayNewMonth.call(c,this,0,1);}),$('<a class="dp-nav-next-month" href="#" title="'+$.dpText.TEXT_NEXT_MONTH+'">&gt;</a>').bind('click',function()
{return c._displayNewMonth.call(c,this,1,0);})),$('<div></div>').attr('className','dp-calendar')).bgIframe());var $pop=this.inline?$('.dp-popup',this.context):$('#dp-popup');if(this.showYearNavigation==false){$('.dp-nav-prev-year, .dp-nav-next-year',c.context).css('display','none');}
if(this.displayClose){$pop.append($('<a href="#" id="dp-close">'+$.dpText.TEXT_CLOSE+'</a>').bind('click',function()
{c._closeCalendar();return false;}));}
c._renderCalendar();$(this.ele).trigger('dpDisplayed',$pop);if(!c.inline){if(this.verticalPosition==$.dpConst.POS_BOTTOM){$pop.css('top',eleOffset.top+$ele.height()-$pop.height()+c.verticalOffset);}
if(this.horizontalPosition==$.dpConst.POS_RIGHT){$pop.css('left',eleOffset.left+$ele.width()-$pop.width()+c.horizontalOffset);}
$(document).bind('mousedown.datepicker',this._checkMouse);}},setRenderCallback:function(a)
{if(a==null)return;if(a&&typeof(a)=='function'){a=[a];}
this.renderCallback=this.renderCallback.concat(a);},cellRender:function($td,thisDate,month,year){var c=this.dpController;var d=new Date(thisDate.getTime());$td.bind('click',function()
{var $this=$(this);if(!$this.is('.disabled')){c.setSelected(d,!$this.is('.selected')||!c.selectMultiple,false,true);if(c.closeOnSelect){c._closeCalendar();}
if(!$.browser.msie)
{$(c.ele).trigger('focus',[$.dpConst.DP_INTERNAL_FOCUS]);}}});if(c.isSelected(d)){$td.addClass('selected');if(c.settings.selectWeek)
{$td.parent().addClass('selectedWeek');}}else if(c.selectMultiple&&c.numSelected==c.numSelectable){$td.addClass('unselectable');}},_applyRenderCallbacks:function()
{var c=this;$('td',this.context).each(function()
{for(var i=0;i<c.renderCallback.length;i++){$td=$(this);c.renderCallback[i].apply(this,[$td,Date.fromString($td.data('datePickerDate')),c.displayedMonth,c.displayedYear]);}});return;},_displayNewMonth:function(ele,m,y)
{if(!$(ele).is('.disabled')){this.setDisplayedMonth(this.displayedMonth+m,this.displayedYear+y,true);}
ele.blur();return false;},_rerenderCalendar:function()
{this._clearCalendar();this._renderCalendar();},_renderCalendar:function()
{$('h2',this.context).html((new Date(this.displayedYear,this.displayedMonth,1)).asString($.dpText.HEADER_FORMAT));$('.dp-calendar',this.context).renderCalendar($.extend({},this.settings,{month:this.displayedMonth,year:this.displayedYear,renderCallback:this.cellRender,dpController:this,hoverClass:this.hoverClass}));if(this.displayedYear==this.startDate.getFullYear()&&this.displayedMonth==this.startDate.getMonth()){$('.dp-nav-prev-year',this.context).addClass('disabled');$('.dp-nav-prev-month',this.context).addClass('disabled');$('.dp-calendar td.other-month',this.context).each(function()
{var $this=$(this);if(Number($this.text())>20){$this.addClass('disabled');}});var d=this.startDate.getDate();$('.dp-calendar td.current-month',this.context).each(function()
{var $this=$(this);if(Number($this.text())<d){$this.addClass('disabled');}});}else{$('.dp-nav-prev-year',this.context).removeClass('disabled');$('.dp-nav-prev-month',this.context).removeClass('disabled');var d=this.startDate.getDate();if(d>20){var st=this.startDate.getTime();var sd=new Date(st);sd.addMonths(1);if(this.displayedYear==sd.getFullYear()&&this.displayedMonth==sd.getMonth()){$('.dp-calendar td.other-month',this.context).each(function()
{var $this=$(this);if(Date.fromString($this.data('datePickerDate')).getTime()<st){$this.addClass('disabled');}});}}}
if(this.displayedYear==this.endDate.getFullYear()&&this.displayedMonth==this.endDate.getMonth()){$('.dp-nav-next-year',this.context).addClass('disabled');$('.dp-nav-next-month',this.context).addClass('disabled');$('.dp-calendar td.other-month',this.context).each(function()
{var $this=$(this);if(Number($this.text())<14){$this.addClass('disabled');}});var d=this.endDate.getDate();$('.dp-calendar td.current-month',this.context).each(function()
{var $this=$(this);if(Number($this.text())>d){$this.addClass('disabled');}});}else{$('.dp-nav-next-year',this.context).removeClass('disabled');$('.dp-nav-next-month',this.context).removeClass('disabled');var d=this.endDate.getDate();if(d<13){var ed=new Date(this.endDate.getTime());ed.addMonths(-1);if(this.displayedYear==ed.getFullYear()&&this.displayedMonth==ed.getMonth()){$('.dp-calendar td.other-month',this.context).each(function()
{var $this=$(this);if(Number($this.text())>d){$this.addClass('disabled');}});}}}
this._applyRenderCallbacks();},_closeCalendar:function(programatic,ele)
{if(!ele||ele==this.ele)
{$(document).unbind('mousedown.datepicker');$(document).unbind('keydown.datepicker');this._clearCalendar();$('#dp-popup a').unbind();$('#dp-popup').empty().remove();if(!programatic){$(this.ele).trigger('dpClosed',[this.getSelected()]);}}},_clearCalendar:function()
{$('.dp-calendar td',this.context).unbind();$('.dp-calendar',this.context).empty();}});$.dpConst={SHOW_HEADER_NONE:0,SHOW_HEADER_SHORT:1,SHOW_HEADER_LONG:2,POS_TOP:0,POS_BOTTOM:1,POS_LEFT:0,POS_RIGHT:1,DP_INTERNAL_FOCUS:'dpInternalFocusTrigger'};$.dpText={TEXT_PREV_YEAR:'Previous year',TEXT_PREV_MONTH:'Previous month',TEXT_NEXT_YEAR:'Next year',TEXT_NEXT_MONTH:'Next month',TEXT_CLOSE:'Close',TEXT_CHOOSE_DATE:'Choose date',HEADER_FORMAT:'mmmm yyyy'};$.dpVersion='$Id: jquery.datePicker.js 52 2009-02-09 06:16:11Z kelvin.luck $';$.fn.datePicker.defaults={month:undefined,year:undefined,showHeader:$.dpConst.SHOW_HEADER_SHORT,startDate:undefined,endDate:undefined,inline:false,renderCallback:null,createButton:true,showYearNavigation:true,closeOnSelect:true,displayClose:false,selectMultiple:false,numSelectable:Number.MAX_VALUE,clickInput:false,rememberViewedMonth:true,selectWeek:false,verticalPosition:$.dpConst.POS_TOP,horizontalPosition:$.dpConst.POS_LEFT,verticalOffset:0,horizontalOffset:0,hoverClass:'dp-hover'};function _getController(ele)
{if(ele._dpId)return $.event._dpCache[ele._dpId];return false;};if($.fn.bgIframe==undefined){$.fn.bgIframe=function(){return this;};};$(window).bind('unload',function(){var els=$.event._dpCache||[];for(var i in els){$(els[i].ele)._dpDestroy();}});})(jQuery);

if(jQuery)(function(){jQuery.extend(jQuery.fn,{rightClick:function(handler){jQuery(this).each(function(){jQuery(this).mousedown(function(e){var evt=e;jQuery(this).mouseup(function(){jQuery(this).unbind('mouseup');if(evt.button==2){handler.call(jQuery(this),evt);return false;}else{return true;}});});jQuery(this)[0].oncontextmenu=function(){return false;}});return jQuery(this);},leftClick:function(handler){jQuery(this).each(function(){jQuery(this).mousedown(function(e){var evt=e;jQuery(this).mouseup(function(){jQuery(this).unbind('mouseup');if(evt.button==0){handler.call(jQuery(this),evt);return false;}else{return true;}});});});return jQuery(this);},rightMouseDown:function(handler){jQuery(this).each(function(){jQuery(this).mousedown(function(e){if(e.button==2){handler.call(jQuery(this),e);return false;}else{return true;}});jQuery(this)[0].oncontextmenu=function(){return false;}});return jQuery(this);},rightMouseUp:function(handler){jQuery(this).each(function(){jQuery(this).mouseup(function(e){if(e.button==2){handler.call(jQuery(this),e);return false;}else{return true;}});jQuery(this)[0].oncontextmenu=function(){return false;}});return jQuery(this);},noContext:function(){jQuery(this).each(function(){jQuery(this)[0].oncontextmenu=function(){return false;}});return jQuery(this);},altClick:function(handler){jQuery(this).each(function(){jQuery(this).mousedown(function(e){var evt=e;jQuery(this).mouseup(function(){if(evt.altKey){jQuery(this).unbind('mouseup');handler.call(jQuery(this),evt);return false;}else{return true;}});});});return jQuery(this);},shiftClick:function(handler){jQuery(this).each(function(){jQuery(this).mousedown(function(e){var evt=e;jQuery(this).mouseup(function(){if(evt.shiftKey){jQuery(this).unbind('mouseup');handler.call(jQuery(this),evt);return false;}else{return true;}});});});return jQuery(this);},ctrlClick:function(handler){jQuery(this).each(function(){jQuery(this).mousedown(function(e){var evt=e;jQuery(this).mouseup(function(){if(evt.ctrlKey){jQuery(this).unbind('mouseup');handler.call(jQuery(this),evt);return false;}else{return true;}});});});return jQuery(this);}});})(jQuery);

var swfobject=function(){var D="undefined",r="object",S="Shockwave Flash",W="ShockwaveFlash.ShockwaveFlash",q="application/x-shockwave-flash",R="SWFObjectExprInst",x="onreadystatechange",O=window,j=document,t=navigator,T=false,U=[h],o=[],N=[],I=[],l,Q,E,B,J=false,a=false,n,G,m=true,M=function(){var aa=typeof j.getElementById!=D&&typeof j.getElementsByTagName!=D&&typeof j.createElement!=D,ah=t.userAgent.toLowerCase(),Y=t.platform.toLowerCase(),ae=Y?/win/.test(Y):/win/.test(ah),ac=Y?/mac/.test(Y):/mac/.test(ah),af=/webkit/.test(ah)?parseFloat(ah.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,X=!+"\v1",ag=[0,0,0],ab=null;if(typeof t.plugins!=D&&typeof t.plugins[S]==r){ab=t.plugins[S].description;if(ab&&!(typeof t.mimeTypes!=D&&t.mimeTypes[q]&&!t.mimeTypes[q].enabledPlugin)){T=true;X=false;ab=ab.replace(/^.*\s+(\S+\s+\S+$)/,"$1");ag[0]=parseInt(ab.replace(/^(.*)\..*$/,"$1"),10);ag[1]=parseInt(ab.replace(/^.*\.(.*)\s.*$/,"$1"),10);ag[2]=/[a-zA-Z]/.test(ab)?parseInt(ab.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}}else{if(typeof O.ActiveXObject!=D){try{var ad=new ActiveXObject(W);if(ad){ab=ad.GetVariable("$version");if(ab){X=true;ab=ab.split(" ")[1].split(",");ag=[parseInt(ab[0],10),parseInt(ab[1],10),parseInt(ab[2],10)]}}}catch(Z){}}}return{w3:aa,pv:ag,wk:af,ie:X,win:ae,mac:ac}}(),k=function(){if(!M.w3){return}if((typeof j.readyState!=D&&j.readyState=="complete")||(typeof j.readyState==D&&(j.getElementsByTagName("body")[0]||j.body))){f()}if(!J){if(typeof j.addEventListener!=D){j.addEventListener("DOMContentLoaded",f,false)}if(M.ie&&M.win){j.attachEvent(x,function(){if(j.readyState=="complete"){j.detachEvent(x,arguments.callee);f()}});if(O==top){(function(){if(J){return}try{j.documentElement.doScroll("left")}catch(X){setTimeout(arguments.callee,0);return}f()})()}}if(M.wk){(function(){if(J){return}if(!/loaded|complete/.test(j.readyState)){setTimeout(arguments.callee,0);return}f()})()}s(f)}}();function f(){if(J){return}try{var Z=j.getElementsByTagName("body")[0].appendChild(C("span"));Z.parentNode.removeChild(Z)}catch(aa){return}J=true;var X=U.length;for(var Y=0;Y<X;Y++){U[Y]()}}function K(X){if(J){X()}else{U[U.length]=X}}function s(Y){if(typeof O.addEventListener!=D){O.addEventListener("load",Y,false)}else{if(typeof j.addEventListener!=D){j.addEventListener("load",Y,false)}else{if(typeof O.attachEvent!=D){i(O,"onload",Y)}else{if(typeof O.onload=="function"){var X=O.onload;O.onload=function(){X();Y()}}else{O.onload=Y}}}}}function h(){if(T){V()}else{H()}}function V(){var X=j.getElementsByTagName("body")[0];var aa=C(r);aa.setAttribute("type",q);var Z=X.appendChild(aa);if(Z){var Y=0;(function(){if(typeof Z.GetVariable!=D){var ab=Z.GetVariable("$version");if(ab){ab=ab.split(" ")[1].split(",");M.pv=[parseInt(ab[0],10),parseInt(ab[1],10),parseInt(ab[2],10)]}}else{if(Y<10){Y++;setTimeout(arguments.callee,10);return}}X.removeChild(aa);Z=null;H()})()}else{H()}}function H(){var ag=o.length;if(ag>0){for(var af=0;af<ag;af++){var Y=o[af].id;var ab=o[af].callbackFn;var aa={success:false,id:Y};if(M.pv[0]>0){var ae=c(Y);if(ae){if(F(o[af].swfVersion)&&!(M.wk&&M.wk<312)){w(Y,true);if(ab){aa.success=true;aa.ref=z(Y);ab(aa)}}else{if(o[af].expressInstall&&A()){var ai={};ai.data=o[af].expressInstall;ai.width=ae.getAttribute("width")||"0";ai.height=ae.getAttribute("height")||"0";if(ae.getAttribute("class")){ai.styleclass=ae.getAttribute("class")}if(ae.getAttribute("align")){ai.align=ae.getAttribute("align")}var ah={};var X=ae.getElementsByTagName("param");var ac=X.length;for(var ad=0;ad<ac;ad++){if(X[ad].getAttribute("name").toLowerCase()!="movie"){ah[X[ad].getAttribute("name")]=X[ad].getAttribute("value")}}P(ai,ah,Y,ab)}else{p(ae);if(ab){ab(aa)}}}}}else{w(Y,true);if(ab){var Z=z(Y);if(Z&&typeof Z.SetVariable!=D){aa.success=true;aa.ref=Z}ab(aa)}}}}}function z(aa){var X=null;var Y=c(aa);if(Y&&Y.nodeName=="OBJECT"){if(typeof Y.SetVariable!=D){X=Y}else{var Z=Y.getElementsByTagName(r)[0];if(Z){X=Z}}}return X}function A(){return!a&&F("6.0.65")&&(M.win||M.mac)&&!(M.wk&&M.wk<312)}function P(aa,ab,X,Z){a=true;E=Z||null;B={success:false,id:X};var ae=c(X);if(ae){if(ae.nodeName=="OBJECT"){l=g(ae);Q=null}else{l=ae;Q=X}aa.id=R;if(typeof aa.width==D||(!/%$/.test(aa.width)&&parseInt(aa.width,10)<310)){aa.width="310"}if(typeof aa.height==D||(!/%$/.test(aa.height)&&parseInt(aa.height,10)<137)){aa.height="137"}j.title=j.title.slice(0,47)+" - Flash Player Installation";var ad=M.ie&&M.win?"ActiveX":"PlugIn",ac="MMredirectURL="+O.location.toString().replace(/&/g,"%26")+"&MMplayerType="+ad+"&MMdoctitle="+j.title;if(typeof ab.flashvars!=D){ab.flashvars+="&"+ac}else{ab.flashvars=ac}if(M.ie&&M.win&&ae.readyState!=4){var Y=C("div");X+="SWFObjectNew";Y.setAttribute("id",X);ae.parentNode.insertBefore(Y,ae);ae.style.display="none";(function(){if(ae.readyState==4){ae.parentNode.removeChild(ae)}else{setTimeout(arguments.callee,10)}})()}u(aa,ab,X)}}function p(Y){if(M.ie&&M.win&&Y.readyState!=4){var X=C("div");Y.parentNode.insertBefore(X,Y);X.parentNode.replaceChild(g(Y),X);Y.style.display="none";(function(){if(Y.readyState==4){Y.parentNode.removeChild(Y)}else{setTimeout(arguments.callee,10)}})()}else{Y.parentNode.replaceChild(g(Y),Y)}}function g(ab){var aa=C("div");if(M.win&&M.ie){aa.innerHTML=ab.innerHTML}else{var Y=ab.getElementsByTagName(r)[0];if(Y){var ad=Y.childNodes;if(ad){var X=ad.length;for(var Z=0;Z<X;Z++){if(!(ad[Z].nodeType==1&&ad[Z].nodeName=="PARAM")&&!(ad[Z].nodeType==8)){aa.appendChild(ad[Z].cloneNode(true))}}}}}return aa}function u(ai,ag,Y){var X,aa=c(Y);if(M.wk&&M.wk<312){return X}if(aa){if(typeof ai.id==D){ai.id=Y}if(M.ie&&M.win){var ah="";for(var ae in ai){if(ai[ae]!=Object.prototype[ae]){if(ae.toLowerCase()=="data"){ag.movie=ai[ae]}else{if(ae.toLowerCase()=="styleclass"){ah+=' class="'+ai[ae]+'"'}else{if(ae.toLowerCase()!="classid"){ah+=" "+ae+'="'+ai[ae]+'"'}}}}}var af="";for(var ad in ag){if(ag[ad]!=Object.prototype[ad]){af+='<param name="'+ad+'" value="'+ag[ad]+'" />'}}aa.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+ah+">"+af+"</object>";N[N.length]=ai.id;X=c(ai.id)}else{var Z=C(r);Z.setAttribute("type",q);for(var ac in ai){if(ai[ac]!=Object.prototype[ac]){if(ac.toLowerCase()=="styleclass"){Z.setAttribute("class",ai[ac])}else{if(ac.toLowerCase()!="classid"){Z.setAttribute(ac,ai[ac])}}}}for(var ab in ag){if(ag[ab]!=Object.prototype[ab]&&ab.toLowerCase()!="movie"){e(Z,ab,ag[ab])}}aa.parentNode.replaceChild(Z,aa);X=Z}}return X}function e(Z,X,Y){var aa=C("param");aa.setAttribute("name",X);aa.setAttribute("value",Y);Z.appendChild(aa)}function y(Y){var X=c(Y);if(X&&X.nodeName=="OBJECT"){if(M.ie&&M.win){X.style.display="none";(function(){if(X.readyState==4){b(Y)}else{setTimeout(arguments.callee,10)}})()}else{X.parentNode.removeChild(X)}}}function b(Z){var Y=c(Z);if(Y){for(var X in Y){if(typeof Y[X]=="function"){Y[X]=null}}Y.parentNode.removeChild(Y)}}function c(Z){var X=null;try{X=j.getElementById(Z)}catch(Y){}return X}function C(X){return j.createElement(X)}function i(Z,X,Y){Z.attachEvent(X,Y);I[I.length]=[Z,X,Y]}function F(Z){var Y=M.pv,X=Z.split(".");X[0]=parseInt(X[0],10);X[1]=parseInt(X[1],10)||0;X[2]=parseInt(X[2],10)||0;return(Y[0]>X[0]||(Y[0]==X[0]&&Y[1]>X[1])||(Y[0]==X[0]&&Y[1]==X[1]&&Y[2]>=X[2]))?true:false}function v(ac,Y,ad,ab){if(M.ie&&M.mac){return}var aa=j.getElementsByTagName("head")[0];if(!aa){return}var X=(ad&&typeof ad=="string")?ad:"screen";if(ab){n=null;G=null}if(!n||G!=X){var Z=C("style");Z.setAttribute("type","text/css");Z.setAttribute("media",X);n=aa.appendChild(Z);if(M.ie&&M.win&&typeof j.styleSheets!=D&&j.styleSheets.length>0){n=j.styleSheets[j.styleSheets.length-1]}G=X}if(M.ie&&M.win){if(n&&typeof n.addRule==r){n.addRule(ac,Y)}}else{if(n&&typeof j.createTextNode!=D){n.appendChild(j.createTextNode(ac+" {"+Y+"}"))}}}function w(Z,X){if(!m){return}var Y=X?"visible":"hidden";if(J&&c(Z)){c(Z).style.visibility=Y}else{v("#"+Z,"visibility:"+Y)}}function L(Y){var Z=/[\\\"<>\.;]/;var X=Z.exec(Y)!=null;return X&&typeof encodeURIComponent!=D?encodeURIComponent(Y):Y}var d=function(){if(M.ie&&M.win){window.attachEvent("onunload",function(){var ac=I.length;for(var ab=0;ab<ac;ab++){I[ab][0].detachEvent(I[ab][1],I[ab][2])}var Z=N.length;for(var aa=0;aa<Z;aa++){y(N[aa])}for(var Y in M){M[Y]=null}M=null;for(var X in swfobject){swfobject[X]=null}swfobject=null})}}();return{registerObject:function(ab,X,aa,Z){if(M.w3&&ab&&X){var Y={};Y.id=ab;Y.swfVersion=X;Y.expressInstall=aa;Y.callbackFn=Z;o[o.length]=Y;w(ab,false)}else{if(Z){Z({success:false,id:ab})}}},getObjectById:function(X){if(M.w3){return z(X)}},embedSWF:function(ab,ah,ae,ag,Y,aa,Z,ad,af,ac){var X={success:false,id:ah};if(M.w3&&!(M.wk&&M.wk<312)&&ab&&ah&&ae&&ag&&Y){w(ah,false);K(function(){ae+="";ag+="";var aj={};if(af&&typeof af===r){for(var al in af){aj[al]=af[al]}}aj.data=ab;aj.width=ae;aj.height=ag;var am={};if(ad&&typeof ad===r){for(var ak in ad){am[ak]=ad[ak]}}if(Z&&typeof Z===r){for(var ai in Z){if(typeof am.flashvars!=D){am.flashvars+="&"+ai+"="+Z[ai]}else{am.flashvars=ai+"="+Z[ai]}}}if(F(Y)){var an=u(aj,am,ah);if(aj.id==ah){w(ah,true)}X.success=true;X.ref=an}else{if(aa&&A()){aj.data=aa;P(aj,am,ah,ac);return}else{w(ah,true)}}if(ac){ac(X)}})}else{if(ac){ac(X)}}},switchOffAutoHideShow:function(){m=false},ua:M,getFlashPlayerVersion:function(){return{major:M.pv[0],minor:M.pv[1],release:M.pv[2]}},hasFlashPlayerVersion:F,createSWF:function(Z,Y,X){if(M.w3){return u(Z,Y,X)}else{return undefined}},showExpressInstall:function(Z,aa,X,Y){if(M.w3&&A()){P(Z,aa,X,Y)}},removeSWF:function(X){if(M.w3){y(X)}},createCSS:function(aa,Z,Y,X){if(M.w3){v(aa,Z,Y,X)}},addDomLoadEvent:K,addLoadEvent:s,getQueryParamValue:function(aa){var Z=j.location.search||j.location.hash;if(Z){if(/\?/.test(Z)){Z=Z.split("?")[1]}if(aa==null){return L(Z)}var Y=Z.split("&");for(var X=0;X<Y.length;X++){if(Y[X].substring(0,Y[X].indexOf("="))==aa){return L(Y[X].substring((Y[X].indexOf("=")+1)))}}}return""},expressInstallCallback:function(){if(a){var X=c(R);if(X&&l){X.parentNode.replaceChild(l,X);if(Q){w(Q,true);if(M.ie&&M.win){l.style.display="block"}}if(E){E(B)}}a=false}}}}();

var SWFUpload;if(SWFUpload==undefined){SWFUpload=function(settings){this.initSWFUpload(settings);};}
SWFUpload.prototype.initSWFUpload=function(settings){try{this.customSettings={};this.settings=settings;this.eventQueue=[];this.movieName="SWFUpload_"+SWFUpload.movieCount++;this.movieElement=null;SWFUpload.instances[this.movieName]=this;this.initSettings();this.loadFlash();this.displayDebugInfo();}catch(ex){delete SWFUpload.instances[this.movieName];throw ex;}};SWFUpload.instances={};SWFUpload.movieCount=0;SWFUpload.version="2.2.0 2009-03-25";SWFUpload.QUEUE_ERROR={QUEUE_LIMIT_EXCEEDED:-100,FILE_EXCEEDS_SIZE_LIMIT:-110,ZERO_BYTE_FILE:-120,INVALID_FILETYPE:-130};SWFUpload.UPLOAD_ERROR={HTTP_ERROR:-200,MISSING_UPLOAD_URL:-210,IO_ERROR:-220,SECURITY_ERROR:-230,UPLOAD_LIMIT_EXCEEDED:-240,UPLOAD_FAILED:-250,SPECIFIED_FILE_ID_NOT_FOUND:-260,FILE_VALIDATION_FAILED:-270,FILE_CANCELLED:-280,UPLOAD_STOPPED:-290};SWFUpload.FILE_STATUS={QUEUED:-1,IN_PROGRESS:-2,ERROR:-3,COMPLETE:-4,CANCELLED:-5};SWFUpload.BUTTON_ACTION={SELECT_FILE:-100,SELECT_FILES:-110,START_UPLOAD:-120};SWFUpload.CURSOR={ARROW:-1,HAND:-2};SWFUpload.WINDOW_MODE={WINDOW:"window",TRANSPARENT:"transparent",OPAQUE:"opaque"};SWFUpload.completeURL=function(url){if(typeof(url)!=="string"||url.match(/^https?:\/\//i)||url.match(/^\//)){return url;}
var currentURL=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"");var indexSlash=window.location.pathname.lastIndexOf("/");if(indexSlash<=0){path="/";}else{path=window.location.pathname.substr(0,indexSlash)+"/";}
return path+url;};SWFUpload.prototype.initSettings=function(){this.ensureDefault=function(settingName,defaultValue){this.settings[settingName]=(this.settings[settingName]==undefined)?defaultValue:this.settings[settingName];};this.ensureDefault("upload_url","");this.ensureDefault("preserve_relative_urls",false);this.ensureDefault("file_post_name","Filedata");this.ensureDefault("post_params",{});this.ensureDefault("use_query_string",false);this.ensureDefault("requeue_on_error",false);this.ensureDefault("http_success",[]);this.ensureDefault("assume_success_timeout",0);this.ensureDefault("file_types","*.*");this.ensureDefault("file_types_description","All Files");this.ensureDefault("file_size_limit",0);this.ensureDefault("file_upload_limit",0);this.ensureDefault("file_queue_limit",0);this.ensureDefault("flash_url","swfupload.swf");this.ensureDefault("prevent_swf_caching",true);this.ensureDefault("button_image_url","");this.ensureDefault("button_width",1);this.ensureDefault("button_height",1);this.ensureDefault("button_text","");this.ensureDefault("button_text_style","color: #000000; font-size: 16pt;");this.ensureDefault("button_text_top_padding",0);this.ensureDefault("button_text_left_padding",0);this.ensureDefault("button_action",SWFUpload.BUTTON_ACTION.SELECT_FILES);this.ensureDefault("button_disabled",false);this.ensureDefault("button_placeholder_id","");this.ensureDefault("button_placeholder",null);this.ensureDefault("button_cursor",SWFUpload.CURSOR.ARROW);this.ensureDefault("button_window_mode",SWFUpload.WINDOW_MODE.WINDOW);this.ensureDefault("debug",false);this.settings.debug_enabled=this.settings.debug;this.settings.return_upload_start_handler=this.returnUploadStart;this.ensureDefault("swfupload_loaded_handler",null);this.ensureDefault("file_dialog_start_handler",null);this.ensureDefault("file_queued_handler",null);this.ensureDefault("file_queue_error_handler",null);this.ensureDefault("file_dialog_complete_handler",null);this.ensureDefault("upload_start_handler",null);this.ensureDefault("upload_progress_handler",null);this.ensureDefault("upload_error_handler",null);this.ensureDefault("upload_success_handler",null);this.ensureDefault("upload_complete_handler",null);this.ensureDefault("debug_handler",this.debugMessage);this.ensureDefault("custom_settings",{});this.customSettings=this.settings.custom_settings;if(!!this.settings.prevent_swf_caching){this.settings.flash_url=this.settings.flash_url+(this.settings.flash_url.indexOf("?")<0?"?":"&")+"preventswfcaching="+new Date().getTime();}
if(!this.settings.preserve_relative_urls){this.settings.upload_url=SWFUpload.completeURL(this.settings.upload_url);this.settings.button_image_url=SWFUpload.completeURL(this.settings.button_image_url);}
delete this.ensureDefault;};SWFUpload.prototype.loadFlash=function(){var targetElement,tempParent;if(document.getElementById(this.movieName)!==null){throw"ID "+this.movieName+" is already in use. The Flash Object could not be added";}
targetElement=document.getElementById(this.settings.button_placeholder_id)||this.settings.button_placeholder;if(targetElement==undefined){throw"Could not find the placeholder element: "+this.settings.button_placeholder_id;}
tempParent=document.createElement("div");tempParent.innerHTML=this.getFlashHTML();targetElement.parentNode.replaceChild(tempParent.firstChild,targetElement);if(window[this.movieName]==undefined){window[this.movieName]=this.getMovieElement();}};SWFUpload.prototype.getFlashHTML=function(){return['<object id="',this.movieName,'" type="application/x-shockwave-flash" data="',this.settings.flash_url,'" width="',this.settings.button_width,'" height="',this.settings.button_height,'" class="swfupload">','<param name="wmode" value="',this.settings.button_window_mode,'" />','<param name="movie" value="',this.settings.flash_url,'" />','<param name="quality" value="high" />','<param name="menu" value="false" />','<param name="allowScriptAccess" value="always" />','<param name="flashvars" value="'+this.getFlashVars()+'" />','</object>'].join("");};SWFUpload.prototype.getFlashVars=function(){var paramString=this.buildParamString();var httpSuccessString=this.settings.http_success.join(",");return["movieName=",encodeURIComponent(this.movieName),"&amp;uploadURL=",encodeURIComponent(this.settings.upload_url),"&amp;useQueryString=",encodeURIComponent(this.settings.use_query_string),"&amp;requeueOnError=",encodeURIComponent(this.settings.requeue_on_error),"&amp;httpSuccess=",encodeURIComponent(httpSuccessString),"&amp;assumeSuccessTimeout=",encodeURIComponent(this.settings.assume_success_timeout),"&amp;params=",encodeURIComponent(paramString),"&amp;filePostName=",encodeURIComponent(this.settings.file_post_name),"&amp;fileTypes=",encodeURIComponent(this.settings.file_types),"&amp;fileTypesDescription=",encodeURIComponent(this.settings.file_types_description),"&amp;fileSizeLimit=",encodeURIComponent(this.settings.file_size_limit),"&amp;fileUploadLimit=",encodeURIComponent(this.settings.file_upload_limit),"&amp;fileQueueLimit=",encodeURIComponent(this.settings.file_queue_limit),"&amp;debugEnabled=",encodeURIComponent(this.settings.debug_enabled),"&amp;buttonImageURL=",encodeURIComponent(this.settings.button_image_url),"&amp;buttonWidth=",encodeURIComponent(this.settings.button_width),"&amp;buttonHeight=",encodeURIComponent(this.settings.button_height),"&amp;buttonText=",encodeURIComponent(this.settings.button_text),"&amp;buttonTextTopPadding=",encodeURIComponent(this.settings.button_text_top_padding),"&amp;buttonTextLeftPadding=",encodeURIComponent(this.settings.button_text_left_padding),"&amp;buttonTextStyle=",encodeURIComponent(this.settings.button_text_style),"&amp;buttonAction=",encodeURIComponent(this.settings.button_action),"&amp;buttonDisabled=",encodeURIComponent(this.settings.button_disabled),"&amp;buttonCursor=",encodeURIComponent(this.settings.button_cursor)].join("");};SWFUpload.prototype.getMovieElement=function(){if(this.movieElement==undefined){this.movieElement=document.getElementById(this.movieName);}
if(this.movieElement===null){throw"Could not find Flash element";}
return this.movieElement;};SWFUpload.prototype.buildParamString=function(){var postParams=this.settings.post_params;var paramStringPairs=[];if(typeof(postParams)==="object"){for(var name in postParams){if(postParams.hasOwnProperty(name)){paramStringPairs.push(encodeURIComponent(name.toString())+"="+encodeURIComponent(postParams[name].toString()));}}}
return paramStringPairs.join("&amp;");};SWFUpload.prototype.destroy=function(){try{this.cancelUpload(null,false);var movieElement=null;movieElement=this.getMovieElement();if(movieElement&&typeof(movieElement.CallFunction)==="unknown"){for(var i in movieElement){try{if(typeof(movieElement[i])==="function"){movieElement[i]=null;}}catch(ex1){}}
try{movieElement.parentNode.removeChild(movieElement);}catch(ex){}}
window[this.movieName]=null;SWFUpload.instances[this.movieName]=null;delete SWFUpload.instances[this.movieName];this.movieElement=null;this.settings=null;this.customSettings=null;this.eventQueue=null;this.movieName=null;return true;}catch(ex2){return false;}};SWFUpload.prototype.displayDebugInfo=function(){this.debug(["---SWFUpload Instance Info---\n","Version: ",SWFUpload.version,"\n","Movie Name: ",this.movieName,"\n","Settings:\n","\t","upload_url:               ",this.settings.upload_url,"\n","\t","flash_url:                ",this.settings.flash_url,"\n","\t","use_query_string:         ",this.settings.use_query_string.toString(),"\n","\t","requeue_on_error:         ",this.settings.requeue_on_error.toString(),"\n","\t","http_success:             ",this.settings.http_success.join(", "),"\n","\t","assume_success_timeout:   ",this.settings.assume_success_timeout,"\n","\t","file_post_name:           ",this.settings.file_post_name,"\n","\t","post_params:              ",this.settings.post_params.toString(),"\n","\t","file_types:               ",this.settings.file_types,"\n","\t","file_types_description:   ",this.settings.file_types_description,"\n","\t","file_size_limit:          ",this.settings.file_size_limit,"\n","\t","file_upload_limit:        ",this.settings.file_upload_limit,"\n","\t","file_queue_limit:         ",this.settings.file_queue_limit,"\n","\t","debug:                    ",this.settings.debug.toString(),"\n","\t","prevent_swf_caching:      ",this.settings.prevent_swf_caching.toString(),"\n","\t","button_placeholder_id:    ",this.settings.button_placeholder_id.toString(),"\n","\t","button_placeholder:       ",(this.settings.button_placeholder?"Set":"Not Set"),"\n","\t","button_image_url:         ",this.settings.button_image_url.toString(),"\n","\t","button_width:             ",this.settings.button_width.toString(),"\n","\t","button_height:            ",this.settings.button_height.toString(),"\n","\t","button_text:              ",this.settings.button_text.toString(),"\n","\t","button_text_style:        ",this.settings.button_text_style.toString(),"\n","\t","button_text_top_padding:  ",this.settings.button_text_top_padding.toString(),"\n","\t","button_text_left_padding: ",this.settings.button_text_left_padding.toString(),"\n","\t","button_action:            ",this.settings.button_action.toString(),"\n","\t","button_disabled:          ",this.settings.button_disabled.toString(),"\n","\t","custom_settings:          ",this.settings.custom_settings.toString(),"\n","Event Handlers:\n","\t","swfupload_loaded_handler assigned:  ",(typeof this.settings.swfupload_loaded_handler==="function").toString(),"\n","\t","file_dialog_start_handler assigned: ",(typeof this.settings.file_dialog_start_handler==="function").toString(),"\n","\t","file_queued_handler assigned:       ",(typeof this.settings.file_queued_handler==="function").toString(),"\n","\t","file_queue_error_handler assigned:  ",(typeof this.settings.file_queue_error_handler==="function").toString(),"\n","\t","upload_start_handler assigned:      ",(typeof this.settings.upload_start_handler==="function").toString(),"\n","\t","upload_progress_handler assigned:   ",(typeof this.settings.upload_progress_handler==="function").toString(),"\n","\t","upload_error_handler assigned:      ",(typeof this.settings.upload_error_handler==="function").toString(),"\n","\t","upload_success_handler assigned:    ",(typeof this.settings.upload_success_handler==="function").toString(),"\n","\t","upload_complete_handler assigned:   ",(typeof this.settings.upload_complete_handler==="function").toString(),"\n","\t","debug_handler assigned:             ",(typeof this.settings.debug_handler==="function").toString(),"\n"].join(""));};SWFUpload.prototype.addSetting=function(name,value,default_value){if(value==undefined){return(this.settings[name]=default_value);}else{return(this.settings[name]=value);}};SWFUpload.prototype.getSetting=function(name){if(this.settings[name]!=undefined){return this.settings[name];}
return"";};SWFUpload.prototype.callFlash=function(functionName,argumentArray){argumentArray=argumentArray||[];var movieElement=this.getMovieElement();var returnValue,returnString;try{returnString=movieElement.CallFunction('<invoke name="'+functionName+'" returntype="javascript">'+__flash__argumentsToXML(argumentArray,0)+'</invoke>');returnValue=eval(returnString);}catch(ex){throw"Call to "+functionName+" failed";}
if(returnValue!=undefined&&typeof returnValue.post==="object"){returnValue=this.unescapeFilePostParams(returnValue);}
return returnValue;};SWFUpload.prototype.selectFile=function(){this.callFlash("SelectFile");};SWFUpload.prototype.selectFiles=function(){this.callFlash("SelectFiles");};SWFUpload.prototype.startUpload=function(fileID){this.callFlash("StartUpload",[fileID]);};SWFUpload.prototype.cancelUpload=function(fileID,triggerErrorEvent){if(triggerErrorEvent!==false){triggerErrorEvent=true;}
this.callFlash("CancelUpload",[fileID,triggerErrorEvent]);};SWFUpload.prototype.stopUpload=function(){this.callFlash("StopUpload");};SWFUpload.prototype.getStats=function(){return this.callFlash("GetStats");};SWFUpload.prototype.setStats=function(statsObject){this.callFlash("SetStats",[statsObject]);};SWFUpload.prototype.getFile=function(fileID){if(typeof(fileID)==="number"){return this.callFlash("GetFileByIndex",[fileID]);}else{return this.callFlash("GetFile",[fileID]);}};SWFUpload.prototype.addFileParam=function(fileID,name,value){return this.callFlash("AddFileParam",[fileID,name,value]);};SWFUpload.prototype.removeFileParam=function(fileID,name){this.callFlash("RemoveFileParam",[fileID,name]);};SWFUpload.prototype.setUploadURL=function(url){this.settings.upload_url=url.toString();this.callFlash("SetUploadURL",[url]);};SWFUpload.prototype.setPostParams=function(paramsObject){this.settings.post_params=paramsObject;this.callFlash("SetPostParams",[paramsObject]);};SWFUpload.prototype.addPostParam=function(name,value){this.settings.post_params[name]=value;this.callFlash("SetPostParams",[this.settings.post_params]);};SWFUpload.prototype.removePostParam=function(name){delete this.settings.post_params[name];this.callFlash("SetPostParams",[this.settings.post_params]);};SWFUpload.prototype.setFileTypes=function(types,description){this.settings.file_types=types;this.settings.file_types_description=description;this.callFlash("SetFileTypes",[types,description]);};SWFUpload.prototype.setFileSizeLimit=function(fileSizeLimit){this.settings.file_size_limit=fileSizeLimit;this.callFlash("SetFileSizeLimit",[fileSizeLimit]);};SWFUpload.prototype.setFileUploadLimit=function(fileUploadLimit){this.settings.file_upload_limit=fileUploadLimit;this.callFlash("SetFileUploadLimit",[fileUploadLimit]);};SWFUpload.prototype.setFileQueueLimit=function(fileQueueLimit){this.settings.file_queue_limit=fileQueueLimit;this.callFlash("SetFileQueueLimit",[fileQueueLimit]);};SWFUpload.prototype.setFilePostName=function(filePostName){this.settings.file_post_name=filePostName;this.callFlash("SetFilePostName",[filePostName]);};SWFUpload.prototype.setUseQueryString=function(useQueryString){this.settings.use_query_string=useQueryString;this.callFlash("SetUseQueryString",[useQueryString]);};SWFUpload.prototype.setRequeueOnError=function(requeueOnError){this.settings.requeue_on_error=requeueOnError;this.callFlash("SetRequeueOnError",[requeueOnError]);};SWFUpload.prototype.setHTTPSuccess=function(http_status_codes){if(typeof http_status_codes==="string"){http_status_codes=http_status_codes.replace(" ","").split(",");}
this.settings.http_success=http_status_codes;this.callFlash("SetHTTPSuccess",[http_status_codes]);};SWFUpload.prototype.setAssumeSuccessTimeout=function(timeout_seconds){this.settings.assume_success_timeout=timeout_seconds;this.callFlash("SetAssumeSuccessTimeout",[timeout_seconds]);};SWFUpload.prototype.setDebugEnabled=function(debugEnabled){this.settings.debug_enabled=debugEnabled;this.callFlash("SetDebugEnabled",[debugEnabled]);};SWFUpload.prototype.setButtonImageURL=function(buttonImageURL){if(buttonImageURL==undefined){buttonImageURL="";}
this.settings.button_image_url=buttonImageURL;this.callFlash("SetButtonImageURL",[buttonImageURL]);};SWFUpload.prototype.setButtonDimensions=function(width,height){this.settings.button_width=width;this.settings.button_height=height;var movie=this.getMovieElement();if(movie!=undefined){movie.style.width=width+"px";movie.style.height=height+"px";}
this.callFlash("SetButtonDimensions",[width,height]);};SWFUpload.prototype.setButtonText=function(html){this.settings.button_text=html;this.callFlash("SetButtonText",[html]);};SWFUpload.prototype.setButtonTextPadding=function(left,top){this.settings.button_text_top_padding=top;this.settings.button_text_left_padding=left;this.callFlash("SetButtonTextPadding",[left,top]);};SWFUpload.prototype.setButtonTextStyle=function(css){this.settings.button_text_style=css;this.callFlash("SetButtonTextStyle",[css]);};SWFUpload.prototype.setButtonDisabled=function(isDisabled){this.settings.button_disabled=isDisabled;this.callFlash("SetButtonDisabled",[isDisabled]);};SWFUpload.prototype.setButtonAction=function(buttonAction){this.settings.button_action=buttonAction;this.callFlash("SetButtonAction",[buttonAction]);};SWFUpload.prototype.setButtonCursor=function(cursor){this.settings.button_cursor=cursor;this.callFlash("SetButtonCursor",[cursor]);};SWFUpload.prototype.queueEvent=function(handlerName,argumentArray){if(argumentArray==undefined){argumentArray=[];}else if(!(argumentArray instanceof Array)){argumentArray=[argumentArray];}
var self=this;if(typeof this.settings[handlerName]==="function"){this.eventQueue.push(function(){this.settings[handlerName].apply(this,argumentArray);});setTimeout(function(){self.executeNextEvent();},0);}else if(this.settings[handlerName]!==null){throw"Event handler "+handlerName+" is unknown or is not a function";}};SWFUpload.prototype.executeNextEvent=function(){var f=this.eventQueue?this.eventQueue.shift():null;if(typeof(f)==="function"){f.apply(this);}};SWFUpload.prototype.unescapeFilePostParams=function(file){var reg=/[$]([0-9a-f]{4})/i;var unescapedPost={};var uk;if(file!=undefined){for(var k in file.post){if(file.post.hasOwnProperty(k)){uk=k;var match;while((match=reg.exec(uk))!==null){uk=uk.replace(match[0],String.fromCharCode(parseInt("0x"+match[1],16)));}
unescapedPost[uk]=file.post[k];}}
file.post=unescapedPost;}
return file;};SWFUpload.prototype.testExternalInterface=function(){try{return this.callFlash("TestExternalInterface");}catch(ex){return false;}};SWFUpload.prototype.flashReady=function(){var movieElement=this.getMovieElement();if(!movieElement){this.debug("Flash called back ready but the flash movie can't be found.");return;}
this.cleanUp(movieElement);this.queueEvent("swfupload_loaded_handler");};SWFUpload.prototype.cleanUp=function(movieElement){try{if(this.movieElement&&typeof(movieElement.CallFunction)==="unknown"){this.debug("Removing Flash functions hooks (this should only run in IE and should prevent memory leaks)");for(var key in movieElement){try{if(typeof(movieElement[key])==="function"){movieElement[key]=null;}}catch(ex){}}}}catch(ex1){}
window["__flash__removeCallback"]=function(instance,name){try{if(instance){instance[name]=null;}}catch(flashEx){}};};SWFUpload.prototype.fileDialogStart=function(){this.queueEvent("file_dialog_start_handler");};SWFUpload.prototype.fileQueued=function(file){file=this.unescapeFilePostParams(file);this.queueEvent("file_queued_handler",file);};SWFUpload.prototype.fileQueueError=function(file,errorCode,message){file=this.unescapeFilePostParams(file);this.queueEvent("file_queue_error_handler",[file,errorCode,message]);};SWFUpload.prototype.fileDialogComplete=function(numFilesSelected,numFilesQueued,numFilesInQueue){this.queueEvent("file_dialog_complete_handler",[numFilesSelected,numFilesQueued,numFilesInQueue]);};SWFUpload.prototype.uploadStart=function(file){file=this.unescapeFilePostParams(file);this.queueEvent("return_upload_start_handler",file);};SWFUpload.prototype.returnUploadStart=function(file){var returnValue;if(typeof this.settings.upload_start_handler==="function"){file=this.unescapeFilePostParams(file);returnValue=this.settings.upload_start_handler.call(this,file);}else if(this.settings.upload_start_handler!=undefined){throw"upload_start_handler must be a function";}
if(returnValue===undefined){returnValue=true;}
returnValue=!!returnValue;this.callFlash("ReturnUploadStart",[returnValue]);};SWFUpload.prototype.uploadProgress=function(file,bytesComplete,bytesTotal){file=this.unescapeFilePostParams(file);this.queueEvent("upload_progress_handler",[file,bytesComplete,bytesTotal]);};SWFUpload.prototype.uploadError=function(file,errorCode,message){file=this.unescapeFilePostParams(file);this.queueEvent("upload_error_handler",[file,errorCode,message]);};SWFUpload.prototype.uploadSuccess=function(file,serverData,responseReceived){file=this.unescapeFilePostParams(file);this.queueEvent("upload_success_handler",[file,serverData,responseReceived]);};SWFUpload.prototype.uploadComplete=function(file){file=this.unescapeFilePostParams(file);this.queueEvent("upload_complete_handler",file);};SWFUpload.prototype.debug=function(message){this.queueEvent("debug_handler",message);};SWFUpload.prototype.debugMessage=function(message){if(this.settings.debug){var exceptionMessage,exceptionValues=[];if(typeof message==="object"&&typeof message.name==="string"&&typeof message.message==="string"){for(var key in message){if(message.hasOwnProperty(key)){exceptionValues.push(key+": "+message[key]);}}
exceptionMessage=exceptionValues.join("\n")||"";exceptionValues=exceptionMessage.split("\n");exceptionMessage="EXCEPTION: "+exceptionValues.join("\nEXCEPTION: ");SWFUpload.Console.writeLine(exceptionMessage);}else{SWFUpload.Console.writeLine(message);}}};SWFUpload.Console={};SWFUpload.Console.writeLine=function(message){var console,documentForm;try{console=document.getElementById("SWFUpload_Console");if(!console){documentForm=document.createElement("form");document.getElementsByTagName("body")[0].appendChild(documentForm);console=document.createElement("textarea");console.id="SWFUpload_Console";console.style.fontFamily="monospace";console.setAttribute("wrap","off");console.wrap="off";console.style.overflow="auto";console.style.width="700px";console.style.height="350px";console.style.margin="5px";documentForm.appendChild(console);}
console.value+=message+"\n";console.scrollTop=console.scrollHeight-console.clientHeight;}catch(ex){alert("Exception: "+ex.name+" Message: "+ex.message);}};

var SWFUpload;if(typeof(SWFUpload)==="function"){SWFUpload.queue={};SWFUpload.prototype.initSettings=(function(oldInitSettings){return function(){if(typeof(oldInitSettings)==="function"){oldInitSettings.call(this);}
this.queueSettings={};this.queueSettings.queue_cancelled_flag=false;this.queueSettings.queue_upload_count=0;this.queueSettings.user_upload_complete_handler=this.settings.upload_complete_handler;this.queueSettings.user_upload_start_handler=this.settings.upload_start_handler;this.settings.upload_complete_handler=SWFUpload.queue.uploadCompleteHandler;this.settings.upload_start_handler=SWFUpload.queue.uploadStartHandler;this.settings.queue_complete_handler=this.settings.queue_complete_handler||null;};})(SWFUpload.prototype.initSettings);SWFUpload.prototype.startUpload=function(fileID){this.queueSettings.queue_cancelled_flag=false;this.callFlash("StartUpload",[fileID]);};SWFUpload.prototype.cancelQueue=function(){this.queueSettings.queue_cancelled_flag=true;this.stopUpload();var stats=this.getStats();while(stats.files_queued>0){this.cancelUpload();stats=this.getStats();}};SWFUpload.queue.uploadStartHandler=function(file){var returnValue;if(typeof(this.queueSettings.user_upload_start_handler)==="function"){returnValue=this.queueSettings.user_upload_start_handler.call(this,file);}
returnValue=(returnValue===false)?false:true;this.queueSettings.queue_cancelled_flag=!returnValue;return returnValue;};SWFUpload.queue.uploadCompleteHandler=function(file){var user_upload_complete_handler=this.queueSettings.user_upload_complete_handler;var continueUpload;if(file.filestatus===SWFUpload.FILE_STATUS.COMPLETE){this.queueSettings.queue_upload_count++;}
if(typeof(user_upload_complete_handler)==="function"){continueUpload=(user_upload_complete_handler.call(this,file)===false)?false:true;}else if(file.filestatus===SWFUpload.FILE_STATUS.QUEUED){continueUpload=false;}else{continueUpload=true;}
if(continueUpload){var stats=this.getStats();if(stats.files_queued>0&&this.queueSettings.queue_cancelled_flag===false){this.startUpload();}else if(this.queueSettings.queue_cancelled_flag===false){this.queueEvent("queue_complete_handler",[this.queueSettings.queue_upload_count]);this.queueSettings.queue_upload_count=0;}else{this.queueSettings.queue_cancelled_flag=false;this.queueSettings.queue_upload_count=0;}}};}

var dateFormat=function(){var token=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,timezone=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,timezoneClip=/[^-+\dA-Z]/g,pad=function(val,len){val=String(val);len=len||2;while(val.length<len)val="0"+val;return val;};return function(date,mask,utc){var dF=dateFormat;if(arguments.length==1&&Object.prototype.toString.call(date)=="[object String]"&&!/\d/.test(date)){mask=date;date=undefined;}
date=date?new Date(date):new Date;if(isNaN(date))throw SyntaxError("invalid date");mask=String(dF.masks[mask]||mask||dF.masks["default"]);if(mask.slice(0,4)=="UTC:"){mask=mask.slice(4);utc=true;}
var _=utc?"getUTC":"get",d=date[_+"Date"](),D=date[_+"Day"](),m=date[_+"Month"](),y=date[_+"FullYear"](),H=date[_+"Hours"](),M=date[_+"Minutes"](),s=date[_+"Seconds"](),L=date[_+"Milliseconds"](),o=utc?0:date.getTimezoneOffset(),flags={d:d,dd:pad(d),ddd:dF.i18n.dayNames[D],dddd:dF.i18n.dayNames[D+7],m:m+1,mm:pad(m+1),mmm:dF.i18n.monthNames[m],mmmm:dF.i18n.monthNames[m+12],yy:String(y).slice(2),yyyy:y,h:H%12||12,hh:pad(H%12||12),H:H,HH:pad(H),M:M,MM:pad(M),s:s,ss:pad(s),l:pad(L,3),L:pad(L>99?Math.round(L/10):L),t:H<12?"a":"p",tt:H<12?"am":"pm",T:H<12?"A":"P",TT:H<12?"AM":"PM",Z:utc?"UTC":(String(date).match(timezone)||[""]).pop().replace(timezoneClip,""),o:(o>0?"-":"+")+pad(Math.floor(Math.abs(o)/60)*100+Math.abs(o)%60,4),S:["th","st","nd","rd"][d%10>3?0:(d%100-d%10!=10)*d%10]};return mask.replace(token,function($0){return $0 in flags?flags[$0]:$0.slice(1,$0.length-1);});};}();dateFormat.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"};dateFormat.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]};Date.prototype.format=function(mask,utc){return dateFormat(this,mask,utc);};

var base_url=location.protocol+'//'+location.host+"/";var admin_base_url=location.protocol+'//'+location.host+'/admin/';var code_url=admin_base_url+'code/';var defines={flash_upload_processor:code_url+"php/FlashProcessUpload.php",upload_processor:code_url+"php/ProcessUpload.php",root_url:admin_base_url,code_url:code_url,user_files_root_url:"http://files.apollosites.com/",domain:"athenasites.com",max_hdd:500};

var Logger={m_div:'',m_width:500,m_height:500,m_showDebug:false,init:function(div){Logger.m_div=div;$(Logger.m_div).draggable();Logger.clear();Logger.m_width=$(Logger.m_div).width();Logger.m_height=$(Logger.m_div).height();$(Logger.m_div).css('left','10%');},clear:function(){var txt="<div id='Logger_headerBar' style='background-color: grey; height:22px; width:100%;'>";txt+="<button onclick='Logger.clear()' style='float:left; margin-right:5px'>Clear</button>";txt+="<button id='Logger_shrinkButton' onclick='Logger.onToggleShrink()' style='float:left; margin-right:5px'>Shrink</button>";txt+="<button onclick='Logger.hide()' style='float:right;'>Exit</button>";txt+="</div>";txt+="<div id='Logger_content' style='width:100%; clear: both'></div>";$(Logger.m_div).html(txt);},onToggleShrink:function(){var ht=$(Logger.m_div).height();if(ht<Logger.m_height){$(Logger.m_div).height(Logger.m_height);$(Logger.m_div).width(Logger.m_width);$('#Logger_shrinkButton').html('Shrink');$(Logger.m_div).css('overflow','auto');}
else{$(Logger.m_div).height(30);$(Logger.m_div).width(200);$('#Logger_shrinkButton').html('Grow');$(Logger.m_div).css('overflow','hidden');}},toggleShow:function(){if(Logger.m_showDebug){Logger.hide();}
else{Logger.show();}},m_showOnError:false,showOnError:function(){Logger.m_showOnError=true;},show:function(){Logger.m_showDebug=true;$(Logger.m_div).show();},hide:function(){Logger.m_showDebug=false;$(Logger.m_div).hide();},trace:function(msg,type){var col='black';if(type){if(type=='error')col='red';if(type=='warn')col='orange';if(type=='info')col='white';if(type=='debug')col='green';}
if(Logger.m_showOnError&&!Logger.m_showDebug&&type=='error'){Logger.show();}
$('#Logger_content').prepend("<b style='color: "+col+"'>"+msg+"</b><br/>");},debug:function(msg){Logger.trace(msg,'debug');},info:function(msg){Logger.trace(msg,'info');},warn:function(msg){Logger.trace(msg,'warn');},warning:function(msg){Logger.trace(msg,'warn');},error:function(msg){Logger.trace(msg,'error');}}

var AthenaDialog={lockBackground:function(){},unlockBackground:function(){},showLoading:function(msg,isModal){if(isModal==undefined){isModal=true;}
if(isModal){AthenaDialog.lockBackground();}
$('#apollo_loading_dialog').dialog("destroy");$('#apollo_loading_dialog').html("<div align='center'><img src='"+defines.root_url+"images/spinner.gif'/></div>");$('#apollo_loading_dialog').dialog({resizable:true,height:70,width:250,closeOnEscape:false,modal:false,title:msg})},clearLoading:function(){$('#apollo_loading_dialog').dialog("destroy");AthenaDialog.unlockBackground();},error:function(msg){},backgroundMessage:function(msg){$('.user_message').stop();var startCol='#032f5d';var midCol='#cc2222';var endCol=startCol;$('.user_message').html(msg);$('.user_message').show();$('.user_message').css('color',startCol);$('.user_message').animate({color:midCol},3000,function(){$('.user_message').animate({color:endCol},3000,function(){$('.user_message').fadeOut('slow')})});},clearBackgroundMessage:function(msg){$('.user_message').fadeOut('slow');},message:function(msg,msgTitle){if(msgTitle==undefined){msgTitle="Message";}
$('#apollo_dialog').dialog("destroy");$('#apollo_dialog').html(msg);$('#apollo_dialog').dialog({resizable:false,modal:false,title:msgTitle,buttons:{Ok:function(){$(this).dialog('close');}}});},alert:function(msg,msgTitle){if(msgTitle==undefined){msgTitle="Message";}
$('#apollo_dialog').dialog("destroy");$('#apollo_dialog').html(msg);$('#apollo_dialog').dialog({resizable:false,modal:false,title:msgTitle,buttons:{Ok:function(){$(this).dialog('close');}}});},confirm:function(msg,onOKCallback,onCancelCallback){$('#apollo_dialog').dialog("destroy");$('#apollo_dialog').html(msg);$('#apollo_dialog').dialog({resizable:false,modal:false,title:"Confirm",buttons:{Cancel:function(){$(this).dialog('close');if(onCancelCallback)onCancelCallback();},Ok:function(){$(this).dialog('close');if(onOKCallback)onOKCallback();}}})},showAjaxError:function(ret){if(ret.data!=undefined){Logger.error(ret.result+'\n'+ret.data);}
else{Logger.error(ret.data);}},setProgressBarColorMap:function(div,minVal,maxVal,map){$(div).bind('progressbarchange',function(event,ui){var selector="#"+this.id+" > div";var val=this.getAttribute("aria-valuenow");if(map==undefined)map='heat';var hexCol='#f00';if(map=='heat'){hexCol=AthenaDialog.findHeatcolor(val,minVal,maxVal,'greentored');}
else if(map=='roygbiv'){hexCol=AthenaDialog.findHeatcolor(val,minVal,maxVal,'roygbiv');}
$(selector).css({'background':hexCol});});},findHeatcolor:function(curval,mn,mx,colorStyle){var position=1-((curval-mn)/(mx-mn));var lightness=0.15;var shft=colorStyle=='roygbiv'?0.5*position+1.7*(1-position):position+0.2+5.5*(1-position);var scale=128;var period=2*Math.PI;var x=shft+position*period;x=colorStyle!='roygbiv'?-x:x;var r=AthenaDialog.processColor(Math.floor((Math.cos(x)+1)*scale),lightness);var g=AthenaDialog.processColor(Math.floor((Math.cos(x+Math.PI/2)+1)*scale),lightness);var b=AthenaDialog.processColor(Math.floor((Math.cos(x+Math.PI)+1)*scale),lightness);return'#'+r+g+b;},processColor:function(num,lightness){var n=Math.floor(num+lightness*(256-num));var s=n.toString(16);s=s.length==1?'0'+s:s;return s;}}

var StatViewer={paintPieChart:function(div){var no_stats=StatViewerData.browserStats.length;var firefox3=0;var firefox2=0;var safari2=0;var safari3=0;var safari4=0;var ie6=0;var ie7=0;var ie8=0;var ie9=0;var iphone=0;var other=0;var chrome=0;for(var i=0;i<no_stats;i++){var browser=StatViewerData.browserStats[i].browser;var ver=parseInt(StatViewerData.browserStats[i].version.substring(0,1))
var hits=StatViewerData.browserStats[i].hits;if(browser.indexOf('Firefox')!=-1){if(ver==3){firefox3+=hits;}
else if(ver==2){firefox2+=hits;}}
else if(browser.indexOf('Safari')!=-1){if(ver==2){safari2+=hits;}
else if(ver==3){safari3+=hits;}
else if(ver==4){safari4+=hits;}}
else if(browser.indexOf('iPhone')!=-1){iphone++;}
else if(browser.indexOf('Explorer')!=-1){if(ver==6){ie6+=hits;}
else if(ver==7){ie7+=hits;}
else if(ver==8){ie8+=hits;}
else if(ver==9){ie9+=hits;}}
else if(browser.indexOf('Chrome')!=-1){chrome++;}
else{if(browser!="unknown"){other+=hits;}}}
var data=[{label:"Firefox 2",data:firefox2},{label:"Firefox 3",data:firefox3},{label:"Safari 2",data:safari2},{label:"Safari 3",data:safari3},{label:"Safari 4",data:safari4},{label:"iPhone",data:iphone},{label:"IE 6",data:ie6},{label:"IE 7",data:ie7},{label:"IE 8",data:ie8},{label:"IE 9",data:ie9},{label:"Chrome",data:chrome},{label:"Other",data:other}];jQuery.plot(jQuery(div),data,{series:{pie:{show:true}},legend:{show:false}});},paintCrawlerGraph:function(div,crawlerStats,isGlobal){if(isGlobal==undefined)isGlobal=false;var no_stats=0;if(crawlerStats||crawlerStats!=undefined){no_stats=crawlerStats.length;}
var yahooStats=new Array();var googleStats=new Array();var msnStats=new Array();var curlStats=new Array();var yandexStats=new Array();var otherStats=new Array();var maxTimeSet=false;var maxTime=new Date('1/1/1970');var nowTime=new Date();var now=new Date();var one_day=1000*60*60*24
for(var i=1;i<31;i++){var d=new Date();d.setDate(d.getDate()-i);googleStats[i]=new Array(d.getTime(),0);yahooStats[i]=new Array(d.getTime(),0);msnStats[i]=new Array(d.getTime(),0);curlStats[i]=new Array(d.getTime(),0);otherStats[i]=new Array(d.getTime(),0);}
for(var i=0;i<no_stats;i++){var crawler=crawlerStats[i].crw;var hits=crawlerStats[i].pv;var t=new Date(crawlerStats[i].dt);var daysago=Math.ceil((nowTime.getTime()-t.getTime())/one_day);if(crawler.indexOf('Google')!=-1){googleStats[daysago]=Array(t.getTime(),hits);}
else if(crawler.indexOf('MSN')!=-1){msnStats[daysago]=Array(t.getTime(),hits);}
else if(crawler.indexOf('Yahoo')!=-1){yahooStats[daysago]=Array(t.getTime(),hits);}
else if(crawler.indexOf('Curl')!=-1){curlStats[daysago]=Array(t.getTime(),hits);}
else{otherStats[daysago]=Array(t.getTime(),hits);}
if(t.getTime()>maxTime.getTime()){maxTime=new Date(t.getTime());maxTimeSet=true;}}
if(!maxTimeSet){maxTime=new Date();}
now=new Date();now.setDate(now.getDate()-30);var startTime=now.getTime();var endTime=maxTime.getTime();var plot=jQuery.plot(jQuery(div),[{data:googleStats,label:'Google',lines:{show:true,fill:true}},{data:yahooStats,label:'Yahoo',lines:{show:true,fill:true}},{data:msnStats,label:'Bing (Microsoft)',lines:{show:true,fill:true}},{data:otherStats,label:'Other',lines:{show:true,fill:true}}],{legend:{show:true,position:"nw"},xaxis:{mode:"time",min:startTime,max:endTime},grid:{hoverable:true,clickable:true,markings:StatViewer.weekendAreas},series:{bars:{show:false,lineWidth:5},points:{show:true,fill:false}}});var previousPoint=null;jQuery(div).bind("plothover",function(event,pos,item){jQuery("#x").text(pos.x.toFixed(2));jQuery("#y").text(pos.y.toFixed(2));if(item){if(previousPoint!=item.datapoint){previousPoint=item.datapoint;jQuery("#tooltip").remove();var x=item.datapoint[0].toFixed(2),y=item.datapoint[1].toFixed(2);StatViewer.showTooltip(item.pageX,item.pageY,item.series.label+" = "+y);}}
else{jQuery("#tooltip").remove();previousPoint=null;}});jQuery(div).bind("plotclick",function(event,pos,item){if(item){jQuery("#clickdata").text("You clicked point "+item.dataIndex+" in "+item.series.label+".");plot.highlight(item.series,item.datapoint);}});},paintStatGraph:function(div,pageViewData){var uniqueViews=new Array();var pageViews=new Array();var dateList=new Array();if(pageViewData||pageViewData!=undefined){for(var i=0;i<pageViewData.length;i++){uniqueViews.push(pageViewData[i].uv);pageViews.push(pageViewData[i].pv);dateList.push(pageViewData[i].dt);}}
var graphdata1=new Array();var graphdata2=new Array();var maxTime=new Date('1/1/1970');for(var i=0;i<uniqueViews.length;i++){var t=new Date(dateList[i]);graphdata1.push([t.getTime(),uniqueViews[i]]);}
for(var i=0;i<pageViews.length;i++){var t=new Date(dateList[i]);graphdata2.push([t.getTime(),pageViews[i]]);if(t.getTime()>maxTime.getTime()){maxTime=new Date(t.getTime());}}
var now=new Date();now.setDate(now.getDate()-30);var startTime=now.getTime();var endTime=maxTime.getTime();var plot=jQuery.plot(jQuery(div),[{data:graphdata1,label:'Unique Visitors',lines:{show:true,fill:true}},{data:graphdata2,label:'Page Views',lines:{show:true,fill:true}}],{legend:{show:true,position:"nw"},xaxis:{mode:"time",min:startTime,max:endTime},grid:{hoverable:true,clickable:true,markings:StatViewer.weekendAreas},series:{lines:{show:true},points:{show:true}}});var previousPoint=null;jQuery(div).bind("plothover",function(event,pos,item){jQuery("#x").text(pos.x.toFixed(2));jQuery("#y").text(pos.y.toFixed(2));if(item){if(previousPoint!=item.datapoint){previousPoint=item.datapoint;jQuery("#tooltip").remove();var x=item.datapoint[0].toFixed(2),y=item.datapoint[1].toFixed(2);StatViewer.showTooltip(item.pageX,item.pageY,item.series.label+" = "+y);}}
else{jQuery("#tooltip").remove();previousPoint=null;}});jQuery(div).bind("plotclick",function(event,pos,item){if(item){jQuery("#clickdata").text("You clicked point "+item.dataIndex+" in "+item.series.label+".");plot.highlight(item.series,item.datapoint);}});},weekendAreas:function(axes){var markings=[];var d=new Date(axes.xaxis.min);d.setUTCDate(d.getUTCDate()-((d.getUTCDay()+1)%7))
d.setUTCSeconds(0);d.setUTCMinutes(0);d.setUTCHours(0);var i=d.getTime();do{markings.push({xaxis:{from:i,to:i+2*24*60*60*1000},color:"#d7dcdc"});i+=7*24*60*60*1000;}while(i<axes.xaxis.max);return markings;},showTooltip:function(x,y,contents){jQuery('<div id="tooltip">'+contents+'</div>').css({position:'absolute',display:'none',fontSize:'10px',top:y+5,left:x+5,border:'1px solid #fdd',padding:'2px','background-color':'#fee',opacity:0.80}).appendTo("body").fadeIn(200);}}

function FileProgress(file,targetID){this.fileProgressID=file.id;this.opacity=100;this.height=0;this.fileProgressWrapper=document.getElementById(this.fileProgressID);if(!this.fileProgressWrapper){this.fileProgressWrapper=document.createElement("div");this.fileProgressWrapper.className="progressWrapper";this.fileProgressWrapper.id=this.fileProgressID;this.fileProgressElement=document.createElement("div");this.fileProgressElement.className="progressContainer";var progressCancel=document.createElement("a");progressCancel.className="progressCancel";progressCancel.href="#";progressCancel.style.visibility="hidden";progressCancel.appendChild(document.createTextNode(" "));var progressText=document.createElement("div");progressText.className="progressName";progressText.appendChild(document.createTextNode(file.name));var progressBar=document.createElement("div");progressBar.className="progressBarInProgress";var progressStatus=document.createElement("div");progressStatus.className="progressBarStatus";progressStatus.innerHTML="&nbsp;";this.fileProgressElement.appendChild(progressCancel);this.fileProgressElement.appendChild(progressText);this.fileProgressElement.appendChild(progressStatus);this.fileProgressElement.appendChild(progressBar);this.fileProgressWrapper.appendChild(this.fileProgressElement);document.getElementById(targetID).appendChild(this.fileProgressWrapper);}else{this.fileProgressElement=this.fileProgressWrapper.firstChild;this.reset();}
this.height=this.fileProgressWrapper.offsetHeight;this.setTimer(null);}
FileProgress.prototype.setTimer=function(timer){this.fileProgressElement["FP_TIMER"]=timer;};FileProgress.prototype.getTimer=function(timer){return this.fileProgressElement["FP_TIMER"]||null;};FileProgress.prototype.reset=function(){this.fileProgressElement.className="progressContainer";this.fileProgressElement.childNodes[2].innerHTML="&nbsp;";this.fileProgressElement.childNodes[2].className="progressBarStatus";this.fileProgressElement.childNodes[3].className="progressBarInProgress";this.fileProgressElement.childNodes[3].style.width="0%";this.appear();};FileProgress.prototype.setProgress=function(percentage){this.fileProgressElement.className="progressContainer green";this.fileProgressElement.childNodes[3].className="progressBarInProgress";this.fileProgressElement.childNodes[3].style.width=percentage+"%";this.appear();};FileProgress.prototype.setComplete=function(){this.fileProgressElement.className="progressContainer blue";this.fileProgressElement.childNodes[3].className="progressBarComplete";this.fileProgressElement.childNodes[3].style.width="";var oSelf=this;this.setTimer(setTimeout(function(){oSelf.disappear();},5000));};FileProgress.prototype.setError=function(){this.fileProgressElement.className="progressContainer red";this.fileProgressElement.childNodes[3].className="progressBarError";this.fileProgressElement.childNodes[3].style.width="";var oSelf=this;this.setTimer(setTimeout(function(){oSelf.disappear();},5000));};FileProgress.prototype.setCancelled=function(){this.fileProgressElement.className="progressContainer";this.fileProgressElement.childNodes[3].className="progressBarError";this.fileProgressElement.childNodes[3].style.width="";var oSelf=this;this.setTimer(setTimeout(function(){oSelf.disappear();},2000));};FileProgress.prototype.setStatus=function(status){this.fileProgressElement.childNodes[2].innerHTML=status;};FileProgress.prototype.toggleCancel=function(show,swfUploadInstance){this.fileProgressElement.childNodes[0].style.visibility=show?"visible":"hidden";if(swfUploadInstance){var fileID=this.fileProgressID;this.fileProgressElement.childNodes[0].onclick=function(){swfUploadInstance.cancelUpload(fileID);return false;};}};FileProgress.prototype.appear=function(){if(this.getTimer()!==null){clearTimeout(this.getTimer());this.setTimer(null);}
if(this.fileProgressWrapper.filters){try{this.fileProgressWrapper.filters.item("DXImageTransform.Microsoft.Alpha").opacity=100;}catch(e){this.fileProgressWrapper.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=100)";}}else{this.fileProgressWrapper.style.opacity=1;}
this.fileProgressWrapper.style.height="";this.height=this.fileProgressWrapper.offsetHeight;this.opacity=100;this.fileProgressWrapper.style.display="";};FileProgress.prototype.disappear=function(){var reduceOpacityBy=15;var reduceHeightBy=4;var rate=30;if(this.opacity>0){this.opacity-=reduceOpacityBy;if(this.opacity<0){this.opacity=0;}
if(this.fileProgressWrapper.filters){try{this.fileProgressWrapper.filters.item("DXImageTransform.Microsoft.Alpha").opacity=this.opacity;}catch(e){this.fileProgressWrapper.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity="+this.opacity+")";}}else{this.fileProgressWrapper.style.opacity=this.opacity/100;}}
if(this.height>0){this.height-=reduceHeightBy;if(this.height<0){this.height=0;}
this.fileProgressWrapper.style.height=this.height+"px";}
if(this.height>0||this.opacity>0){var oSelf=this;this.setTimer(setTimeout(function(){oSelf.disappear();},rate));}else{this.fileProgressWrapper.style.display="none";this.setTimer(null);}};

var FlashUploader={fileQueued:function(file){try{var progress=new FileProgress(file,this.customSettings.progressTarget);progress.setStatus("Pending...");progress.toggleCancel(true,this);}catch(ex){Logger.error("[FlashUploader.fileQueued] "+ex);}},fileQueueError:function(file,errorCode,message){try{if(errorCode===SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED){AthenaDialog.message("You have attempted to queue too many files.\n"+(message===0?"You have reached the upload limit.":"You may select "+(message>1?"up to "+message+" files.":"one file.")));return;}
var progress=new FileProgress(file,this.customSettings.progressTarget);progress.setError();progress.toggleCancel(false);switch(errorCode){case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:progress.setStatus("File is too big.");Logger.error("[FlashUploader.fileQueueError ] Error Code: File too big, File name: "+file.name+", File size: "+file.size+", Message: "+message);break;case SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE:progress.setStatus("Cannot upload Zero Byte files.");Logger.error("[FlashUploader.fileQueueError ] Error Code: Zero byte file, File name: "+file.name+", File size: "+file.size+", Message: "+message);break;case SWFUpload.QUEUE_ERROR.INVALID_FILETYPE:progress.setStatus("Invalid File Type.");Logger.error("[FlashUploader.fileQueueError ] Error Code: Invalid File Type, File name: "+file.name+", File size: "+file.size+", Message: "+message);break;default:if(file!==null){progress.setStatus("Unhandled Error");}
Logger.error("[FlashUploader.fileQueueError ] Error Code: "+errorCode+", File name: "+file.name+", File size: "+file.size+", Message: "+message);break;}}catch(ex){Logger.error(ex);}},fileDialogComplete:function(numFilesSelected,numFilesQueued){try{if(numFilesSelected>0){if(this.customSettings.cancelButtonId!=undefined){document.getElementById(this.customSettings.cancelButtonId).disabled=false;}}
this.startUpload();}catch(ex){Logger.error("[FlashUploader.fileDialogComplete] "+ex);}},uploadStart:function(file){try{this.removePostParam('folder_id');this.addPostParam('folder_id',DataStore.m_currentFolderID);var progress=new FileProgress(file,this.customSettings.progressTarget);progress.setStatus("Uploading...");progress.toggleCancel(true,this);}
catch(ex){Logger.error("[FlashUploader.uploadStart] "+ex);}
return true;},uploadProgress:function(file,bytesLoaded,bytesTotal){try{var percent=Math.ceil((bytesLoaded/bytesTotal)*100);var progress=new FileProgress(file,this.customSettings.progressTarget);progress.setProgress(percent);progress.setStatus("Uploading...");}catch(ex){Logger.error("[FlashUploader.uploadProgress] "+ex);}},uploadSuccess:function(file,serverData){try{var progress=new FileProgress(file,this.customSettings.progressTarget);progress.setComplete();progress.setStatus("Complete.");progress.toggleCancel(false);}catch(ex){Logger.error("[FlashUploader.uploadSuccess] "+ex);}},uploadError:function(file,errorCode,message){try{var progress=new FileProgress(file,this.customSettings.progressTarget);progress.setError();progress.toggleCancel(false);switch(errorCode){case SWFUpload.UPLOAD_ERROR.HTTP_ERROR:if(message==413){progress.setStatus("Error: Exceeded maximum file size");}
else{progress.setStatus("Upload Error: "+message);}
Logger.error("[FlashUploader.uploadError] Error Code: HTTP Error, File name: "+file.name+", Message: "+message);break;case SWFUpload.UPLOAD_ERROR.UPLOAD_FAILED:progress.setStatus("Upload Failed.");Logger.error("[FlashUploader.uploadError] Error Code: Upload Failed, File name: "+file.name+", File size: "+file.size+", Message: "+message);break;case SWFUpload.UPLOAD_ERROR.IO_ERROR:progress.setStatus("Server (IO) Error");Logger.error("[FlashUploader.uploadError] Error Code: IO Error, File name: "+file.name+", Message: "+message);break;case SWFUpload.UPLOAD_ERROR.SECURITY_ERROR:progress.setStatus("Security Error");Logger.error("[FlashUploader.uploadError] Error Code: Security Error, File name: "+file.name+", Message: "+message);break;case SWFUpload.UPLOAD_ERROR.UPLOAD_LIMIT_EXCEEDED:progress.setStatus("Upload limit exceeded.");Logger.error("[FlashUploader.uploadError] Error Code: Upload Limit Exceeded, File name: "+file.name+", File size: "+file.size+", Message: "+message);break;case SWFUpload.UPLOAD_ERROR.FILE_VALIDATION_FAILED:progress.setStatus("Failed Validation. Upload skipped.");Logger.error("[FlashUploader.uploadError] Error Code: File Validation Failed, File name: "+file.name+", File size: "+file.size+", Message: "+message);break;case SWFUpload.UPLOAD_ERROR.FILE_CANCELLED:if(FlashUploader.getStats().files_queued===0){if(this.customSettings.cancelButtonId!=undefined){document.getElementById(this.customSettings.cancelButtonId).disabled=true;}}
progress.setStatus("Cancelled");progress.setCancelled();break;case SWFUpload.UPLOAD_ERROR.UPLOAD_STOPPED:progress.setStatus("Stopped");break;default:progress.setStatus("Unhandled Error: "+errorCode);Logger.error("[FlashUploader.uploadError] Error Code: "+errorCode+", File name: "+file.name+", File size: "+file.size+", Message: "+message);break;}}catch(ex){Logger.error(ex);}},uploadComplete:function(file){if(this.getStats().files_queued===0){if(this.customSettings.cancelButtonId!=undefined){document.getElementById(this.customSettings.cancelButtonId).disabled=true;}}},queueComplete:function(numFilesUploaded){ssMain.refresh();}}

var ssMain={VIEW_DASHBOARD:1,VIEW_PAGES:3,VIEW_FILES:2,VIEW_POSTS:4,VIEW_GALLERIES:5,VIEW_STATS:6,VIEW_SETTINGS:7,view:1,init:function(siteID,view){ssMain.view=view;Logger.init('#debug_txt');SystemAPI.init();BlogAPI.init();MediaAPI.init();GalleryAPI.init();setInterval("DataStore.save()",5000);$(window).unload(function(){DataStore.save();});setTimeout("ssMain.onResize()",100);$(window).resize(function(){ssMain.onResize()});$('.apolloDataInput').typing({stop:ssMain.onDataChange,delay:400});$('.apolloDataInput').change(ssMain.onDataChange);},onResize:function(){$('#MainContents').height($(window).height()-$('#menu_container').height()-20);},onLogout:function(){AthenaDialog.confirm("Are you sure you want to log out?",ssMain.startLogout);},startLogout:function(){SystemAPI.logOut(ssMain.doLogout);},doLogout:function(){window.location="index.php";},onDataChange:function(){switch(ssMain.view){case ssMain.VIEW_PAGES:PagesFrame.onChange();break;case ssMain.VIEW_POSTS:PostsFrame.onChange();break;case ssMain.VIEW_FILES:FilesFrame.onImageEditorChange();break;case ssMain.VIEW_DASHBOARD:case ssMain.VIEW_GALLERIES:case ssMain.VIEW_STATS:break;}}}

var AthenaUtils={htmlEncode:function(string){if(string==''||string==undefined){return'';}
string=string.toString();string=string.replace(/&/g,'&amp;');string=string.replace(/'/g,'&#039;');string=string.replace(/"/g,'&quot;');string=string.replace(/</g,'&lt;').replace(/>/g,'&gt;');return string;},decodeContent:function(string){if(string==''||string==undefined){return'';}
string=string.toString();string=string.replace(/\\/g,'');return string;},encodeTitle:function(string){return string;},encodeSlug:function(title){return title;},addCommas:function(nStr,nDP){nStr=parseFloat(nStr).toFixed(nDP);nStr+='';x=nStr.split('.');x1=x[0];x2=x.length>1?'.'+x[1]:'';var rgx=/(\d+)(\d{3})/;while(rgx.test(x1)){x1=x1.replace(rgx,'$1'+','+'$2');}
return x1+x2;}}

var DataStore={m_currentFolderID:-1,m_currentPageID:0,m_currentGalleryNo:1,m_currentPostID:0,m_currentTag:'',m_siteID:0,m_folderList:'',m_mediaList:'',m_postList:'',m_pageList:'',m_templateList:'',m_themeParaList:'',m_siteParaList:'',m_galleryImageList:'',m_galleryMetaList:'',m_categories:'',m_tags:'',m_mediaTags:'',m_doAutoSave:true,init:function(siteID){DataStore.m_siteID=siteID;},clear:function(){DataStore.m_folderList='';DataStore.m_mediaList='';DataStore.m_pageList='';},getSiteParaValue:function(page_id,theme_para_id){for(var i=0;i<DataStore.m_siteParaList.length;i++){if((DataStore.m_siteParaList[i].theme_para_id==theme_para_id)&&(DataStore.m_siteParaList[i].page_id==page_id)){return DataStore.m_siteParaList[i].para_value;}}
return false;},getPageThemeParas:function(template_name){var list=new Array();for(var i=0;i<DataStore.m_themeParaList.length;i++){if(DataStore.m_themeParaList[i].page_template_name==template_name){list.push(DataStore.m_themeParaList[i]);}}
return list;},getImage:function(image_id){for(var i=0;i<DataStore.m_mediaList.length;i++){if(DataStore.m_mediaList[i].id==image_id){return DataStore.m_mediaList[i];}}
return false;},removeGalleryImage:function(slot_no){var tempList=new Array();for(var i=0;i<DataStore.m_galleryImageList.length;i++){if(!(DataStore.m_galleryImageList[i].slot_number==slot_no&&DataStore.m_galleryImageList[i].gallery_number==DataStore.m_currentGalleryNo)){tempList.push(DataStore.m_galleryImageList[i]);}}
DataStore.m_galleryImageList=tempList;},isSlotFree:function(slot_no){var slotContents=DataStore.getGallerySlotImage(slot_no,gallery_no);if(slotContents==undefined||!slotContents)return false;return true;},isGalleryPage:function(page_id){var page=DataStore.getPage(page_id);var pageParas=DataStore.getPageThemeParas(page.template);for(var i=0;i<pageParas.length;i++){if(pageParas[i].para_type=='gallery'){return true;}}
return false;},getGallerySlotImage:function(slot_no,gallery_no){for(var i=0;i<DataStore.m_galleryImageList.length;i++){if(DataStore.m_galleryImageList[i].slot_number==slot_no&&DataStore.m_galleryImageList[i].gallery_number==gallery_no){return DataStore.m_galleryImageList[i];}}
return false;},getPage:function(page_id){for(var i=0;i<DataStore.m_pageList.length;i++){if(DataStore.m_pageList[i].id==page_id){return DataStore.m_pageList[i];}}
AthenaDialog.error('coiuld not find page with id = '+page_id);return false;},getHomePage:function(){for(var i=0;i<DataStore.m_pageList.length;i++){if(DataStore.m_pageList[i].is_homepage==1){return DataStore.m_pageList[i];}}
return false;},getBlogPage:function(){for(var i=0;i<DataStore.m_pageList.length;i++){if(DataStore.m_pageList[i].is_blogpage==1){return DataStore.m_pageList[i];}}
return false;},getCurrentPage:function(){return DataStore.getPage(DataStore.m_currentPageID);},getFolderName:function(folder_id){if(folder_id==FolderSidebarFrame.ID_UNASSIGNED){return"Unassigned";}
for(var i=0;i<DataStore.m_folderList.length;i++){if(DataStore.m_folderList[i].id==folder_id){return DataStore.m_folderList[i].name;}}
return"? ("+folder_id+")";},getRootPage:function(page_id){var page=DataStore.getPage(page_id);if(page.parent_page_id==0){return page;}
return DataStore.getRootPage(page.parent_page_id);},isChildOff:function(page_id,test_page_id){var testPage=DataStore.getPage(test_page_id);if(testPage.parent_page_id==0){return false;}
if(testPage.parent_page_id==page_id){return true;}
else{return DataStore.isChildOff(page_id,testPage.parent_page_id);}},getMaxDepth:function(){var max_depth=0;for(var i=0;i<DataStore.m_pageList.length;i++){var depth=DataStore.getPageDepth(DataStore.m_pageList[i].id);if(depth>max_depth){max_depth=depth;}}
return max_depth;},getPageDepth:function(page_id){var page=DataStore.getPage(page_id);if(page.parent_page_id==0){return 1;}
else{return 1+DataStore.getPageDepth(page.parent_page_id);}},updateSitePara:function(theme_para_id,page_id,new_para_val){var paraFound=false;for(var i=0;i<DataStore.m_siteParaList.length;i++){if((DataStore.m_siteParaList[i].theme_para_id==theme_para_id)&&(DataStore.m_siteParaList[i].page_id==page_id)){DataStore.m_siteParaList[i].para_value=new_para_val;paraFound=true;}}
if(!paraFound){var temp=new Object();temp.theme_para_id=theme_para_id;temp.para_value=new_para_val;temp.page_id=page_id;DataStore.m_siteParaList.push(temp);}},updatePage:function(pageObj){for(var i=0;i<DataStore.m_pageList.length;i++){if(DataStore.m_pageList[i].id==pageObj.id){DataStore.m_pageList[i].id=pageObj.id;DataStore.m_pageList[i].title=AthenaUtils.encodeTitle(pageObj.title);DataStore.m_pageList[i].browser_title=AthenaUtils.encodeTitle(pageObj.browser_title);DataStore.m_pageList[i].user_id=pageObj.user_id;DataStore.m_pageList[i].content=pageObj.content;DataStore.m_pageList[i].status=pageObj.status;DataStore.m_pageList[i].last_edit=pageObj.last_edit;DataStore.m_pageList[i].created=pageObj.created;DataStore.m_pageList[i].template=pageObj.template;DataStore.m_pageList[i].parent_page_id=pageObj.parent_page_id;DataStore.m_pageList[i].slug=pageObj.slug;DataStore.m_pageList[i].path=pageObj.path;DataStore.m_pageList[i].is_homepage=pageObj.is_homepage;DataStore.m_pageList[i].is_blogpage=pageObj.is_blogpage;DataStore.m_pageList[i].page_order=pageObj.page_order;DataStore.m_pageList[i].description=pageObj.description;DataStore.m_pageList[i].isChanged=1;return;}}},deletePage:function(page_id){var tempList=new Array();for(var i=0;i<DataStore.m_pageList.length;i++){if(DataStore.m_pageList[i].id!=page_id){tempList.push(DataStore.m_pageList[i]);}}
DataStore.m_pageList=tempList;for(var i=0;i<DataStore.m_pageList.length;i++){if(DataStore.m_pageList[i].parent_page_id==page_id){DataStore.m_pageList[i].parent_page_id=0;}}},addPage:function(pageObj){var temp=new Object();temp.id=pageObj.id;temp.title=AthenaUtils.encodeTitle(pageObj.title);temp.user_id=pageObj.user_id;temp.content=pageObj.content;temp.status=pageObj.status;temp.last_edit=pageObj.last_edit;temp.created=pageObj.created;temp.template=pageObj.template;temp.parent_page_id=pageObj.parent_page_id;temp.slug=pageObj.slug;temp.path=pageObj.path;temp.is_homepage=pageObj.is_homepage;temp.is_blogpage=pageObj.is_blogpage;temp.page_order=pageObj.page_order;temp.description=pageObj.description;temp.browser_title=pageObj.browser_title;DataStore.m_pageList.push(temp);},addPost:function(postObj,toStart){var temp=new Object();temp.id=postObj.id;temp.title=AthenaUtils.encodeTitle(postObj.title);temp.user_id=postObj.user_id;temp.content=AthenaUtils.decodeContent(postObj.content);temp.status=postObj.status;temp.last_edit=postObj.last_edit;temp.created=postObj.created;temp.slug=postObj.slug;temp.path=postObj.path;temp.canComment=postObj.canComment;temp.tags=postObj.tags;temp.categories=postObj.categories;if(temp.tags==undefined){temp.tags=new Array();}
if(temp.categories==undefined){temp.categories=new Array();}
if(!toStart){DataStore.m_postList.push(temp);}
else{DataStore.m_postList.unshift(temp);}},updatePost:function(postObj){for(var i=0;i<DataStore.m_postList.length;i++){if(DataStore.m_postList[i].id==postObj.id){DataStore.m_postList[i].id=postObj.id;DataStore.m_postList[i].title=AthenaUtils.encodeTitle(postObj.title);DataStore.m_postList[i].user_id=postObj.user_id;DataStore.m_postList[i].content=AthenaUtils.decodeContent(postObj.content);DataStore.m_postList[i].status=postObj.status;DataStore.m_postList[i].last_edit=postObj.last_edit;DataStore.m_postList[i].created=postObj.created;DataStore.m_postList[i].slug=postObj.slug;DataStore.m_postList[i].path=postObj.path;DataStore.m_postList[i].canComment=postObj.canComment;DataStore.m_postList[i].tags=postObj.tags;DataStore.m_postList[i].categories=postObj.categories;if(DataStore.m_postList[i].tags==undefined){DataStore.m_postList[i].tags=new Array();}
if(DataStore.m_postList[i].categories==undefined){DataStore.m_postList[i].categories=new Array();}
DataStore.m_postList[i].isChanged=1;return;}}},deletePost:function(post_id){var tempList=new Array();for(var i=0;i<DataStore.m_postList.length;i++){if(DataStore.m_postList[i].id!=post_id){tempList.push(DataStore.m_postList[i]);}}
DataStore.m_postList=tempList;},getPost:function(post_id){for(var i=0;i<DataStore.m_postList.length;i++){if(DataStore.m_postList[i].id==post_id){return DataStore.m_postList[i];}}
return false;},save:function(){if(!DataStore.m_doAutoSave)return;var autosaved=false;var savingPost=false;var savingPage=false;var savingMedia=false;for(var i=0;i<DataStore.m_postList.length;i++){if(DataStore.m_postList[i].isChanged!=undefined&&DataStore.m_postList[i].isChanged==1){DataStore.savePost(DataStore.m_postList[i]);autosaved=true;savingPost=true;}}
for(i=0;i<DataStore.m_pageList.length;i++){if(DataStore.m_pageList[i].isChanged!=undefined&&DataStore.m_pageList[i].isChanged==1){DataStore.savePage(DataStore.m_pageList[i]);autosaved=true;savingPage=true;}}
for(i=0;i<DataStore.m_mediaList.length;i++){if(DataStore.m_mediaList[i].isChanged!=undefined&&DataStore.m_mediaList[i].isChanged==1){DataStore.saveMedia(DataStore.m_mediaList[i]);autosaved=true;savingMedia=true;}}
if(autosaved){var what="";if(savingPost)what+=" post";if(savingPage)what+=" page";if(savingMedia)what+=" media";AthenaDialog.backgroundMessage("Autosaved"+what);}},saveMedia:function(mediaObj){MediaAPI.updateMediaInfo(DataStore.m_siteID,mediaObj.id,mediaObj.title,mediaObj.description,mediaObj.tags,DataStore.onMediaSaved);},onMediaSaved:function(mediaObj){DataStore.updateMedia(mediaObj);for(var i=0;i<DataStore.m_mediaList.length;i++){if(DataStore.m_mediaList[i].id==mediaObj.id){DataStore.m_mediaList[i].isChanged=0;}}},savePage:function(pageObj){MediaAPI.updatePage(DataStore.m_siteID,pageObj.id,pageObj.title,pageObj.content,pageObj.status,pageObj.template,pageObj.parent_page_id,pageObj.slug,pageObj.page_order,pageObj.is_homepage,pageObj.description,pageObj.browser_title,DataStore.onPageSaved);},onPageSaved:function(pageObj){DataStore.updatePage(pageObj);for(var i=0;i<DataStore.m_pageList.length;i++){if(DataStore.m_pageList[i].id==pageObj.id){DataStore.m_pageList[i].isChanged=0;}}
if(pageObj.id==DataStore.m_currentPageID&&ssMain.view==ssMain.VIEW_PAGES){$('#pageLastEdit').html(pageObj.last_edit);$('#pageLastEdit').effect("pulsate",{times:1},2000);}},savePost:function(postObj,callback){MediaAPI.updatePost(DataStore.m_siteID,postObj.id,postObj.title,postObj.content,postObj.status,postObj.canComment,postObj.slug,DataStore.onPostSaved)},onPostSaved:function(postObj){DataStore.updatePost(postObj);for(var i=0;i<DataStore.m_postList.length;i++){if(DataStore.m_postList[i].id==postObj.id){DataStore.m_postList[i].isChanged=0;}}
if(postObj.id==DataStore.m_currentPostID&&ssMain.view==ssMain.VIEW_POSTS){$('#postLastEdit').html(postObj.last_edit);$('#postLastEdit').effect("pulsate",{times:1},2000);}},load:function(callback){GalleryAPI.getAll(DataStore.m_siteID,function(gallery_images,gallery_meta){DataStore.onGotGalleryData(gallery_images,gallery_meta);});MediaAPI.getAll(DataStore.m_siteID,function(folders,media,pages,theme,page_templates,theme_paras,page_paras,posts,tags,categories,media_tag_list){DataStore.onGotData(folders,media,pages,theme,page_templates,theme_paras,page_paras,posts,tags,categories,media_tag_list,callback);});},onGotData:function(folder_list,media_list,page_list,theme,page_templates,theme_paras,paga_paras,post_list,tag_list,categories_list,media_tag_list,callback){DataStore.onGotFolders(folder_list);DataStore.onGotMedia(media_list);DataStore.onGotPages(page_list);DataStore.onGotPosts(post_list);DataStore.onGotPageTemplates(page_templates);DataStore.m_siteParaList=paga_paras;DataStore.m_themeParaList=theme_paras;DataStore.m_theme=theme;DataStore.m_categories=categories_list;DataStore.m_tags=tag_list;DataStore.m_mediaTags=media_tag_list;if(DataStore.m_themeParaList==undefined)DataStore.m_themeParaList=new Array();if(DataStore.m_siteParaList==undefined)DataStore.m_siteParaList=new Array();if(DataStore.m_categories==undefined)DataStore.m_categories=new Array();if(DataStore.m_tags==undefined)DataStore.m_tags=new Array();callback();},onGotGalleryData:function(gallery_images,gallery_meta){DataStore.onGotGalleryImages(gallery_images);DataStore.m_galleryMetaList=gallery_meta;if(DataStore.m_galleryImageList==undefined)DataStore.DataStore.m_galleryImageList=new Array();if(DataStore.m_galleryMetaList==undefined)DataStore.m_galleryMetaList=new Array();},onGotGalleryImages:function(gallery_images){if(!gallery_images||gallery_images==undefined){DataStore.m_galleryImageList=new Array();return;}
DataStore.m_galleryImageList=new Array(gallery_images.length);for(var i=0;i<gallery_images.length;i++){var temp=new Object();temp.id=parseInt(gallery_images[i].id);temp.image_id=parseInt(gallery_images[i].image_id);temp.slot_number=parseInt(gallery_images[i].slot_number);temp.gallery_number=parseInt(gallery_images[i].gallery_number);temp.theme_para_id=parseInt(gallery_images[i].theme_para_id);temp.page_id=parseInt(gallery_images[i].page_id);DataStore.m_galleryImageList[i]=temp;}},onGotPageTemplates:function(page_templates){if(!page_templates||page_templates==undefined){DataStore.m_templateList=new Array();return;}
DataStore.m_templateList=new Array();for(var i=0;i<page_templates.length;i++){var temp=new Object();temp.template_name=page_templates[i].template_name;temp.template_description=page_templates[i].template_description;temp.template_file=page_templates[i].template_file;DataStore.m_templateList[i]=temp;}},onGotPosts:function(post_list){if(!post_list||post_list==undefined){DataStore.m_postList=new Array();return;}
DataStore.m_postList=new Array();for(var i=0;i<post_list.length;i++){DataStore.addPost(post_list[i]);}
if(post_list.length>0&&DataStore.m_currentPostID==0){DataStore.m_currentPostID=post_list[0].id;}},onGotPages:function(page_list){if(!page_list||page_list==undefined){DataStore.m_pageList=new Array();return;}
DataStore.m_pageList=new Array();for(var i=0;i<page_list.length;i++){DataStore.addPage(page_list[i]);}
if(page_list.length>0&&DataStore.m_currentPageID==0){DataStore.m_currentPageID=page_list[0].id;}},onGotFolders:function(folder_list){if(!folder_list||folder_list==undefined){DataStore.m_folderList=new Array();return;}
DataStore.m_folderList=new Array(folder_list.length);for(var i=0;i<folder_list.length;i++){var temp=new Object();temp.id=folder_list[i].id;temp.name=folder_list[i].name;if(i==0){}
DataStore.m_folderList[i]=temp;}},onGotMedia:function(media_list){if(!media_list||media_list==undefined){DataStore.m_mediaList=new Array();return;}
DataStore.m_mediaList=new Array(media_list.length);for(var i=0;i<media_list.length;i++){var files_root=defines.user_files_root_url+DataStore.m_siteID+"/";var temp=new Object();temp.thumb_url=files_root+media_list[i].filepath+media_list[i].thumb_filename;temp.file_url=files_root+media_list[i].filepath+media_list[i].filename;temp.mime_type=media_list[i].mime_type;temp.title=media_list[i].title;temp.description=media_list[i].description;temp.tags=media_list[i].tags;temp.width=media_list[i].width;temp.height=media_list[i].height;temp.thumb_width=media_list[i].thumb_width;temp.thumb_height=media_list[i].thumb_height;temp.id=media_list[i].id;temp.date_added=media_list[i].created;temp.folder_id=media_list[i].folder_id;temp.media_tags=media_list[i].media_tags;if(i==0){}
DataStore.m_mediaList[i]=temp;}},updateMedia:function(mediaObj,preserveURL){if(preserveURL==undefined)preserveURL=false;for(var i=0;i<DataStore.m_mediaList.length;i++){if(DataStore.m_mediaList[i].id==mediaObj.id){var files_root=defines.user_files_root_url+DataStore.m_siteID+"/";DataStore.m_mediaList[i].id=mediaObj.id;if(preserveURL){DataStore.m_mediaList[i].thumb_url=mediaObj.thumb_url;DataStore.m_mediaList[i].file_url=mediaObj.file_url;}
else{DataStore.m_mediaList[i].thumb_url=files_root+mediaObj.filepath+mediaObj.thumb_filename;DataStore.m_mediaList[i].file_url=files_root+mediaObj.filepath+mediaObj.filename;}
DataStore.m_mediaList[i].mime_type=mediaObj.mime_type;DataStore.m_mediaList[i].title=mediaObj.title;DataStore.m_mediaList[i].description=mediaObj.description;DataStore.m_mediaList[i].tags=mediaObj.tags;DataStore.m_mediaList[i].width=mediaObj.width;DataStore.m_mediaList[i].height=mediaObj.height;DataStore.m_mediaList[i].thumb_width=mediaObj.thumb_width;DataStore.m_mediaList[i].thumb_height=mediaObj.thumb_height;DataStore.m_mediaList[i].date_added=mediaObj.date_added;DataStore.m_mediaList[i].folder_id=mediaObj.folder_id;DataStore.m_mediaList[i].media_tags=mediaObj.media_tags;DataStore.m_mediaList[i].isChanged=1;return;}}},deleteMedia:function(media_id){var tempList=new Array();for(var i=0;i<DataStore.m_mediaList.length;i++){if(DataStore.m_mediaList[i].id!=media_id){tempList.push(DataStore.m_mediaList[i]);}}
DataStore.m_mediaList=tempList;var tempList=new Array();for(var i=0;i<DataStore.m_galleryImageList.length;i++){if(DataStore.m_galleryImageList[i].image_id!=media_id){tempList.push(DataStore.m_galleryImageList[i]);}}
DataStore.m_galleryImageList=tempList;},getImagesForCurrentTag:function(){var tag=DataStore.m_currentTag;var imageList=DataStore.m_mediaList;var tagImageList=new Array();for(var i=0;i<imageList.length;i++){if(imageList[i].media_tags!=undefined&&imageList[i].media_tags!=null){for(var j=0;j<imageList[i].media_tags.length;j++){if(imageList[i].media_tags[j]==tag){tagImageList.push(imageList[i]);}}}}
return tagImageList;},getImagesForCurrentFolder:function(){var d=new Date();var localTime=d.getTime();var localOffset=d.getTimezoneOffset()*60000;var utc_date=new Date(localTime+localOffset);var utc_time=localTime+localOffset;var imageList=DataStore.m_mediaList;var folderImageList=new Array();for(var i=0;i<imageList.length;i++){var image_folder_id=parseInt(imageList[i].folder_id);var added_date=new Date(imageList[i].date_added);var hours_ago=(utc_time-added_date.getTime())/3600000;switch(DataStore.m_currentFolderID){case FolderSidebarFrame.ID_UNASSIGNED:if(image_folder_id==FolderSidebarFrame.ID_ALL||image_folder_id==FolderSidebarFrame.ID_UNASSIGNED)
folderImageList.push(imageList[i]);break;case FolderSidebarFrame.ID_LAST_1_HOUR:if(hours_ago<=1){folderImageList.push(imageList[i]);}
break;case FolderSidebarFrame.ID_LAST_24_HOURS:if(hours_ago<=24){folderImageList.push(imageList[i]);}
break;case FolderSidebarFrame.ID_LAST_7_DAYS:if(hours_ago<=168){folderImageList.push(imageList[i]);}
break;case FolderSidebarFrame.ID_ALL:folderImageList.push(imageList[i]);break;case image_folder_id:folderImageList.push(imageList[i]);break;default:}}
return folderImageList;}}

var SystemAPI={m_url:'/code/php/remoteapi/SystemAPI.php',init:function(){SystemAPI.m_url=defines.root_url+SystemAPI.m_url;},logOut:function(callback){var paras={cmd:'logOut'};$.ajax({url:SystemAPI.m_url,dataType:"json",data:paras,success:function(ret){callback();}});},checkUser:function(email,pass,callback){var paras={cmd:'checkUser',em:email,ps:pass};$.ajax({url:SystemAPI.m_url,dataType:"json",data:paras,success:function(ret){SystemAPI.onUserChecked(ret,callback);}});},onUserChecked:function(ret,callback){if(ret.result=='ok'){if(ret.data=='true'){callback(true);}
else{callback(false);}}
else{AthenaDialog.showAjaxError(ret);}},getStats:function(callback){var paras={cmd:'getStats'};$.ajax({url:SystemAPI.m_url,dataType:"json",success:function(ret){SystemAPI.onGotStats(ret,callback);},data:paras});},onGotStats:function(ret,callback){if(ret.result=='ok'){callback(ret.data.no_users,ret.data.no_sites,ret.data.no_pageviews);}
else{AthenaDialog.showAjaxError(ret);}}}

var MediaAPI={m_url:'/code/php/remoteapi/MediaAPI.php',init:function(){MediaAPI.m_url=defines.root_url+MediaAPI.m_url;},getAll:function(siteID,callback){AthenaDialog.showLoading("Loading media data");var paras={cmd:'getAll',site_id:siteID};$.ajax({url:MediaAPI.m_url,dataType:"json",data:paras,success:function(ret){AthenaDialog.clearLoading();if(ret.result=='ok'){callback(ret.data.folders,ret.data.media,ret.data.pages,ret.data.theme,ret.data.page_templates,ret.data.theme_paras,ret.data.page_paras,ret.data.posts,ret.data.tags,ret.data.categories,ret.data.media_tags);}
else{AthenaDialog.showAjaxError(ret);}}});},getStats:function(siteID,callback){AthenaDialog.showLoading("Loading stats data");var paras={cmd:'getStats',site_id:siteID};$.ajax({url:MediaAPI.m_url,dataType:"json",data:paras,success:function(ret){AthenaDialog.clearLoading();if(!ret||ret==undefined){callback(0);return;}
if(ret.result=='ok'){callback(ret.data.disc_usage,ret.data.page_views,ret.data.crawler_views);}
else{AthenaDialog.showAjaxError(ret);}}});},setPagePara:function(themeParaID,paraValue,pageID,callback){var paras={cmd:'setPagePara',site_id:DataStore.m_siteID,page_id:pageID,theme_para_id:themeParaID,para_value:paraValue};$.ajax({url:MediaAPI.m_url,dataType:"json",data:paras,success:function(ret){if(ret.result=="ok"){callback(ret.data.theme_para_id,ret.data.new_value,ret.data.page_id);}
else{AthenaDialog.showAjaxError(ret);}}});},setGlobalPara:function(themeParaID,paraValue,callback){var paras={cmd:'setGlobalPara',site_id:DataStore.m_siteID,theme_para_id:themeParaID,para_value:paraValue};$.ajax({url:MediaAPI.m_url,dataType:"json",data:paras,success:function(ret){if(ret.result=="ok"){callback(ret.data.theme_para_id,ret.data.new_value);}
else{AthenaDialog.showAjaxError(ret);}}});},getPostDetails:function(siteID,postID,callback){AthenaDialog.showLoading("Getting post details");var paras={cmd:'getPostDetails',site_id:siteID,post_id:postID};$.ajax({url:MediaAPI.m_url,type:'post',dataType:"json",data:paras,success:function(ret){MediaAPI.onGotPost(ret,callback)}});},updatePost:function(siteID,postID,postTitle,postContent,postStatus,postCanComment,postSlug,callback){var paras={cmd:'updatePost',site_id:siteID,post_id:postID,title:postTitle,content:postContent,status:postStatus,can_comment:postCanComment,slug:postSlug};$.ajax({url:MediaAPI.m_url,type:'post',dataType:"json",data:paras,success:function(ret){MediaAPI.onGotPost(ret,callback)}});},addPost:function(siteID,postTitle,postContent,postStatus,postCanComment,postSlug,callback){AthenaDialog.showLoading("Adding post");var paras={cmd:'addPost',site_id:siteID,title:postTitle,content:postContent,status:postStatus,can_comment:postCanComment,slug:postSlug};$.ajax({url:MediaAPI.m_url,type:'post',dataType:"json",data:paras,success:function(ret){MediaAPI.onGotPost(ret,callback)}});},onGotPost:function(ret,callback){AthenaDialog.clearLoading();if(ret.result=="ok"){callback(ret.data.post);}
else{AthenaDialog.showAjaxError(ret);}},deletePost:function(siteID,postID,callback){AthenaDialog.showLoading("Deleting post");var paras={cmd:'deletePost',site_id:siteID,post_id:postID};$.ajax({url:MediaAPI.m_url,dataType:"json",data:paras,success:function(ret){AthenaDialog.clearLoading();if(ret.result=="ok"){callback(ret.data.post_id);}
else{AthenaDialog.showAjaxError(ret);}}});},addTag:function(siteID,postID,csvPostTags,callback){var paras={cmd:'addPostTags',site_id:siteID,post_id:postID,csvtags:csvPostTags};$.ajax({url:MediaAPI.m_url,dataType:"json",data:paras,success:function(ret){if(ret.result=="ok"){callback(ret.data.post,ret.data.tags);}
else{AthenaDialog.showAjaxError(ret);}}});},addCategory:function(siteID,postID,csvPostCategories,callback){var paras={cmd:'addPostCategories',site_id:siteID,post_id:postID,csvcats:csvPostCategories};$.ajax({url:MediaAPI.m_url,dataType:"json",data:paras,success:function(ret){if(ret.result=="ok"){callback(ret.data.post,ret.data.categories);}
else{AthenaDialog.showAjaxError(ret);}}});},deleteTag:function(siteID,globalTag,callback){var paras={cmd:'deleteTag',site_id:siteID,tag:globalTag};$.ajax({url:MediaAPI.m_url,dataType:"json",data:paras,success:function(ret){if(ret.result=="ok"){callback(ret.data.tag);}
else{AthenaDialog.showAjaxError(ret);}}});},deleteCategory:function(siteID,globalCategory,callback){var paras={cmd:'deleteCategory',site_id:siteID,category:globalCategory};$.ajax({url:MediaAPI.m_url,dataType:"json",data:paras,success:function(ret){if(ret.result=="ok"){callback(ret.data.category);}
else{AthenaDialog.showAjaxError(ret);}}});},removeTag:function(siteID,postID,postTag,callback){AthenaDialog.showLoading("Removing tag");var paras={cmd:'removeTag',site_id:siteID,post_id:postID,tag:postTag};$.ajax({url:MediaAPI.m_url,dataType:"json",data:paras,success:function(ret){AthenaDialog.clearLoading();if(ret.result=="ok"){callback(ret.data.post_id,ret.data.tag);}
else{AthenaDialog.showAjaxError(ret);}}});},removeCategory:function(siteID,postID,postCategory,callback){AthenaDialog.showLoading("Removing category");var paras={cmd:'removeCategory',site_id:siteID,post_id:postID,category:postCategory};$.ajax({url:MediaAPI.m_url,dataType:"json",data:paras,success:function(ret){AthenaDialog.clearLoading();if(ret.result=="ok"){callback(ret.data.post_id,ret.data.category);}
else{AthenaDialog.showAjaxError(ret);}}});},updateCommentStatus:function(siteID,commentID,newStatus,callback){AthenaDialog.showLoading("Updating comment");var paras={cmd:'updateCommentStatus',site_id:siteID,cid:commentID,sts:newStatus};$.ajax({url:MediaAPI.m_url,dataType:"json",data:paras,success:function(ret){AthenaDialog.clearLoading();if(ret.result=="ok"){callback(ret.data.comment_id,ret.data.status);}
else{AthenaDialog.showAjaxError(ret);}}});},updatePage:function(siteID,pageID,pageTitle,pageContent,pageStatus,templateName,parentPageID,pageSlug,pageOrder,isHome,description,browserTitle,callback){var paras={cmd:'updatePage',site_id:siteID,page_id:pageID,title:pageTitle,browser_title:browserTitle,content:pageContent,status:pageStatus,template_id:templateName,parent_page_id:parentPageID,slug:pageSlug,ishome:isHome,order:pageOrder,desc:description};$.ajax({url:MediaAPI.m_url,type:'post',dataType:"json",data:paras,success:function(ret){MediaAPI.onPageAdded(ret,callback)}});},addPage:function(siteID,pageTitle,pageContent,pageStatus,templateName,parentPageID,pageSlug,pageOrder,isHome,callback){AthenaDialog.showLoading("Adding page");var paras={cmd:'addPage',site_id:siteID,title:pageTitle,content:pageContent,status:pageStatus,template_id:templateName,parent_page_id:parentPageID,slug:pageSlug,ishome:isHome,order:pageOrder};$.ajax({url:MediaAPI.m_url,type:'post',dataType:"json",data:paras,success:function(ret){MediaAPI.onPageAdded(ret,callback)}});},onPageAdded:function(ret,callback){AthenaDialog.clearLoading();if(ret.result=="ok"){callback(ret.data.page);}
else{AthenaDialog.showAjaxError(ret);}},deletePage:function(siteID,pageID,callback){AthenaDialog.showLoading("Deleting page");var paras={cmd:'deletePage',site_id:siteID,page_id:pageID};$.ajax({url:MediaAPI.m_url,dataType:"json",data:paras,success:function(ret){AthenaDialog.clearLoading();if(ret.result=="ok"){callback(ret.data.page_id);}
else{AthenaDialog.showAjaxError(ret);}}});},getFolders:function(siteID,callback){AthenaDialog.showLoading();var paras={cmd:'getFolders',site_id:siteID};$.ajax({url:MediaAPI.m_url,dataType:"json",data:paras,success:function(ret){AthenaDialog.clearLoading();if(ret.result=='ok'){callback(ret.data);}
else{AthenaDialog.showAjaxError(ret);}}});},addFolder:function(siteID,folderName,callback){AthenaDialog.showLoading("Adding folder");if(folderName==undefined){folderName='new folder';}
var paras={cmd:'addFolder',site_id:siteID,folder_name:folderName};$.ajax({url:MediaAPI.m_url,dataType:"json",data:paras,success:function(ret){AthenaDialog.clearLoading();if(ret.result=="ok"){callback(ret.data.name,ret.data.id);}
else{AthenaDialog.showAjaxError(ret);}}});},renameFolder:function(siteID,folderID,newName,callback){var paras={cmd:'renameFolder',site_id:siteID,folder_id:folderID,folder_name:newName};$.ajax({url:MediaAPI.m_url,dataType:"json",data:paras,success:function(ret){if(ret.result=="ok"){callback(ret.data.id,ret.data.name);}
else{AthenaDialog.showAjaxError(ret);}}});},addMediaToFolder:function(siteID,mediaID,folderID,callback){var paras={cmd:'addMediaToFolder',site_id:siteID,folder_id:folderID,media_id:mediaID};$.ajax({url:MediaAPI.m_url,dataType:"json",data:paras,success:function(ret){if(ret.result=="ok"){callback(ret.data.folder_id,ret.data.media_id);}
else{AthenaDialog.showAjaxError(ret);}}});},deleteFolder:function(siteID,folderID,callback){var paras={cmd:'deleteFolder',site_id:siteID,folder_id:folderID};$.ajax({url:MediaAPI.m_url,dataType:"json",data:paras,success:function(ret){if(ret.result=="ok"){callback(ret.data.id);}
else{AthenaDialog.showAjaxError(ret);}}});},getMedia:function(siteID,callback){AthenaDialog.showLoading();var paras={cmd:'getMedia',site_id:siteID};$.ajax({url:MediaAPI.m_url,dataType:"json",success:function(ret){MediaAPI.onGotMedia(ret,callback);},data:paras});},onGotMedia:function(ret,callback){AthenaDialog.clearLoading();if(ret.result=='ok'){if(ret.data=='true'){callback(ret.data);}
else{callback(ret.data);}}
else{AthenaDialog.showAjaxError(ret);}},updateMediaInfo:function(siteID,mediaID,mediaTitle,mediaDesc,mediaTags,callback){var paras={cmd:'saveMediaInfo',site_id:siteID,media_id:mediaID,title:mediaTitle,desc:mediaDesc,tags:mediaTags};$.ajax({url:MediaAPI.m_url,dataType:"json",success:function(ret){MediaAPI.onGotMedia(ret,callback);},data:paras});},deleteMedia:function(siteID,mediaID,callback){AthenaDialog.showLoading("Deleting file");var paras={cmd:'deleteMedia',site_id:siteID,media_id:mediaID};$.ajax({url:MediaAPI.m_url,dataType:"json",success:function(ret){AthenaDialog.clearLoading();if(ret.result=='ok'){callback(ret.data.media_id);}
else{AthenaDialog.showAjaxError(ret);}},data:paras});},removeMediaTag:function(siteID,mediaID,tagStr,callback){var paras={cmd:'removeMediaTag',site_id:siteID,media_id:mediaID,tag:tagStr};$.ajax({url:MediaAPI.m_url,dataType:"json",data:paras,success:function(ret){if(ret.result=="ok"){callback(ret.data.media);}
else{AthenaDialog.showAjaxError(ret);}}});},renameMediaTag:function(siteID,currentTagStr,newTagStr,callback){var paras={cmd:'renameMediaTag',site_id:siteID,tag:currentTagStr,new_tag:newTagStr};$.ajax({url:MediaAPI.m_url,dataType:"json",data:paras,success:function(ret){if(ret.result=="ok"){callback(ret.data.tags);}
else{AthenaDialog.showAjaxError(ret);}}});},deleteMediaTag:function(siteID,tagStr,callback){AthenaDialog.showLoading("Deleting tag");var paras={cmd:'deleteMediaTag',site_id:siteID,tag:tagStr};$.ajax({url:MediaAPI.m_url,dataType:"json",data:paras,success:function(ret){AthenaDialog.clearLoading();if(ret.result=="ok"){callback(ret.data.tags);}
else{AthenaDialog.showAjaxError(ret);}}});},addMediaCSVTags:function(siteID,mediaID,tagsCSV,callback){AthenaDialog.showLoading("Adding tag");var paras={cmd:'addMediaTags',site_id:siteID,media_id:mediaID,csvtags:tagsCSV};$.ajax({url:MediaAPI.m_url,dataType:"json",success:function(ret){AthenaDialog.clearLoading();if(ret.result=='ok'){callback(ret.data.media,ret.data.tags);}
else{AthenaDialog.showAjaxError(ret);}},data:paras});}}

var GalleryAPI={m_url:'/code/php/remoteapi/GalleryAPI.php',init:function(){GalleryAPI.m_url=defines.root_url+GalleryAPI.m_url;},getAll:function(siteID,callback){AthenaDialog.showLoading("Loading gallery data");var paras={cmd:'getAll',site_id:siteID};$.ajax({url:GalleryAPI.m_url,dataType:"json",data:paras,success:function(ret){GalleryAPI.onGotAll(ret,callback);}});},onGotAll:function(ret,callback){AthenaDialog.clearLoading();if(ret.result=='ok'){callback(ret.data.gallery_images,ret.data.gallery_meta);}
else{AthenaDialog.showAjaxError(ret);}},onMoveImage:function(siteID,pageID,imageID,old_slot,new_slot,oldGalleryNo,newGalleryNo,themeParaID,callback){var paras={cmd:'moveImage',site_id:siteID,image_id:imageID,old_slot_no:old_slot,new_slot_no:new_slot,page_id:pageID,old_gallery_no:oldGalleryNo,new_gallery_no:newGalleryNo,theme_para_id:themeParaID};AthenaDialog.showLoading("Moving image",false);jQuery.ajax({url:GalleryAPI.m_url,dataType:"json",data:paras,success:function(ret){GalleryAPI.onGotAll(ret,callback);}});},onAddImage:function(siteID,pageID,imageID,slot,galleryNo,themeParaID,callback){var paras={cmd:'addImage',site_id:siteID,page_id:pageID,image_id:imageID,slot_no:slot,gallery_no:galleryNo,theme_para_id:themeParaID};AthenaDialog.showLoading("Adding image",false);jQuery.ajax({url:GalleryAPI.m_url,dataType:"json",data:paras,success:function(ret){GalleryAPI.onGotAll(ret,callback);}});},onRemoveImage:function(siteID,pageID,imageID,galleryNo,slot,themeParaID,callback){var paras={cmd:'removeImage',site_id:siteID,page_id:pageID,slot_no:slot,image_id:imageID,gallery_no:galleryNo,theme_para_id:themeParaID};jQuery.ajax({url:GalleryAPI.m_url,dataType:"json",data:paras,success:function(ret){GalleryAPI.onImageRemoved(ret,callback);}});},onImageRemoved:function(ret,callback){if(ret.result=="ok"){callback(ret.data.slot_no);}
else{AthenaDialog.showAjaxError(ret);}}}

var BlogAPI={m_url:'/code/php/remoteapi/BlogAPI.php',init:function(){BlogAPI.m_url=defines.root_url+BlogAPI.m_url;},addComment:function(siteID,postID,authorName,authorEmail,postURL,parentCommentID,commentContent,callback){var paras={cmd:'addComment',site_id:siteID,post_id:postID,name:authorName,email:authorEmail,post_url:postURL,content:commentContent,pid:parentCommentID};$.ajax({url:BlogAPI.m_url,dataType:"json",data:paras,success:function(ret){BlogAPI.onCommentAdded(ret,callback);}});},onCommentAdded:function(ret,callback){if(ret.result=='ok'){callback();}
else{AthenaDialog.showAjaxError(ret);}},getComments:function(siteID,postID,callback){AthenaDialog.showLoading("Loading comments");var paras={cmd:'getComments',site_id:siteID,post_id:postID};$.ajax({url:BlogAPI.m_url,dataType:"json",data:paras,success:function(ret){BlogAPI.onGotComments(ret,callback);}});},onGotComments:function(ret,callback){AthenaDialog.clearLoading();if(ret.result=='ok'){callback(ret.data.post_id,ret.data.comments);}
else{AthenaDialog.showAjaxError(ret);}},getSummary:function(siteID,callback){AthenaDialog.showLoading("Loading comments");var paras={cmd:'getSummary',site_id:siteID};$.ajax({url:BlogAPI.m_url,dataType:"json",data:paras,success:function(ret){BlogAPI.onGotSummary(ret,callback);}});},onGotSummary:function(ret,callback){AthenaDialog.clearLoading();if(ret.result=='ok'){var data=new Object();data.comments_approved=ret.data.comments_approved;data.comments_pending=ret.data.comments_pending;data.comments_trash=ret.data.comments_trash;data.comments_spam=ret.data.comments_spam;data.posts_published=ret.data.posts_published;data.posts_private=ret.data.posts_private;data.posts_draft=ret.data.posts_draft;data.categories=ret.data.categories;data.tags=ret.data.tags;data.no_followers=ret.data.no_followers;data.top_followers=ret.data.followers;callback(data);}
else{AthenaDialog.showAjaxError(ret);}}}

var ImageEditDialog={image_id:0,image_index:0,show:function(targetDiv,image_id){var imageList=DataStore.m_mediaList;var imageData=DataStore.getImage(image_id);if(!imageData){AthenaDialog.error('Error, could not find image!');return;}
var thumb_url=imageData.thumb_url;var img_width=imageData.width;var img_height=imageData.height;var image_folder_id=imageData.folder_id;var added_date=imageData.date_added;var img_title=imageData.title;var desc=imageData.description;var alt_text=imageData.tags;var image_url=imageData.file_url;var dHeight=img_height/2+250;var dWidth=img_width/2+50;if(dWidth<500)dWidth=500;if(dHeight<700)dHeight=700;dHeight=$(window).height()*0.9;dWidth=img_width;new_img_height=dHeight-300;new_img_width=new_img_height*img_width/img_height;dWidth=new_img_width;var txt="";txt+="<div id='ApolloImageEditDialog' align='center'>";txt+="<img class='imageDisplay' src='"+image_url+"' width='100%'/>";txt+="<table width='100%' height='100%' cellspacing='3px'>";txt+="   <tr>";txt+="      <td class='titleField'>Title</td>";txt+="      <td class='dataField'><input id='apollo_image_title' type=text value='"+img_title+"'/></td>";txt+="   </tr>";txt+="   <tr>";txt+="      <td class='titleField'>Added</td>";txt+="      <td class='dataField'><input id='' width='100%' type=text value='"+added_date+" (GMT)' disabled/></td>";txt+="   </tr>";txt+="   <tr>";txt+="      <td class='titleField'>Size</td>";txt+="      <td class='dataField'><input id='' width='100%' type=text value='"+img_width+"px by "+img_height+"px' disabled/></td>";txt+="   </tr>";txt+="   <tr>";txt+="      <td class='titleField'>Description</td>";txt+="      <td class='dataField'><textarea id='apollo_image_desc' width='100%'>"+desc+"</textarea></td>";txt+="   </tr>";txt+="   <tr>";txt+="      <td class='titleField'>Tags</td>";txt+="      <td class='dataField'><input id='apollo_image_tags' width='100%' type=text value='"+alt_text+"'/></td>";txt+="   </tr>";txt+="</table>";txt+="</div>";var dialogTitle=img_title;$(targetDiv).dialog('destroy');$(targetDiv).html(txt);$(targetDiv).dialog({modal:true,width:dWidth,height:dHeight,title:dialogTitle,buttons:{Save:function(){ImageEditDialog.onSave(image_id);$(this).dialog('close');},Cancel:function(){$(this).dialog('close');}}});},onSave:function(post_id){var newTitle=$('#apollo_image_title').val();var newDesc=$('#apollo_image_desc').val();var newTags=$('#apollo_image_tags').val();MediaAPI.saveMediaInfo(DataStore.m_siteID,newTitle,newDesc,newTags,ImageEditDialog.onSaved)},onSaved:function(ret,image_id,newTitle,newCaption,newDesc){alert('BACK END TBD!!!');}}

var ImagePickerDialog={folder_id:0,imageSelectCallback:'',targetDiv:'',show:function(targetDiv,imageSelectCallback){ImagePickerDialog.imageSelectCallback=imageSelectCallback;ImagePickerDialog.targetDiv=targetDiv;var imageList=DataStore.m_mediaList;var dialogTitle='Select an image';var minHeight=$(window).height()/2;var txt="";txt+="<div class='ImagePicker'>";txt+="Folder: <select id='ImagePickerFolderSelect' onchange='ImagePickerDialog.onFolderSelected()'>";txt+="<option value='1'>Unassigned</option>";for(var i=0;i<DataStore.m_folderList.length;i++){txt+="<option value='"+DataStore.m_folderList[i].id+"'>"+DataStore.m_folderList[i].name+"</option>";}
txt+="</select>";txt+="<div class='' style='height: 100%; width:100%; margin-top:10px' id='image_selector_content'></div>";txt+="</div>";$(targetDiv).html(txt);$(targetDiv).dialog('destroy');$(targetDiv).dialog({modal:true,width:200+$(window).width()/2,height:130+minHeight,title:dialogTitle});ImagePickerDialog.paintImages();$(targetDiv).disableSelection();},paintImages:function(){var imageList=DataStore.m_mediaList;var d=new Date();var localTime=d.getTime();var localOffset=d.getTimezoneOffset()*60000;var utc_date=new Date(localTime+localOffset);var utc_time=localTime+localOffset;var txt="";for(var i=0;i<imageList.length;i++){var thumb_url=imageList[i].thumb_url;var image_id=imageList[i].id;var title=imageList[i].title;var width=imageList[i].width;var height=imageList[i].height;var image_folder_id=parseInt(imageList[i].folder_id);var added_date=new Date(imageList[i].date_added);var hours_ago=(utc_time-added_date.getTime())/3600000;switch(ImagePickerDialog.folder_id){case ImageSelector.ID_UNASSIGNED:if(image_folder_id==ImageSelector.ID_ALL||image_folder_id==ImageSelector.ID_UNASSIGNED)
txt+=ImagePickerDialog.getImageHTML(image_id,thumb_url,title,width,height);break;case ImageSelector.ID_LAST_1_HOUR:if(hours_ago<=1){txt+=ImagePickerDialog.getImageHTML(image_id,thumb_url,title,width,height);}
break;case ImageSelector.ID_LAST_24_HOURS:if(hours_ago<=24){txt+=ImagePickerDialog.getImageHTML(image_id,thumb_url,title,width,height);}
break;case ImageSelector.ID_LAST_7_DAYS:if(hours_ago<=168){txt+=ImagePickerDialog.getImageHTML(image_id,thumb_url,title,width,height);}
break;case ImageSelector.ID_ALL:txt+=ImagePickerDialog.getImageHTML(image_id,thumb_url,title,width,height);break;case image_folder_id:txt+=ImagePickerDialog.getImageHTML(image_id,thumb_url,title,width,height);break;default:}}
$('#image_selector_content').html(txt);},getImageHTML:function(image_id,thumb_url,title,width,height){var txt="";var titleText=title+" ("+width+"px by "+height+"px)";txt+="<div class='thumbwrapper' align='center' onclick=\"ImagePickerDialog.onSelectImage('"+image_id+"')\">";txt+="   <img id='img+"+image_id+"' src='"+thumb_url+"' class='thumb' width='50px'/>";txt+="   <div class='imageTitle'>"+title+"</div>";txt+="   <div class='imageSize'>("+width+", "+height+")</div>";txt+="</div>";return txt;},onFolderSelected:function(){ImagePickerDialog.folder_id=parseInt($('#ImagePickerFolderSelect').val());ImagePickerDialog.paintImages();},onSelectImage:function(imageID){if(ImagePickerDialog.imageSelectCallback!=''){ImagePickerDialog.imageSelectCallback(imageID);}
$(ImagePickerDialog.targetDiv).dialog('close');}}

var ColorPickerDialog={m_callback:'',m_targetDiv:'',show:function(targetDiv,currentCol,callback){ColorPickerDialog.m_targetDiv=targetDiv;ColorPickerDialog.m_callback=callback;var txt="<div id='apolloSelectColor'></div>";ColorPickerDialog.col=currentCol;$(targetDiv).dialog('destroy');$(targetDiv).html(txt);$(targetDiv).dialog({modal:true,width:385,height:235,resizable:false,title:'Pick a color'});$('#apolloSelectColor').ColorPicker({color:currentCol,flat:true,onSubmit:function(hsb,hex,rgb,el){ColorPickerDialog.onSelectColor(hex);}});},onSelectColor:function(col){if(ColorPickerDialog.m_callback!=''){ColorPickerDialog.m_callback(col);}
$(ColorPickerDialog.m_targetDiv).dialog('close');}}

var WordpressImporter={show:function(){var txt="";txt+="<div id='apolloBlogImporter'>";txt+="    <fieldset>";txt+="        <legend>Progress</legend>";txt+="        <div class='importProgress' id='status'>Status</div>";txt+="        <div id='progressBar'></div>";txt+="    </fieldset>";txt+="    <fieldset>";txt+="        <legend>Select File</legend>";txt+="        <div class='importText'>Import your WordPress eXtended RSS (WXR) file</div><br/>";txt+="        <div id='flashImporter'></div>";txt+="    </fieldset>";txt+="</div>";$('#apollo_dialog').html(txt);$('#apollo_dialog').dialog('destroy');$('#apollo_dialog').dialog({modal:true,width:385,resizable:false,buttons:{"Done":function(){$(this).dialog('close');}},title:'Import a WordPress blog'});$("#progressBar").progressbar({value:0});AthenaDialog.setProgressBarColorMap("#progressBar",0,100,'roygbiv');var flash_url=defines.code_url+"flash/wordpressimporter/WordpressImporter.swf";var flashvars={};var params={bgcolor:"#ffffff",quality:"high",menu:"false",allowScriptAccess:"sameDomain"};var attributes={id:"WordpressImporter",name:"WordpressImporter"};swfobject.embedSWF(flash_url,'flashImporter',"80","22","10.0.0","expressInstall.swf",flashvars,params,attributes);},updateProgress:function(){WordpressImporter.postCt++;var prog=Math.ceil(100*WordpressImporter.postCt/WordpressImporter.noPosts);$("#status").html("Processed item "+WordpressImporter.postCt+" of "+WordpressImporter.noPosts);$("#progressBar").progressbar({value:prog});},postCt:0,comments:'',onPost:function(postJSONString,commentsJSONString){if(postJSONString==""){WordpressImporter.updateProgress();WordpressImporter.getNextPost();return;}
try{var post=$.parseJSON(postJSONString);var comments=false;if(commentsJSONString!=""){comments=$.parseJSON(commentsJSONString);}
var paras={cmd:'importPost',site_id:DataStore.m_siteID,title:unescape(post.title),content:unescape(post.content),status:post.status,comment:post.can_comment?1:0,pubdate:post.date_gmt,csvtags:post.tags,csvcats:post.categories,import_source:'wordpress',source_id:post.id};if(WordpressImporter.nextPostTimeout!=''){clearTimeout(WordpressImporter.nextPostTimeout);}
if(WordpressImporter.postCt<WordpressImporter.noPosts-1){WordpressImporter.nextPostTimeout=setTimeout(WordpressImporter.backupGetNextPost,10000);}
$.ajax({url:MediaAPI.m_url,type:'post',dataType:"json",success:function(ret){WordpressImporter.onPostAdded(ret)},error:function(){alert('error!')},data:paras});WordpressImporter.comments=comments;}
catch(err){Logger.error(err.toString());}},backupGetNextPost:function(){WordpressImporter.getNextPost();if(WordpressImporter.postCt<WordpressImporter.noPosts-1){WordpressImporter.nextPostTimeout=setTimeout(WordpressImporter.backupGetNextPost,10000);}},nextPostTimeout:'',onPostAdded:function(ret){if(ret.result!='ok'){Logger.show();Logger.error("No result!?");return;}
var post_id=ret.data.post_id;WordpressImporter.updateProgress();if(WordpressImporter.comments){if(WordpressImporter.comments.length>0){var paras={cmd:'importComments',site_id:DataStore.m_siteID,pid:post_id,com:$.toJSON(WordpressImporter.comments),ims:'wordpress'};$.ajax({url:MediaAPI.m_url,type:'post',dataType:"json",data:paras});}}
WordpressImporter.getNextPost();},getNextPost:function(){if(navigator.appName.indexOf('Microsoft')!=-1){window.WordpressImporter.getNextPost();}
else{window.document.WordpressImporter.getNextPost();}},noPosts:0,onMeta:function(noItems,noPosts,tags,categories){WordpressImporter.noPosts=noItems;var paras={cmd:'addTags',site_id:DataStore.m_siteID,csvtags:tags};$.ajax({url:MediaAPI.m_url,dataType:"json",data:paras});var paras={cmd:'addCategories',site_id:DataStore.m_siteID,csvcats:categories};$.ajax({url:MediaAPI.m_url,dataType:"json",data:paras});WordpressImporter.getNextPost();},onFileSelected:function(name,size,type){WordpressImporter.onMessage(name+" "+size+"kb "+type);},onProgress:function(bytes,total){var prog=Math.ceil(100*bytes/total);if(bytes<total){$("#status").html("Reading file...");}
else{$("#status").html("Starting processing...");}},onLoaded:function(content){$('#fileContents').html(content);},onComplete:function(){$('#status').html("<span style='color:green'>Complete! Refresh the browser to see the changes.</span>");},onMessage:function(msg){},onError:function(msg){$('#status').html("<span style='color:red'>"+msg+"</span>");Logger.error(msg);}}

var LiveJournalImporter={show:function(){var txt="";txt+="<div id='apolloBlogImporter'>";txt+="    <fieldset>";txt+="        <legend>Progress</legend>";txt+="        <div class='importProgress' id='status' align='center'>Enter your username/password and hit start to begin</div>";txt+="        <div id='progressBar'></div>";txt+="    </fieldset>";txt+="    <fieldset>";txt+="        <legend>Controls</legend>";txt+="        <table border='0' width='100%'>";txt+="            <tr>";txt+="                <td><span class='label' id=''>Livejournal Username</span></td>";txt+="                <td><input type='text' id='ljuser' name='ljuser' value=''></td>";txt+="            </tr>";txt+="            <tr>";txt+="                <td><span class='label' id=''>Livejournal Password</span></td>";txt+="                <td><input type='password' id='ljpass' name='ljpass' value=''></td>";txt+="            </tr>";txt+="        </table>";txt+="    </fieldset>";txt+="</div>";$('#apollo_dialog').html(txt);$('#apollo_dialog').dialog('destroy');$('#apollo_dialog').dialog({modal:true,width:385,resizable:false,buttons:{"Start":LiveJournalImporter.startImport,"Done":function(){$(this).dialog('close');}},title:'Import your LiveJournal blog'});},startImport:function(){if($('#ljuser').val()==""||$('#ljpass').val()==""){LiveJournalImporter.onError("You must enter a valid username and password!");return;}
LiveJournalImporter.onMessage("Importing....");$('#progressBar').html("<div align='center'><img src='"+defines.root_url+"images/spinner.gif'/></div>");var paras={cmd:'importLJ',site_id:DataStore.m_siteID,us:$('#ljuser').val(),ps:$('#ljpass').val()};$.ajax({url:MediaAPI.m_url,type:'post',dataType:"json",success:function(ret){LiveJournalImporter.onComplete(ret)},data:paras});},onComplete:function(ret){$('#progressBar').html("");if(ret.result=='ok'){$('#status').html("<span style='color:green'>Import completed! Refresh the browser to see the changes.</span>");}
else{$('#status').html("<span style='color:red'>"+ret.data+"</span>");}},onMessage:function(msg){$('#status').html("<span style='color:blue'>"+msg+"</span>");},onError:function(msg){$('#status').html("<span style='color:red'>"+msg+"</span>");}}

var BloggerImporter={m_username:'',m_blogURL:'',m_noPosts:0,m_postCt:0,show:function(){var txt="";txt+="<div id='apolloBlogImporter'>";txt+="    <fieldset>";txt+="        <legend>Progress</legend>";txt+="        <div class='importProgress' id='status' align='center'></div>";txt+="        <div id='progressBar'></div>";txt+="    </fieldset>";txt+="    <fieldset>";txt+="        <legend>Controls</legend>";txt+="        <table border='0' width='100%'>";txt+="            <tr>";txt+="                <td><span class='label' id=''>Blog Name</span></td>";txt+="                <td><input type='text' id='bloggerUser' name='bloggerUser' value=''></td>";txt+="            </tr>";txt+="        </table>";txt+="    </fieldset>";txt+="    <fieldset>";txt+="        <legend>Help</legend>";txt+="            <h3>What is my blog name?</h3>";txt+="            <p>Your blog name is the sub-domain of your blog, so for example if your blog is";txt+="               <b>apollosites.blogspot.com</b> then your blog name would be <b><i>apollosites</i></b></p>"
txt+="    </fieldset>";txt+="</div>";$('#apollo_dialog').html(txt);$('#apollo_dialog').dialog('destroy');$('#apollo_dialog').dialog({modal:true,width:385,resizable:false,buttons:{"Start":BloggerImporter.startImport,"Done":function(){$(this).dialog('close');}},title:'Import your Blogger blog'});$("#progressBar").progressbar({value:0});AthenaDialog.setProgressBarColorMap("#progressBar",0,100,'roygbiv');},startImport:function(){BloggerImporter.m_postCt=0;$("#progressBar").progressbar({value:0});BloggerImporter.m_username=$('#bloggerUser').val();if(BloggerImporter.m_username==""){BloggerImporter.onError("You must enter a valid username!");return;}
BloggerImporter.onMessage("Importing....");BloggerImporter.getPosts();},getPosts:function(){var feedURL="http://"+BloggerImporter.m_username+".blogspot.com/feeds/posts/default";var paras={alt:'json-in-script'};$.ajax({url:feedURL,type:'get',dataType:"jsonp",success:BloggerImporter.onGotPosts,data:paras});},m_posts:false,onGotPosts:function(data){var feed=data.feed;var entries=feed.entry||[];BloggerImporter.m_posts=new Array();BloggerImporter.m_noPosts=entries.length;for(var i=0;i<entries.length;++i){var post=new Object();var pubDate=new Date(entries[i].published.$t);var updateDate=new Date(entries[i].updated.$t);var post_id=0;var idString=entries[i].id.$t;var m=idString.match(/blog-([0-9]+).*post-([0-9]+)/);blog_id=m[1];post.id=m[2];post.title=entries[i].title.$t;post.content=entries[i].content.$t;post.date_gmt=pubDate.toString();post.can_comment=1;post.tags='';post.categories='';post.status='Published';if(post.category!=undefined){for(var cat=0;cat<post.category.length;cat++){if(post.categories!=""){post.categories+=",";}
post.categories+=post.category[cat].term;}}
BloggerImporter.m_posts.push(post);}
BloggerImporter.processNextPost();},processNextPost:function(){if(BloggerImporter.m_postCt>=BloggerImporter.m_noPosts){$('#status').html("<span style='color:green'>Import completed! Refresh the browser to see the changes.</span>");$("#progressBar").progressbar({value:100});return;}
var post=BloggerImporter.m_posts[BloggerImporter.m_postCt];BloggerImporter.m_postCt++;var paras={cmd:'importPost',site_id:DataStore.m_siteID,title:unescape(post.title),content:unescape(post.content),status:post.status,comment:post.can_comment,pubdate:post.date_gmt,csvtags:post.tags,csvcats:post.categories,import_source:'blogger',source_id:post.id};$.ajax({url:MediaAPI.m_url,type:'post',dataType:"json",success:function(ret){BloggerImporter.onPostAdded(ret)},data:paras});},m_bloggerPostID:0,m_apolloPostID:0,onPostAdded:function(ret){if(ret.result!='ok'){return;}
BloggerImporter.m_apolloPostID=ret.data.post_id;BloggerImporter.m_bloggerPostID=ret.data.source_post_id;BloggerImporter.getComments(BloggerImporter.m_bloggerPostID);},getComments:function(bloggerPostID){var feedURL="http://"+BloggerImporter.m_username+".blogspot.com/feeds/"+bloggerPostID+"/comments/default";Logger.debug(feedURL);var paras={alt:'json-in-script'};$.ajax({url:feedURL,type:'get',dataType:"jsonp",success:BloggerImporter.onGotCommentData,data:paras});},onGotCommentData:function(data){var feed=data.feed;var entries=feed.entry||[];var commentList=new Array();for(var i=0;i<entries.length;++i){var entryObj=new Object();var pubDate=new Date(entries[i].published.$t);var updateDate=new Date(entries[i].updated.$t);var idString=entries[i].id.$t;var m=idString.match(/blog-([0-9]+).*post-([0-9]+)/);blog_id=m[1];var comment_id=m[2];entryObj.id=comment_id;entryObj.post_id=BloggerImporter.m_bloggerPostID;entryObj.parent_id=0;entryObj.title=unescape(entries[i].title.$t);entryObj.content=unescape(entries[i].content.$t);entryObj.author=entries[i].author[0].name.$t;entryObj.author_email=entries[i].author[0].email.$t;if(entries[i].author[0].uri.$t!=undefined){entryObj.author_url=entries[i].author[0].uri.$t;}
else{entryObj.author_url="";}
entryObj.author_ip='';entryObj.date_gmt=pubDate.toString();entryObj.approved=1;commentList.push(entryObj);}
if(commentList.length>0){var paras={cmd:'importComments',site_id:DataStore.m_siteID,pid:BloggerImporter.m_apolloPostID,com:$.toJSON(commentList),ims:'blogger'};$.ajax({url:MediaAPI.m_url,type:'post',dataType:"json",data:paras});}
BloggerImporter.updateProgress();BloggerImporter.processNextPost();},updateProgress:function(){var prog=Math.ceil(100*BloggerImporter.m_postCt/BloggerImporter.m_noPosts);$("#status").html("Processed item "+BloggerImporter.m_postCt+" of "+BloggerImporter.m_noPosts);$("#progressBar").progressbar({value:prog});},onMessage:function(msg){$('#status').html("<span style='color:blue'>"+msg+"</span>");},onError:function(msg){$('#status').html("<span style='color:red'>"+msg+"</span>");}}

var CommentsEditDialog={show:function(){var txt="";txt+="<div id='apolloCommentEditor'>";txt+="    <div id='commentList'></div>"
txt+="</div>";$('#apollo_dialog').html(txt);$('#apollo_dialog').dialog('destroy');$('#apollo_dialog').dialog({modal:true,width:550,height:$(window).height()-100,resizable:false,buttons:{Ok:function(){$(this).dialog('close');}},title:'Edit Post Comments'});BlogAPI.getComments(DataStore.m_siteID,DataStore.m_currentPostID,CommentsEditDialog.onGotComments)},unapproveComment:function(comment_id){MediaAPI.updateCommentStatus(DataStore.m_siteID,comment_id,'Pending',CommentsEditDialog.onUpdate);},approveComment:function(comment_id){MediaAPI.updateCommentStatus(DataStore.m_siteID,comment_id,'Approved',CommentsEditDialog.onUpdate);},deleteComment:function(comment_id){MediaAPI.updateCommentStatus(DataStore.m_siteID,comment_id,'Trash',CommentsEditDialog.onUpdate);},undeleteComment:function(comment_id){MediaAPI.updateCommentStatus(DataStore.m_siteID,comment_id,'Pending',CommentsEditDialog.onUpdate);},onUpdate:function(commentID,newStatus){CommentsEditDialog.show();},m_comments:'',onGotComments:function(postID,comments){if(!comments||comments==undefined){$('commentList').html('no comments');return;}
CommentsEditDialog.m_comments=comments;CommentsEditDialog.paintComments();},paintComments:function(){comments=CommentsEditDialog.m_comments;var noPending=0;var noTrashed=0;var noSpam=0;var noApproved=0;for(var i=0;i<comments.length;i++){switch(comments[i].status){case'Pending':noPending++;break;case'Trash':noTrashed++;break;case'Spam':noSpam++;break;case'Approved':noApproved++;break;}}
var txt="";txt+="<h3 class='commentSummary'>"+noApproved+" comments approved, "+noPending+" awaiting approval</h3>";if(noPending!=0){txt+="<h3>Comments Pending Approval</h3>";for(var i=0;i<comments.length;i++){if(comments[i].status=='Pending'){txt+=CommentsEditDialog.getCommentHTML(comments[i]);}}}
if(noApproved!=0){txt+="<h3>Approved Comments</h3>";for(var i=0;i<comments.length;i++){if(comments[i].status=='Approved'){txt+=CommentsEditDialog.getCommentHTML(comments[i]);}}}
if(noTrashed!=0){txt+="<h3>Deleted</h3>";for(var i=0;i<comments.length;i++){if(comments[i].status=='Trash'){txt+=CommentsEditDialog.getCommentHTML(comments[i]);}}}
$('#commentList').html(txt);},getCommentHTML:function(commentObj){var txt="";var id=commentObj.id;var dt=new Date(commentObj.created);var dateStr=dt.toLocaleFormat("%I:%M%p, %a, %b %e, %Y");var classStr="";switch(commentObj.status){case'Pending':classStr="pending_comment";break;case'Trash':classStr="trashed_comment";break;case'Spam':classStr="spam_comment";break;case'Approved':classStr="approved_comment";break;}
txt+="<div class='commentWrapper "+classStr+"'>";txt+="    <div class='commentTitle'>";txt+="        By <span class='commentName'>"+commentObj.name+"</span> on <span class='commentDate'>"+dateStr+"</span>";if(commentObj.status=='Trash'){txt+="    <a href='#' class='commentEdit' onclick=\"CommentsEditDialog.undeleteComment("+id+")\">undelete</a>";}
else{txt+="    <a href='#' class='commentEdit' onclick=\"CommentsEditDialog.deleteComment("+id+")\">delete</a>";}
if(commentObj.status=='Pending'){txt+="    <a href='#' class='commentEdit' onclick=\"CommentsEditDialog.approveComment("+id+")\">approve</a>";}
else if(commentObj.status=='Approved'){txt+="    <a href='#' class='commentEdit' onclick=\"CommentsEditDialog.unapproveComment("+id+")\">unapprove</a>";}
txt+="    </div>";txt+="    <div class='commentContents'>"+commentObj.content+"</div>";txt+="</div>";return txt;}}

var AccountDialog={show:function(){var txt="";txt+="<div id='apolloAccountSettings'>";txt+="    <div id='commentList'></div>"
txt+="</div>";$('#apollo_dialog').html(txt);$('#apollo_dialog').dialog('destroy');$('#apollo_dialog').dialog({modal:false,width:600,height:500,resizable:false,buttons:{Ok:function(){$(this).dialog('close');}},title:'Your Account Settings'});}}

var FolderSidebarFrame={ID_ALL:0,ID_UNASSIGNED:1,ID_LAST_24_HOURS:2,ID_LAST_7_DAYS:3,ID_LAST_1_HOUR:4,m_foldersPerPage:25,m_currentPage:0,m_numberPages:0,m_noSystemFolders:2,paint:function(targetDiv){var txt="";txt+="<div onclick=\"SidebarFrame.showTags()\" id='switch_to_tag_view' class='folder droppable_folder' title='' class='apollo_folder folder_with_menu'><img class='folder_filter_icon' src='images/tag_icon_blue_24x24.png'><span class='folder_name'>Switch to tag view</span></div>";txt+="<div id='apollo_folder_list'></div>";txt+="<div id='folderPageControls' class='sidebar_page_controls'>";txt+="<table border='0'>";txt+="    <tr>";txt+="        <td width='33%' align='left'><span class='more_posts_link' id='prev_posts_link' style='padding-left:15px' onclick='FolderSidebarFrame.showPrevPage()' title='Display previous page'>&laquo; prev</span></td>";txt+="        <td width='33%' align='center'><span class='more_posts_pages' id='folders_sideframe_page_no' style=''>1 of 2</span></td>";txt+="        <td width='33%' align='right'><span class='more_posts_link' id='next_posts_link' style='padding-right:15px' onclick='FolderSidebarFrame.showNextPage()' title='Display next page'>next &raquo;</span></td>";txt+="    </tr>";txt+="</table>";txt+="</div>";txt+="<ul id='folderMenu' class='rightClickMenu'>";txt+=" <li class='edit'><a href='#edit'>Rename</a></li>";txt+=" <li class='delete'><a href='#delete'>Delete</a></li>";txt+=" <li class='quit separator'><a href='#quit'>Cancel</a></li>";txt+="</ul>";$(targetDiv).html(txt);var pos=$(targetDiv).position();var offset=pos.top+30;var lineht=30;var h=$('.ViewFrame').height()-offset-$('#folderPageControls').height();FolderSidebarFrame.m_foldersPerPage=Math.floor(h/lineht);FolderSidebarFrame.m_numberPages=Math.ceil(DataStore.m_folderList.length/FolderSidebarFrame.m_foldersPerPage);if(FolderSidebarFrame.m_numberPages==1){$('#folderPageControls').hide();}
FolderSidebarFrame.paintFolders();$('#apollo_folder_list').height(h);$(targetDiv).disableSelection();$(targetDiv).noContext();},paintFolders:function(){var folderList=DataStore.m_folderList;var start_i=FolderSidebarFrame.m_currentPage*FolderSidebarFrame.m_foldersPerPage;var end_i=Math.min(folderList.length,start_i+FolderSidebarFrame.m_foldersPerPage);$('#folders_sideframe_page_no').html((FolderSidebarFrame.m_currentPage+1)+" of "+FolderSidebarFrame.m_numberPages);var txt="";if(FolderSidebarFrame.m_currentPage==0){var help_text="";var name="";for(var i=0;i<FolderSidebarFrame.m_noSystemFolders;i++){switch(i){case 0:help_text="Select to display all of your images";break;case 1:help_text="Select to display all unassigned files (files that have not been added to a folder";break;case 2:help_text="Select to display all files uploaded in the last hour";break;case 3:help_text="Select to display all files uploaded in the last 24 hours";break;case 4:help_text="Select to display all files uploaded in the last 7 days";break;}
switch(i){case 0:name="Show All";break;case 1:name="Unassigned Files";break;case 2:name="Show Last Hour";break;case 3:name="Show Last 24 Hours";break;case 4:name="Show Last 7 Days";break;}
if(DataStore.m_currentFolderID==i){txt+="<div onclick=\"FolderSidebarFrame.onSelectFolder("+i+")\" class='folder_filter' id='folder_0' title='"+help_text+"'><img class='folder_fav_icon' src='images/folder_favorites.png'><span class='folder_fav_name selected'>"+name+"</span></div>";}
else{txt+="<div onclick=\"FolderSidebarFrame.onSelectFolder("+i+")\" class='folder_filter' id='folder_0' title='"+help_text+"'><img class='folder_fav_icon' src='images/folder_favorites.png'><span class='folder_fav_name'>"+name+"</span></div>";}}
start_i+=FolderSidebarFrame.m_noSystemFolders;}
for(var i=start_i;i<end_i;i++){var folder_name=folderList[i].name;var folder_id=folderList[i].id;if(folder_id==DataStore.m_currentFolderID){txt+="<div onclick=\"FolderSidebarFrame.onSelectFolder('"+folder_id+"')\" class='folder droppable_folder' id='folder_"+folder_id+"' title='' class='apollo_folder folder_with_menu'><img class='folder_filter_icon' src='images/folder_grey.png'><span class='folder_name selected'>"+folder_name+"</span></div>";}
else{txt+="<div onclick=\"FolderSidebarFrame.onSelectFolder('"+folder_id+"')\" class='folder droppable_folder' id='folder_"+folder_id+"' title='' class='apollo_folder folder_with_menu'><img class='folder_filter_icon' src='images/folder_icon.png'><span class='folder_name'>"+folder_name+"</span></div>";}}
$('#apollo_folder_list').html(txt);$(".folder").rightClick(function(e){FolderSidebarFrame.onRightClickFolder(e,this);});$('.droppable_folder').droppable({drop:FolderSidebarFrame.onAddToFolder,over:function(ev,ui){$(this).addClass('folder_name_hover');},out:function(ev,ui){$(this).removeClass('folder_name_hover');}});$("#apollo_folder_list").disableSelection();},showNextPage:function(){$('#prev_posts_link').show();if(FolderSidebarFrame.m_currentPage<FolderSidebarFrame.m_numberPages-1){FolderSidebarFrame.m_currentPage+=1;}
if(FolderSidebarFrame.m_currentPage==FolderSidebarFrame.m_numberPages-1){$('#next_posts_link').hide();}
FolderSidebarFrame.paintFolders();},showPrevPage:function(){$('#next_posts_link').show();if(FolderSidebarFrame.m_currentPage>0){FolderSidebarFrame.m_currentPage-=1;}
if(FolderSidebarFrame.m_currentPage==0){$('#prev_posts_link').hide();}
FolderSidebarFrame.paintFolders();},onRightClickFolder:function(e,obj){e.stopPropagation();var x=e.pageX;var y=e.pageY;$('#folderMenu').css('top',y);$('#folderMenu').css('left',x);$('#folderMenu').show();$('#folderMenu .edit').unbind('click');$('#folderMenu .delete').unbind('click');$('#folderMenu .quit').unbind('click');$('#folderMenu .edit').click(function(){FolderSidebarFrame.onMenuItem('rename_folder',obj)});$('#folderMenu .delete').click(function(){FolderSidebarFrame.onMenuItem('delete_folder',obj)});$('#folderMenu .quit').click(function(){FolderSidebarFrame.onMenuItem('quit',obj)});},onAddToFolder:function(event,ui){var imgID=parseInt($(ui.draggable).attr('id').substring(4));var folderID=parseInt($(this).attr('id').substring(7));if(folderID==FolderSidebarFrame.ID_UNASSIGNED||folderID>9){MediaAPI.addMediaToFolder(DataStore.m_siteID,imgID,folderID,FolderSidebarFrame.onAddedToFolder)}
$(this).removeClass('folder_name_hover');},onAddedToFolder:function(folderID,mediaID){for(var i=0;i<DataStore.m_mediaList.length;i++){if(DataStore.m_mediaList[i].id==mediaID){DataStore.m_mediaList[i].folder_id=folderID;break;}}
FilesFrame.repaint();},onMenuItem:function(item,selectedElement){$('#imageMenu').hide();$('#folderMenu').hide();var divID=$(selectedElement).attr('id');var name=$('#'+divID+' .folder_name').html();var folder_id=parseInt(divID.substr(7));if(item=='rename_folder'){FolderSidebarFrame.makeFolderNameEditable(folder_id);}
else if(item=='delete_folder'){AthenaDialog.confirm("Are you sure you want to delete this folder? This can not be undone.",function(){FolderSidebarFrame.deleteFolder(folder_id);});}},makeFolderNameEditable:function(folder_id){var divID='#folder_'+folder_id;var name=$(divID+' .folder_name').html();$(divID).attr('onclick','');$(divID+' .folder_name').html("<input id='folder_name_edit' style='width:100px' type='text' value='"+name+"' onblur='FolderSidebarFrame.paintFolders()'/>");$("#folder_name_edit").keypress(function(e){if((e.which&&e.which==13)||(e.keyCode&&e.keyCode==13)){FolderSidebarFrame.renameFolder(folder_id,$("#folder_name_edit").val());}});$("#folder_name_edit").focus();},onSelectFolder:function(folder_id){DataStore.m_currentFolderID=parseInt(folder_id);FolderSidebarFrame.paintFolders();switch(ssMain.view){case ssMain.VIEW_GALLERIES:GalleriesFrame.repaint();break;case ssMain.VIEW_FILES:FilesFrame.onSelectFolder();break;}},deleteFolder:function(folderId){MediaAPI.deleteFolder(DataStore.m_siteID,folderId,FolderSidebarFrame.onFolderDeleted);},onFolderDeleted:function(folder_id){var temp=new Array();for(var i=0;i<DataStore.m_folderList.length;i++){if(DataStore.m_folderList[i].id!=folder_id){temp.push(DataStore.m_folderList[i]);}}
DataStore.m_folderList=temp;FolderSidebarFrame.paintFolders()},addFolder:function(){MediaAPI.addFolder(DataStore.m_siteID,'new folder',FolderSidebarFrame.onAddedFolder);},onAddedFolder:function(folderName,folderID){var temp=new Object();temp.id=folderID;temp.name=folderName;DataStore.m_folderList.push(temp);FolderSidebarFrame.paintFolders()
FolderSidebarFrame.makeFolderNameEditable(folderID);},getFolderName:function(folder_id){if(folder_id==FolderSidebarFrame.ID_UNASSIGNED){return"Unassigned";}
for(var i=0;i<DataStore.m_folderList.length;i++){if(DataStore.m_folderList[i].id==folder_id){return DataStore.m_folderList[i].name;}}
return"? ("+folder_id+")";},renameFolder:function(folderId,folderName){MediaAPI.renameFolder(DataStore.m_siteID,folderId,folderName,FolderSidebarFrame.onFolderRenamed);},onFolderRenamed:function(folderId,folderName){for(var i=0;i<DataStore.m_folderList.length;i++){if(DataStore.m_folderList[i].id==folderId){DataStore.m_folderList[i].name=folderName;break;}}
FolderSidebarFrame.paintFolders()}}

var TagsSidebarFrame={m_tagsPerPage:25,m_currentPage:0,m_numberPages:0,paint:function(targetDiv){var txt="";txt+="<div onclick=\"SidebarFrame.showFolders()\" id='switch_to_folder_view' class='folder' title='' class='apollo_tag tag_with_menu'><img class='folder_icon' src='images/folder_icon.png'><span class='switch_to_folder_view_name'>Switch to folder view</span></div>";txt+="<div id='apollo_tag_list'></div>";txt+="<div id='tagPageControls' class='sidebar_page_controls'>";txt+="<table border='0'>";txt+="    <tr>";txt+="        <td width='33%' align='left'><span class='more_posts_link' id='prev_tags_page_link' style='padding-left:15px' onclick='TagsSidebarFrame.showPrevPage()' title='Display previous page'>&laquo; prev</span></td>";txt+="        <td width='33%' align='center'><span class='more_posts_pages' id='tags_sideframe_page_no' style=''>1 of 2</span></td>";txt+="        <td width='33%' align='right'><span class='more_posts_link' id='next_tags_page_link' style='padding-right:15px' onclick='TagsSidebarFrame.showNextPage()' title='Display next page'>next &raquo;</span></td>";txt+="    </tr>";txt+="</table>";txt+="</div>";txt+="<ul id='tagMenu' class='rightClickMenu'>";txt+=" <li class='edit'><a href='#edit'>Rename</a></li>";txt+=" <li class='delete'><a href='#delete'>Delete</a></li>";txt+=" <li class='quit separator'><a href='#quit'>Cancel</a></li>";txt+="</ul>";$(targetDiv).html(txt);var pos=$(targetDiv).position();var offset=pos.top+30;var lineht=23;var h=$('.ViewFrame').height()-offset-$('#tagPageControls').height();TagsSidebarFrame.m_tagsPerPage=Math.floor(h/lineht);TagsSidebarFrame.m_numberPages=Math.ceil(DataStore.m_mediaTags.length/TagsSidebarFrame.m_tagsPerPage);if(TagsSidebarFrame.m_numberPages==1){$('#tagPageControls').hide();}
TagsSidebarFrame.paintTags();$('#apollo_tag_list').height(h);$(targetDiv).disableSelection();$(targetDiv).noContext();},paintTags:function(){var tagList=DataStore.m_mediaTags;if(tagList==undefined||tagList==null){$("#apollo_tag_list").html("");}
var start_i=TagsSidebarFrame.m_currentPage*TagsSidebarFrame.m_tagsPerPage;var end_i=Math.min(tagList.length,start_i+TagsSidebarFrame.m_tagsPerPage);$('#tags_sideframe_page_no').html((TagsSidebarFrame.m_currentPage+1)+" of "+TagsSidebarFrame.m_numberPages);var txt="";for(var i=start_i;i<end_i;i++){var tag=tagList[i];if(tag==DataStore.m_currentTag){txt+="<div onclick=\"TagsSidebarFrame.onSelectTag('"+tag+"')\" class='tag droppable_tag' id='tag_"+tag+"' title='' class='apollo_tag tag_with_menu'><img class='tag_icon' src='images/tag_icon_blue.png'><span class='tag_name selected'>"+tag+"</span></div>";}
else{txt+="<div onclick=\"TagsSidebarFrame.onSelectTag('"+tag+"')\" class='tag droppable_tag' id='tag_"+tag+"' title='' class='apollo_tag tag_with_menu'><img class='tag_icon' src='images/tag_icon_blue.png'><span class='tag_name'>"+tag+"</span></div>";}}
$('#apollo_tag_list').html(txt);$(".tag").rightClick(function(e){TagsSidebarFrame.onRightClickTag(e,this);});$('.droppable_tag').droppable({drop:TagsSidebarFrame.onAddToTag,over:function(ev,ui){$(this).addClass('tag_name_hover');},out:function(ev,ui){$(this).removeClass('tag_name_hover');}});$("#apollo_tag_list").disableSelection();},showNextPage:function(){$('#prev_tags_page_link').show();if(TagsSidebarFrame.m_currentPage<TagsSidebarFrame.m_numberPages-1){TagsSidebarFrame.m_currentPage+=1;}
if(TagsSidebarFrame.m_currentPage==TagsSidebarFrame.m_numberPages-1){$('#next_tags_page_link').hide();}
TagsSidebarFrame.paintTags();},showPrevPage:function(){$('#next_tags_page_link').show();if(TagsSidebarFrame.m_currentPage>0){TagsSidebarFrame.m_currentPage-=1;}
if(TagsSidebarFrame.m_currentPage==0){$('#prev_tags_page_link').hide();}
TagsSidebarFrame.paintTags();},onRightClickTag:function(e,obj){e.stopPropagation();var x=e.pageX;var y=e.pageY;$('#tagMenu').css('top',y);$('#tagMenu').css('left',x);$('#tagMenu').show();$('#tagMenu .edit').unbind('click');$('#tagMenu .delete').unbind('click');$('#tagMenu .quit').unbind('click');$('#tagMenu .edit').click(function(){TagsSidebarFrame.onMenuItem('rename_tag',obj)});$('#tagMenu .delete').click(function(){TagsSidebarFrame.onMenuItem('delete_tag',obj)});$('#tagMenu .quit').click(function(){TagsSidebarFrame.onMenuItem('quit',obj)});},onAddToTag:function(event,ui){var imgID=parseInt($(ui.draggable).attr('id').substring(4));var tag=$(this).attr('id').substring(4);MediaAPI.addMediaCSVTags(DataStore.m_siteID,imgID,tag,TagsSidebarFrame.onAddedToTag);},onAddedToTag:function(mediaObj,tags){DataStore.updateMedia(mediaObj);DataStore.m_mediaTags=tags;TagsSidebarFrame.onSelectTag(DataStore.m_currentTag);},onMenuItem:function(item,selectedElement){$('#tagMenu').hide();var divID=$(selectedElement).attr('id');var name=$('#'+divID+' .tag_name').html();var tag=divID.substr(4);if(item=='rename_tag'){TagsSidebarFrame.makeTagNameEditable(tag);}
else if(item=='delete_tag'){AthenaDialog.confirm("Are you sure you want to delete this tag? This will not delete any of your images, just this tag",function(){TagsSidebarFrame.deleteTag(tag);});}},makeTagNameEditable:function(tag){var divID='#tag_'+tag;var name=$(divID+' .tag_name').html();$(divID).attr('onclick','');$(divID+' .tag_name').html("<input id='tag_name_edit' style='width:100px' type='text' value='"+name+"' onblur='TagsSidebarFrame.paintTags()'/>");$("#tag_name_edit").keypress(function(e){if((e.which&&e.which==13)||(e.keyCode&&e.keyCode==13)){TagsSidebarFrame.renameTag(tag,$("#tag_name_edit").val());}});$("#tag_name_edit").focus();},onSelectTag:function(tag){DataStore.m_currentTag=tag;TagsSidebarFrame.paintTags();switch(ssMain.view){case ssMain.VIEW_GALLERIES:GalleriesFrame.repaint();break;case ssMain.VIEW_FILES:FilesFrame.onSelectFolder();break;}},deleteTag:function(tag){MediaAPI.deleteMediaTag(DataStore.m_siteID,tag,TagsSidebarFrame.onTagDeleted)},onTagDeleted:function(newTagList){DataStore.m_mediaTags=newTagList;if(DataStore.m_mediaTag!=undefined&&DataStore.m_mediaTag!=null&&DataStore.m_mediaTag.length>0){DataStore.m_currentTag=DataStore.m_mediaTags[0];TagsSidebarFrame.onSelectTag(DataStore.m_currentTag);}
else{TagsSidebarFrame.onSelectTag('');}},renameTag:function(oldTagName,newTagName){for(var i=0;i<DataStore.m_mediaTags.length;i++){if(DataStore.m_mediaTags[i]==newTagName){AthenaDialog.alert("Sorry, you already have a tag with that name!");return;}}
TagsSidebarFrame.m_newTag=newTagName;MediaAPI.renameMediaTag(DataStore.m_siteID,oldTagName,newTagName,TagsSidebarFrame.onTagRenamed);},onTagRenamed:function(tags){DataStore.m_mediaTags=tags;TagsSidebarFrame.onSelectTag(TagsSidebarFrame.m_newTag);}}

var PagesSidebarFrame={m_targetDiv:'',m_tagsPerPage:25,m_currentPage:0,m_numberPages:0,paint:function(targetDiv){PagesSidebarFrame.m_targetDiv=targetDiv;var txt="";txt+="<div id='apollo_page_list'></div>";txt+="<div id='pagesSidebarControls' class='sidebar_page_controls'>";txt+="<table border='0'>";txt+="    <tr>";txt+="        <td width='33%' align='left'><span class='more_posts_link' id='prev_pages_link' style='padding-left:15px' onclick='PagesSidebarFrame.showPrevPage()' title='Display previous page'>&laquo; prev</span></td>";txt+="        <td width='33%' align='center'><span class='more_posts_pages' id='pages_sideframe_page_no' style=''>1 of 2</span></td>";txt+="        <td width='33%' align='right'><span class='more_posts_link' id='next_pages_link' style='padding-right:15px' onclick='PagesSidebarFrame.showNextPage()' title='Display next page'>next &raquo;</span></td>";txt+="    </tr>";txt+="</table>";txt+="</div>";var pos=$(targetDiv).position();var offset=pos.top;var lineht=25;var h=$('.ViewFrame').height()-offset-$('#pagesSidebarControls').height();PagesSidebarFrame.m_tagsPerPage=Math.floor(h/lineht);PagesSidebarFrame.m_numberPages=Math.ceil(DataStore.m_pageList.length/PagesSidebarFrame.m_tagsPerPage);if(PagesSidebarFrame.m_numberPages==1){$('#pagesSidebarControls').hide();}
$(targetDiv).html(txt);PagesSidebarFrame.paintPages();$('#apollo_page_list').height(h);$(targetDiv).disableSelection();$(targetDiv).noContext();},repaint:function(){PagesSidebarFrame.paint(PagesSidebarFrame.m_targetDiv);},m_pageNodes:'',paintPages:function(){var pageList=DataStore.m_pageList;var start_i=PagesSidebarFrame.m_currentPage*PagesSidebarFrame.m_tagsPerPage;var end_i=Math.min(pageList.length,start_i+PagesSidebarFrame.m_tagsPerPage);$('#pages_sideframe_page_no').html((PagesSidebarFrame.m_currentPage+1)+" of "+PagesSidebarFrame.m_numberPages);var pageNodes=new Array();for(var i=0;i<pageList.length;i++){if(PagesSidebarFrame.m_tagsPerPage&&pageList[i].parent_page_id==0){pageNodes.push(PagesSidebarFrame.getPageHtml(pageList[i].id,pageList[i].title,pageList[i].status,0));for(var k=0;k<pageList.length;k++){if(pageList[k].parent_page_id==pageList[i].id){pageNodes.push(PagesSidebarFrame.getPageHtml(pageList[k].id,pageList[k].title,pageList[k].status,1));for(var m=0;m<pageList.length;m++){if(pageList[m].parent_page_id==pageList[k].id){pageNodes.push(PagesSidebarFrame.getPageHtml(pageList[m].id,pageList[m].title,pageList[m].status,2));}}}}}}
PagesSidebarFrame.m_pageNodes=pageNodes;var txt="";for(var i=start_i;i<end_i;i++){txt+=pageNodes[i];}
$('#apollo_page_list').html(txt);$("#apollo_page_list").disableSelection();},showNextPage:function(){$('#prev_pages_link').show();if(PagesSidebarFrame.m_currentPage<PagesSidebarFrame.m_numberPages-1){PagesSidebarFrame.m_currentPage+=1;}
if(PagesSidebarFrame.m_currentPage==PagesSidebarFrame.m_numberPages-1){$('#next_pages_link').hide();}
PagesSidebarFrame.paintPages();},showPrevPage:function(){$('#next_pages_link').show();if(PagesSidebarFrame.m_currentPage>0){PagesSidebarFrame.m_currentPage-=1;}
if(PagesSidebarFrame.m_currentPage==0){$('#prev_pages_link').hide();}
PagesSidebarFrame.paintPages();},getPageHtml:function(page_id,page_title,page_status,page_depth){var txt='';var status_class="";if(page_status=='Draft'){status_class='status_draft';}
else if(page_status=='Private'){status_class='status_private';}
else if(page_status=='Published'){status_class='status_public';}
var selected='';if(page_id==DataStore.m_currentPageID){selected='selected';}
txt+="<div onclick=\"PagesSidebarFrame.onSelectPage('"+page_id+"')\" class='page page_depth_"+page_depth+"' id='page_"+page_id+"' title=''>";txt+="    <img class='page_icon' src='images/web_page2.png'>";txt+="    <span class='page_name "+status_class+" "+selected+"'>"+page_title+"</span>";txt+="</div>";return txt;},addPage:function(){var title='New page '+(DataStore.m_pageList.length+1);var pageSlug=AthenaUtils.encodeSlug(title);var order=0;var isHome=0;MediaAPI.addPage(DataStore.m_siteID,title,'','Draft',0,0,pageSlug,order,isHome,PagesSidebarFrame.onPageAdded);},onPageAdded:function(pageObj){DataStore.addPage(pageObj);PagesSidebarFrame.m_currentPage=PagesSidebarFrame.m_numberPages-1;PagesSidebarFrame.onSelectPage(pageObj.id);},encodeSlug:function(title){var slug=title.replace(/ /g,"");slug=slug.replace(/'/g,"");slug=slug.replace(/\"/g,"");slug=escape(slug);slug=slug.replace(/\//g,"%2F");slug=slug.replace(/\?/g,"%3F");slug=slug.replace(/=/g,"%3D");slug=slug.replace(/&/g,"%26");slug=slug.replace(/@/g,"%40");return slug;},onRightClickFolder:function(e,obj){e.stopPropagation();var x=e.pageX;var y=e.pageY;$('#folderMenu').css('top',y);$('#folderMenu').css('left',x);$('#folderMenu').show();$('#folderMenu .edit').unbind('click');$('#folderMenu .delete').unbind('click');$('#folderMenu .quit').unbind('click');$('#folderMenu .edit').click(function(){PagesSidebarFrame.onMenuItem('rename_folder',obj)});$('#folderMenu .delete').click(function(){PagesSidebarFrame.onMenuItem('delete_folder',obj)});$('#folderMenu .quit').click(function(){PagesSidebarFrame.onMenuItem('quit',obj)});},onMenuItem:function(item,selectedElement){},onSelectPage:function(page_id){PagesFrame.onChange();DataStore.m_currentPageID=parseInt(page_id);PagesFrame.repaint();PagesSidebarFrame.repaint();}}

var StatsSidebarFrame={m_targetDiv:'',paint:function(targetDiv){StatsSidebarFrame.m_targetDiv=targetDiv;var txt="";txt+="<div id='apollo_page_list'></div>";$(targetDiv).html(txt);StatsSidebarFrame.paintPages();$(targetDiv).disableSelection();$(targetDiv).noContext();},repaint:function(){StatsSidebarFrame.paint(StatsSidebarFrame.m_targetDiv);},paintPages:function(){var pageList=DataStore.m_pageList;var txt="";for(var i=0;i<pageList.length;i++){if(pageList[i].parent_page_id==0){txt+=StatsSidebarFrame.getPageHtml(pageList[i].id,pageList[i].title,pageList[i].status,0);for(var k=0;k<pageList.length;k++){if(pageList[k].parent_page_id==pageList[i].id){txt+=StatsSidebarFrame.getPageHtml(pageList[k].id,pageList[k].title,pageList[k].status,1);for(var m=0;m<pageList.length;m++){if(pageList[m].parent_page_id==pageList[k].id){txt+=StatsSidebarFrame.getPageHtml(pageList[m].id,pageList[m].title,pageList[m].status,2);}}}}}}
$('#apollo_page_list').html(txt);$("#apollo_page_list").disableSelection();},getPageHtml:function(page_id,page_title,page_status,page_depth){var txt='';var status_class="";var icon="images/post.png";if(page_status=='Draft'){status_class='status_draft';}
else if(page_status=='Private'){status_class='status_private';}
else if(page_status=='Published'){status_class='status_public';}
var selected='';if(page_id==DataStore.m_currentPageID){selected='selected';}
txt+="<div onclick=\"StatsSidebarFrame.onSelectPage('"+page_id+"')\" class='page page_depth_"+page_depth+"' id='page_"+page_id+"' title=''>";txt+="    <img class='page_icon' src='"+icon+"'>";txt+="    <span class='page_name "+status_class+" "+selected+"'>"+page_title+"</span>";txt+="</div>";return txt;},addPage:function(){var title='New page '+(DataStore.m_pageList.length+1);var pageSlug=AthenaUtils.encodeSlug(title);var order=0;var isHome=0;MediaAPI.addPage(DataStore.m_siteID,title,'','Draft',0,0,pageSlug,order,isHome,StatsSidebarFrame.onPageAdded);},onPageAdded:function(pageObj){DataStore.addPage(pageObj);StatsSidebarFrame.onSelectPage(pageObj.id);},encodeSlug:function(title){var slug=title.replace(/ /g,"");slug=slug.replace(/'/g,"");slug=slug.replace(/\"/g,"");slug=escape(slug);slug=slug.replace(/\//g,"%2F");slug=slug.replace(/\?/g,"%3F");slug=slug.replace(/=/g,"%3D");slug=slug.replace(/&/g,"%26");slug=slug.replace(/@/g,"%40");return slug;},onRightClickFolder:function(e,obj){e.stopPropagation();var x=e.pageX;var y=e.pageY;$('#folderMenu').css('top',y);$('#folderMenu').css('left',x);$('#folderMenu').show();$('#folderMenu .edit').unbind('click');$('#folderMenu .delete').unbind('click');$('#folderMenu .quit').unbind('click');$('#folderMenu .edit').click(function(){StatsSidebarFrame.onMenuItem('rename_folder',obj)});$('#folderMenu .delete').click(function(){StatsSidebarFrame.onMenuItem('delete_folder',obj)});$('#folderMenu .quit').click(function(){StatsSidebarFrame.onMenuItem('quit',obj)});},onMenuItem:function(item,selectedElement){},onSelectPage:function(page_id){DataStore.m_currentPageID=parseInt(page_id);PagesFrame.repaint();StatsSidebarFrame.paintPages();}}

var ImageSelector={folder_id:0,targetDiv:'',MODE_EDIT_GALLERY:0,MODE_ORG_MEDIA:1,mode:1,ID_ALL:0,ID_UNASSIGNED:1,ID_LAST_24_HOURS:2,ID_LAST_7_DAYS:3,ID_LAST_1_HOUR:4,paint:function(mode,targetDiv){ImageSelector.mode=mode;ImageSelector.targetDiv=targetDiv;folder_name="(All)";if(DataStore.m_folderList.length>=1){ImageSelector.folder_id=DataStore.m_folderList[0].id;folder_name=DataStore.m_folderList[0].folder_name;}
var minHeight=550;if(mode==ImageSelector.MODE_EDIT_GALLERY){minHeight=300;}
var txt="";txt+="<table width='100%' cellspacing='0px' style='padding-right:20px'>";txt+="   <tr valign='middle'>";txt+="      <td width='65px'>";txt+="         <h2>Folders</h2>";txt+="      </td>";txt+="      <td align='left' style='padding-top:8px' width='185px'>";txt+="         <div class='nav_buttons'<div class='apollo_add_button' style='float:left' onclick='ImageSelector.addFolder()'></div>";txt+="      </td>";txt+="      <td style='padding-left:20px'>";if(mode==ImageSelector.MODE_EDIT_GALLERY){txt+="     <h2>Library Images<span id='apollo_title_folder_name'>"+folder_name+"</span><span id='apollo_title_feedback'></span></h2>";}
else{txt+="     <h2>Library Images<span id='apollo_title_folder_name'>"+folder_name+"</span>";txt+="         <span id='apollo_title_feedback'></span>";txt+="         <span class='view_options' onclick='ImageSelector.onDeselectAll()'>clear all</span>";txt+="         <span class='view_options' onclick='ImageSelector.onSelectAll()'>select all</span>";txt+="     </h2>";}
txt+="      </td>";txt+="   </tr>";txt+="   <tr valign='top'>";txt+="      <td colspan='2' width='250px' height='100%'>";txt+="         <div class='dialogbox' style='min-width: 100px; min-height:"+minHeight+"px' id='apollo_folder_list'></div>";txt+="      </td>";txt+="      <td style='padding-left:20px'>";txt+="         <div class='dialogbox' style='min-width: 200px; min-height:"+minHeight+"px' id='apollo_image_library'></div>";txt+="      </td>";txt+="   </tr>";txt+="</table>";txt+="<div id='imageEditDialog'></div>";txt+="<ul id='folderMenu' class='rightClickMenu'>";txt+=" <li class='edit'><a href='#edit'>Rename</a></li>";txt+=" <li class='delete'><a href='#delete'>Delete</a></li>";txt+=" <li class='quit separator'><a href='#quit'>Cancel</a></li>";txt+="</ul>";txt+="<ul id='imageMenu' class='rightClickMenu'>";txt+=" <li class='edit'><a href='#edit_image'>Edit Information</a></li>";txt+=" <li class='quit separator'><a href='#quit'>Cancel</a></li>";txt+="</ul>";$(ImageSelector.targetDiv).html(txt);ImageSelector.paintFolders();ImageSelector.paintImages();$(ImageSelector.targetDiv).disableSelection();$(ImageSelector.targetDiv).noContext();},onDeselectAll:function(){ImageSelector.paintImages();},onSelectAll:function(){ImageSelector.paintImages();$('.thumb').addClass('multiselected');setTimeout('ImageSelector.makeMultiSelectedDraggable()',300);},paintImages:function(){var imageList=DataStore.m_mediaList;var txt="";var d=new Date();var localTime=d.getTime();var localOffset=d.getTimezoneOffset()*60000;var utc_date=new Date(localTime+localOffset);var utc_time=localTime+localOffset;for(var i=0;i<imageList.length;i++){var thumb_url=imageList[i].thumb_url;var post_id=imageList[i].id;var title=imageList[i].title;var width=imageList[i].width;var height=imageList[i].height;var image_folder_id=parseInt(imageList[i].folder_id);var added_date=new Date(imageList[i].date_added);var hours_ago=(utc_time-added_date.getTime())/3600000;switch(ImageSelector.folder_id){case ImageSelector.ID_UNASSIGNED:if(image_folder_id==ImageSelector.ID_ALL||image_folder_id==ImageSelector.ID_UNASSIGNED)
txt+=ImageSelector.getImageHTML(post_id,thumb_url,title,width,height);break;case ImageSelector.ID_LAST_1_HOUR:if(hours_ago<=1){txt+=ImageSelector.getImageHTML(post_id,thumb_url,title,width,height);}
break;case ImageSelector.ID_LAST_24_HOURS:if(hours_ago<=24){txt+=ImageSelector.getImageHTML(post_id,thumb_url,title,width,height);}
break;case ImageSelector.ID_LAST_7_DAYS:if(hours_ago<=168){txt+=ImageSelector.getImageHTML(post_id,thumb_url,title,width,height);}
break;case ImageSelector.ID_ALL:txt+=ImageSelector.getImageHTML(post_id,thumb_url,title,width,height);break;case image_folder_id:txt+=ImageSelector.getImageHTML(post_id,thumb_url,title,width,height);break;default:}}
$('#apollo_image_library').html(txt);$('#apollo_image_library').noContext();if(ImageSelector.mode==ImageSelector.MODE_EDIT_GALLERY){$(".thumb").draggable({revert:true,zIndex:300});}
else{$('.thumb').mousedown(function(e){var evt=e;$(this).mouseup(function(){$(this).unbind('mouseup');if(evt.ctrlKey){ImageSelector.onAltClick(e,this);}
else if(evt.button==0){if(evt.shiftKey){ImageSelector.onShiftClick(e,this);}
else if(evt.altKey){ImageSelector.onAltClick(e,this);}
else{ImageSelector.onStartClick(e,this);}
return false;}
else if(evt.button==2){ImageSelector.onRightClickImage(e,this);return true;}})});}},isDragging:false,shiftSelectStarted:false,shiftSelectStartedID:'',onStartClick:function(e,obj){var id=$(obj).attr('id');var isSelected=$(obj).is('.multiselected');if(ImageSelector.shiftSelectStarted){$('.multiselected').removeClass('multiselected');}
if(isSelected){ImageSelector.shiftSelectStarted=false;ImageSelector.paintImages();}
else{ImageSelector.shiftSelectStartedID=id;ImageSelector.shiftSelectStarted=true;ImageSelector.paintImages();$('#'+id).addClass('multiselected');setTimeout('ImageSelector.makeMultiSelectedDraggable()',300);}},onAltClick:function(e,obj){var id=$(obj).attr('id');var isSelected=$(obj).is('.multiselected');if(isSelected){$('#'+id).removeClass('multiselected');$('#'+id).draggable('destroy');}
else{$('#'+id).addClass('multiselected');setTimeout('ImageSelector.makeMultiSelectedDraggable()',300);}},onShiftClick:function(e,obj){var id=$(obj).attr('id');$('.thumb').removeClass('multiselected')
if(ImageSelector.shiftSelectStarted){var foundStart=false;var foundEnd=false;$('.thumb').each(function(){if(!foundEnd){if($(this).attr('id')==ImageSelector.shiftSelectStartedID){foundStart=true;}
if(foundStart){$(this).addClass('multiselected');}
if(foundStart&&$(this).attr('id')==id){foundEnd=true;}}});if(!foundEnd){$('.multiselected').removeClass('multiselected')
foundStart=false;foundEnd=false;$('.thumb').each(function(){if(!foundEnd){if($(this).attr('id')==id){foundStart=true;}
if(foundStart){$(this).addClass('multiselected');}
if($(this).attr('id')==ImageSelector.shiftSelectStartedID){foundEnd=true;}}});}
setTimeout('ImageSelector.makeMultiSelectedDraggable()',300);}
else{ImageSelector.onStartClick(e,obj);}},onCtrlClick:function(e,obj){},makeMultiSelectedDraggable:function(){$('.multiselected').draggable({revert:true,zIndex:300,delay:200,helper:function(){var txt="<div id='multidrag_container'>";var ct=0;$('.multiselected').each(function(){if(ct<20){var offset=ct*5;ct++;var src=$(this).attr('src');var id=$(this).attr('id');var style="position: absolute; top: "+offset+"px; left:"+offset+"px;";txt+="<img id='"+id+"' src='"+src+"' class='dragged_thumb' width='50px' height='50px' style='"+style+"'>";}});txt+="</div>";return txt;}});},getImageHTML:function(post_id,thumb_url,title,width,height){var txt="";var titleText=title+" ("+width+"px by "+height+"px)";txt+="   <img id='img_"+post_id+"' src='"+thumb_url+"' class='thumb' width='50px' title='"+titleText+"'/>";return txt;},paintFolders:function(){var folderList=DataStore.m_folderList;var txt="";if(ImageSelector.folder_id==0){txt+="<div id='folder_0' class='apollo_system_folder' style='width:100%;' onclick=\"ImageSelector.onSelectFolder('0')\"><div class='folder_name_selected'>Show All</div></div>";$('#apollo_title_folder_name').html('(All)');}
else{txt+="<div id='folder_0' class='apollo_system_folder' style='width:100%;' onclick=\"ImageSelector.onSelectFolder('0')\"><div class='folder_name'>Show All</div></div>";}
if(ImageSelector.folder_id==ImageSelector.ID_UNASSIGNED){txt+="<div id='folder_"+ImageSelector.ID_UNASSIGNED+"' class='apollo_folder apollo_system_folder' style='width:100%;' onclick=\"ImageSelector.onSelectFolder("+ImageSelector.ID_UNASSIGNED+")\"><div class='folder_name_selected'>Unassigned images</div></div>";$('#apollo_title_folder_name').html('(Unassigned images)');}
else{txt+="<div id='folder_1' class='apollo_folder apollo_system_folder' style='width:100%;' onclick=\"ImageSelector.onSelectFolder("+ImageSelector.ID_UNASSIGNED+")\"><div class='folder_name'>Unassigned images</div></div>";}
if(ImageSelector.folder_id==ImageSelector.ID_LAST_1_HOUR){txt+="<div id='folder_"+ImageSelector.ID_LAST_1_HOUR+"' class='apollo_system_folder' style='width:100%;' onclick=\"ImageSelector.onSelectFolder("+ImageSelector.ID_LAST_1_HOUR+")\"><div class='folder_name_selected'>Added in last hour</div></div>";$('#apollo_title_folder_name').html('(Added in last hour)');}
else{txt+="<div id='folder_"+ImageSelector.ID_LAST_1_HOUR+"' class='apollo_system_folder' style='width:100%;' onclick=\"ImageSelector.onSelectFolder("+ImageSelector.ID_LAST_1_HOUR+")\"><div class='folder_name'>Added in last hour</div></div>";}
if(ImageSelector.folder_id==ImageSelector.ID_LAST_24_HOURS){txt+="<div id='folder_"+ImageSelector.ID_LAST_24_HOURS+"' class='apollo_system_folder' style='width:100%;' onclick=\"ImageSelector.onSelectFolder("+ImageSelector.ID_LAST_24_HOURS+")\"><div class='folder_name_selected'>Added in last 24 hours</div></div>";$('#apollo_title_folder_name').html('(Added in last 24 hours)');}
else{txt+="<div id='folder_"+ImageSelector.ID_LAST_24_HOURS+"' class='apollo_system_folder' style='width:100%;' onclick=\"ImageSelector.onSelectFolder("+ImageSelector.ID_LAST_24_HOURS+")\"><div class='folder_name'>Added in last 24 hours</div></div>";}
for(var i=0;i<folderList.length;i++){var folder_name=ApolloUtils.htmlEncode(folderList[i].name);var folder_id=folderList[i].id;if(folder_id==ImageSelector.folder_id){$('#apollo_title_folder_name').html('('+folder_name+')');txt+="<div id='folder_"+folder_id+"' class='apollo_folder folder_with_menu' style='width:100%;' title='Right click to edit' onclick=\"ImageSelector.onSelectFolder('"+folder_id+"')\"><div class='folder_name folder_name_selected'>"+folder_name+"</div></div>";}
else{txt+="<div id='folder_"+folder_id+"' class='apollo_folder folder_with_menu' style='width:100%;' title='Right click to edit' onclick=\"ImageSelector.onSelectFolder('"+folder_id+"')\"><div class='folder_name'>"+folder_name+"</div></div>";}}
$('#apollo_folder_list').html(txt);$('.apollo_folder').droppable({drop:ImageSelector.onAddToFolder,over:function(ev,ui){$(this).addClass('apollo_folder_droppable_hover');},out:function(ev,ui){$(this).removeClass('apollo_folder_droppable_hover');}});if(ImageSelector.mode!=ImageSelector.MODE_EDIT_GALLERY){$(".folder_with_menu").rightClick(function(e){ImageSelector.onRightClickFolder(e,this);});}
$("#apollo_folder_list").disableSelection();},onRightClickFolder:function(e,obj){e.stopPropagation();var x=e.pageX;var y=e.pageY;$('#folderMenu').css('top',y);$('#folderMenu').css('left',x);$('#folderMenu').show();$('#folderMenu .edit').unbind('click');$('#folderMenu .delete').unbind('click');$('#folderMenu .quit').unbind('click');$('#folderMenu .edit').click(function(){ImageSelector.onMenuItem('rename_folder',obj)});$('#folderMenu .delete').click(function(){ImageSelector.onMenuItem('delete_folder',obj)});$('#folderMenu .quit').click(function(){ImageSelector.onMenuItem('quit',obj)});},onRightClickImage:function(e,obj){e.stopPropagation();var x=e.pageX;var y=e.pageY;$('#imageMenu').css('top',y);$('#imageMenu').css('left',x);$('#imageMenu').show();$('#imageMenu .edit').unbind('click');$('#imageMenu .delete').unbind('click');$('#imageMenu .quit').unbind('click');$('#imageMenu .edit').click(function(){ImageSelector.onMenuItem('edit_image',obj)});$('#imageMenu .delete').click(function(){ImageSelector.onMenuItem('delete_image',obj)});$('#imageMenu .quit').click(function(){ImageSelector.onMenuItem('quit',obj)});},messageTimeout:-1,showMessage:function(msg){$('#apollo_title_feedback').html(msg);$('#apollo_title_feedback').show();if(ImageSelector.messageTimeout!=-1){clearTimeout(ImageSelector.messageTimeout)}
setTimeout('ImageSelector.hideMessage()',5000);},hideMessage:function(){$('#apollo_title_feedback').hide();},onMenuItem:function(item,selectedElement){$('#imageMenu').hide();$('#folderMenu').hide();var divID=$(selectedElement).attr('id');if(item=='rename_folder'||item=='delete_folder'){var name=$('#'+divID+' .folder_name').html();var folder_id=parseInt(divID.substr(7));}
else{var image_post_id=parseInt(divID.substr(4));}
if(item=='rename_folder'){ImageSelector.makeFolderNameEditable(folder_id);}
else if(item=='delete_folder'){ApolloDialog.confirm("Are you sure you want to delete this folder? This can not be undone.",function(){ImageSelector.deleteFolder(folder_id);});}
else if(item=='edit_image'){ImageEditDialog.show('#imageEditDialog',image_post_id);}
else if(item=='delete_image'){ApolloDialog.alert('feature coming soon');}},makeFolderNameEditable:function(folder_id){var divID='#folder_'+folder_id;var name=$(divID+' .folder_name').html();$(divID).attr('onclick','');$(divID).html("<input id='folder_name_edit' style='margin-left:30px' type='text' value='"+name+"' onblur='ImageSelector.paintFolders()'/>");$("#folder_name_edit").keypress(function(e){if((e.which&&e.which==13)||(e.keyCode&&e.keyCode==13)){ImageSelector.renameFolder(folder_id,$("#folder_name_edit").val());}});$("#folder_name_edit").focus();},onSelectFolder:function(folder_id){ImageSelector.folder_id=parseInt(folder_id);ImageSelector.paintImages();ImageSelector.paintFolders();},deleteFolder:function(folderdId){var paras={cmd:14,folder_id:folderdId};$.ajax({url:ImagePickerData.commandURL,dataType:"text",data:paras,success:function(ret){ImageSelector.onFolderDeleted(ret,folderdId)}});},onFolderDeleted:function(res,folder_id){ImageSelector.showMessage("Folder deleted");var temp=new Array();for(var i=0;i<DataStore.m_folderList.length;i++){if(DataStore.m_folderList[i].id!=folder_id){temp.push(DataStore.m_folderList[i]);}}
DataStore.m_folderList=temp;ImageSelector.paintFolders()},addFolder:function(folderName){if(folderName==undefined){folderName='new folder';}
var paras={cmd:12,folder_name:folderName};$.ajax({url:ImagePickerData.commandURL,dataType:"json",data:paras,success:function(ret){ImageSelector.onAddedFolder(ret,folderName)}});},onAddedFolder:function(msg,folderName){if(msg.result=="ok"){var folder_id=msg.folder_id;var temp=new Array();temp.id=folder_id;temp.name=folderName;DataStore.m_folderList.push(temp);ImageSelector.paintFolders();ImageSelector.makeFolderNameEditable(folder_id);ImageSelector.showMessage("Folder added");}},getFolderName:function(folder_id){if(folder_id==ImageSelector.ID_UNASSIGNED){return"Unassigned";}
for(var i=0;i<DataStore.m_folderList.length;i++){if(DataStore.m_folderList[i].id==folder_id){return DataStore.m_folderList[i].name;}}
return"? ("+folder_id+")";},renameFolder:function(folderId,folderName){var paras={cmd:11,folder_id:folderId,folder_name:folderName};$.ajax({url:ImagePickerData.commandURL,dataType:"text",data:paras,success:function(ret){ImageSelector.onFolderRenamed(ret,folderId,folderName)}});},onFolderRenamed:function(ret,folderId,folderName){for(var i=0;i<DataStore.m_folderList.length;i++){if(DataStore.m_folderList[i].id==folderId){DataStore.m_folderList[i].name=folderName;break;}}
ImageSelector.paintFolders()},onAddToFolder:function(event,ui){var imgID=parseInt($(ui.draggable).attr('id').substring(4));var folderID=parseInt($(this).attr('id').substring(7));var imgList=new Array();var is_multiDrag=false;$('.multiselected').each(function(){var multi_imgID=parseInt($(this).attr('id').substring(4));imgList.push(multi_imgID);if(imgID==multi_imgID){is_multiDrag=true;}});if(!is_multiDrag){imgList=new Array();imgList[0]=imgID;}
for(var i=0;i<imgList.length;i++){var tempImgID=imgList[i];if(folderID==ImageSelector.ID_UNASSIGNED||folderID>9){var paras={cmd:10,media_post_id:tempImgID,folder_id:folderID};$.ajax({url:ImagePickerData.commandURL,dataType:"json",data:paras,success:function(ret){ImageSelector.onAddedToFolder(ret)}});}}
$(this).removeClass('apollo_folder_droppable_hover');},onAddedToFolder:function(msg){if(msg.result=="ok"){var imgID=msg.media_post_id;var folderID=msg.folder_id;for(var i=0;i<DataStore.m_mediaList.length;i++){if(DataStore.m_mediaList[i].post_id==imgID){DataStore.m_mediaList[i].folder_id=folderID;break;}}
ImageSelector.paintImages();if(folderID==0){ImageSelector.showMessage("Image removed from folder");}
else{ImageSelector.showMessage("Image added to folder <i>"+ImageSelector.getFolderName(folderID)+"</i>");}}
else if(msg.result=='duplicate'){ImageSelector.showMessage("Image already in folder  <i>"+ImageSelector.getFolderName(folderID)+"</i>");}}}

var ImageEditFrame={image_id:0,image_index:0,paint:function(targetDiv,image_id){var imageList=DataStore.m_mediaList;var imageData=DataStore.getImage(image_id);if(!imageData){AthenaDialog.error('Error, could not find image!');return;}
var thumb_url=imageData.thumb_url;var img_width=imageData.width;var img_height=imageData.height;var image_folder_id=imageData.folder_id;var added_date=imageData.date_added;var img_title=imageData.title;var desc=imageData.description;var alt_text=imageData.tags;var image_url=imageData.file_url;var txt="";txt+="<div id='ApolloImageEditFrame' align='center'>";var max_img_width=$(targetDiv).innerWidth()-20;var max_img_height=400;txt+="<table width='100%' height='100%' cellspacing='3px'>";txt+="   <tr valign='center' align='center' class='imageDisplay'>";txt+="      <td class='dataField' colspan='2' >";txt+="          <img src='"+image_url+"' style='max-width: "+max_img_width+"px; max-height: "+max_img_height+"px;'/>";txt+="      </td>";txt+="   </tr>";txt+="   <tr>";txt+="      <td class='titleField'>Title</td>";txt+="      <td class='dataField'><input id='apollo_image_title' type=text value='"+img_title+"'/></td>";txt+="   </tr>";txt+="   <tr>";txt+="      <td class='titleField'>Added</td>";txt+="      <td class='dataField'><input id='' width='100%' type=text value='"+added_date+" (GMT)' disabled/></td>";txt+="   </tr>";txt+="   <tr>";txt+="      <td class='titleField'>Size</td>";txt+="      <td class='dataField'><input id='' width='100%' type=text value='"+img_width+"px by "+img_height+"px' disabled/></td>";txt+="   </tr>";txt+="   <tr>";txt+="      <td class='titleField'>Description</td>";txt+="      <td class='dataField'><textarea id='apollo_image_desc' width='100%'>"+desc+"</textarea></td>";txt+="   </tr>";txt+="   <tr>";txt+="      <td class='titleField'>Alt Text</td>";txt+="      <td class='dataField'><textarea id='apollo_image_tags' width='100%'>"+alt_text+"</textarea></td>";txt+="   </tr>";txt+="   <tr align='center'>";txt+="      <td colspan='2'>";txt+="          <button class='cancel_button' onclick=\"ImageEditFrame.onCancel()\">Done</button>";txt+="          <button class='save_button' onclick=\"ImageEditFrame.onSave('"+image_id+"')\">Save</button>";txt+="          <button class='delete_button' onclick=\"ImageEditFrame.onDelete('"+image_id+"')\">Delete</button>";txt+="      </td>";txt+="   </tr>";txt+="</table>";txt+="</div>";var dialogTitle=img_title;$(targetDiv).dialog('destroy');$(targetDiv).html(txt);},onCancel:function(){FilesFrame.onCancelSelectImage();},onSave:function(media_id){var newTitle=$('#apollo_image_title').val();var newDesc=$('#apollo_image_desc').val();var newTags=$('#apollo_image_tags').val();MediaAPI.updateMediaInfo(DataStore.m_siteID,media_id,newTitle,newDesc,newTags,ImageEditFrame.onSaved);},onSaved:function(mediaObj){DataStore.updateMedia(mediaObj);},onDelete:function(media_id){AthenaDialog.confirm("Are you sure you want to delete this image? This can not be undone!",function(){ImageEditFrame.onDoDelete(media_id);});},onDoDelete:function(media_id){MediaAPI.deleteMedia(DataStore.m_siteID,media_id,ImageEditFrame.onDeleted);},onDeleted:function(media_id){DataStore.deleteMedia(media_id);FilesFrame.repaint();}}

var PostsSidebarFrame={m_targetDiv:'',m_postsPerPage:25,m_currentPostPage:0,m_numberPages:0,paint:function(targetDiv){PostsSidebarFrame.m_targetDiv=targetDiv;var txt="";txt+="<div id='apollo_post_list'></div>";txt+="<div id='postsPageControls' class='sidebar_page_controls'>";txt+="<table border='0'>";txt+="    <tr>";txt+="        <td width='33%' align='left'><span class='more_posts_link' id='prev_posts_link' style='padding-left:15px' onclick='PostsSidebarFrame.showOlderPosts()' title='Display older posts'>&laquo; older</span></td>";txt+="        <td width='33%' align='center'><span class='more_posts_pages' id='page_no' style=''>1 of 2</span></td>";txt+="        <td width='33%' align='right'><span class='more_posts_link' id='next_posts_link' style='padding-right:15px' onclick='PostsSidebarFrame.showNewerPosts()' title='Display newer posts'>newer &raquo;</span></td>";txt+="    </tr>";txt+="</table>";txt+="</div>";$(targetDiv).html(txt);var pos=$(targetDiv).position();var offset=pos.top+30;var lineht=23;var h=$('.ViewFrame').height()-offset-$('#postsPageControls').height();var h=$(window).height()-110;PostsSidebarFrame.m_postsPerPage=Math.floor(h/30);PostsSidebarFrame.m_numberPages=Math.ceil(DataStore.m_postList.length/PostsSidebarFrame.m_postsPerPage);if(PostsSidebarFrame.m_numberPages==1){$('#postsPageControls').hide();}
$('#apollo_post_list').height(h);PostsSidebarFrame.paintPosts();$(targetDiv).disableSelection();$(targetDiv).noContext();},repaint:function(){PostsSidebarFrame.paint(PostsSidebarFrame.m_targetDiv);},paintPosts:function(){var postList=DataStore.m_postList;var txt="";var start_i=PostsSidebarFrame.m_currentPostPage*PostsSidebarFrame.m_postsPerPage;var end_i=Math.min(postList.length,start_i+PostsSidebarFrame.m_postsPerPage);$('#page_no').html((PostsSidebarFrame.m_currentPostPage+1)+" of "+PostsSidebarFrame.m_numberPages);for(var i=start_i;i<end_i;i++){txt+=PostsSidebarFrame.getPostHtml(postList[i].id,postList[i].title,postList[i].status);}
if(PostsSidebarFrame.m_currentPostPage<PostsSidebarFrame.m_numberPages-1){$('#prev_posts_link').show();}
else{$('#prev_posts_link').hide();}
if(PostsSidebarFrame.m_currentPostPage>0){$('#next_posts_link').show();}
else{$('#next_posts_link').hide();}
$('#apollo_post_list').html(txt);$("#apollo_post_list").disableSelection();},getPostHtml:function(post_id,post_title,post_status){var txt='';var icon="images/post.png";var status_class="";if(post_status=='Draft'){status_class='status_draft';}
else if(post_status=='Private'){status_class='status_private';}
else if(post_status=='Published'){status_class='status_public';}
var selected='';if(post_id==DataStore.m_currentPostID){selected='selected';}
if(post_title=="")post_title="(no title)";txt+="<div onclick=\"PostsSidebarFrame.onSelectPost('"+post_id+"')\" class='page page_depth_0' id='post_"+post_id+"' title='"+post_title+"'>";txt+="    <img class='page_icon' src='"+icon+"'>";txt+="    <span class='page_name "+status_class+" "+selected+"'>"+post_title+"</span>";txt+="</div>";return txt;},showOlderPosts:function(){if(PostsSidebarFrame.m_currentPostPage<PostsSidebarFrame.m_numberPages-1){PostsSidebarFrame.m_currentPostPage+=1;}
PostsSidebarFrame.paintPosts();},showNewerPosts:function(){if(PostsSidebarFrame.m_currentPostPage>0){PostsSidebarFrame.m_currentPostPage-=1;}
PostsSidebarFrame.paintPosts();},addPost:function(){var title='New post '+(DataStore.m_postList.length+1);var postSlug=AthenaUtils.encodeSlug(title);MediaAPI.addPost(DataStore.m_siteID,title,'','Draft',1,postSlug,PostsSidebarFrame.onPostAdded);},onPostAdded:function(postObj){DataStore.addPost(postObj,true);PostsSidebarFrame.onSelectPost(postObj.id);},encodeSlug:function(title){var slug=title.replace(/ /g,"");slug=slug.replace(/'/g,"");slug=slug.replace(/\"/g,"");slug=escape(slug);slug=slug.replace(/\//g,"%2F");slug=slug.replace(/\?/g,"%3F");slug=slug.replace(/=/g,"%3D");slug=slug.replace(/&/g,"%26");slug=slug.replace(/@/g,"%40");return slug;},onSelectPost:function(post_id){PostsFrame.onChange();DataStore.m_currentPostID=parseInt(post_id);PostsFrame.repaint();PostsSidebarFrame.paintPosts();}}

var GalleriesSidebarFrame={m_targetDiv:'',m_tagsPerPage:25,m_currentPage:0,m_numberPages:0,m_pageList:'',paint:function(targetDiv){GalleriesSidebarFrame.m_targetDiv=targetDiv;var txt="";txt+="<div id='apollo_page_list'></div>";txt+="<div id='galPagesSidebarControls' class='sidebar_page_controls'>";txt+="<table border='0'>";txt+="    <tr>";txt+="        <td width='33%' align='left'><span class='more_posts_link' id='prev_pages_link' style='padding-left:15px' onclick='GalleriesSidebarFrame.showPrevPage()' title='Display previous page'>&laquo; prev</span></td>";txt+="        <td width='33%' align='center'><span class='more_posts_pages' id='galpages_sideframe_page_no' style=''>1 of 2</span></td>";txt+="        <td width='33%' align='right'><span class='more_posts_link' id='next_pages_link' style='padding-right:15px' onclick='GalleriesSidebarFrame.showNextPage()' title='Display next page'>next &raquo;</span></td>";txt+="    </tr>";txt+="</table>";txt+="</div>";$(targetDiv).html(txt);GalleriesSidebarFrame.m_pageList=GalleriesSidebarFrame.getPagesWithGalleries();var offset=110;var h=($(window).height()-offset)/2;GalleriesSidebarFrame.m_tagsPerPage=Math.floor(h/25);GalleriesSidebarFrame.m_numberPages=Math.ceil(GalleriesSidebarFrame.m_pageList.length/GalleriesSidebarFrame.m_tagsPerPage);if(GalleriesSidebarFrame.m_numberPages==1){$('#galPagesSidebarControls').hide();}
GalleriesSidebarFrame.paintPages();$('#apollo_page_list').height(h);$(targetDiv).disableSelection();$(targetDiv).noContext();},repaint:function(){GalleriesSidebarFrame.paint(GalleriesSidebarFrame.m_targetDiv);},getPagesWithGalleries:function(){var pageList=new Array();for(var i=0;i<DataStore.m_pageList.length;i++){var hasGallery=DataStore.isGalleryPage(DataStore.m_pageList[i].id);if(hasGallery){pageList.push(DataStore.m_pageList[i]);}}
return pageList;},paintPages:function(){var pageList=GalleriesSidebarFrame.m_pageList;var start_i=GalleriesSidebarFrame.m_currentPage*GalleriesSidebarFrame.m_tagsPerPage;var end_i=Math.min(pageList.length,start_i+GalleriesSidebarFrame.m_tagsPerPage);$('#galpages_sideframe_page_no').html((GalleriesSidebarFrame.m_currentPage+1)+" of "+GalleriesSidebarFrame.m_numberPages);var txt="";if(pageList.length==0){txt+="<div style='padding-left:10px;color:#444444;'>You have no pages using a gallery template yet</div>";}
else{for(var i=start_i;i<end_i;i++){var hasGallery=DataStore.isGalleryPage(pageList[i].id);if(hasGallery){txt+=GalleriesSidebarFrame.getPageHtml(pageList[i].id,pageList[i].title,pageList[i].status,0);}}}
$('#apollo_page_list').html(txt);$("#apollo_page_list").disableSelection();},showNextPage:function(){$('#prev_pages_link').show();if(GalleriesSidebarFrame.m_currentPage<GalleriesSidebarFrame.m_numberPages-1){GalleriesSidebarFrame.m_currentPage+=1;}
if(GalleriesSidebarFrame.m_currentPage==GalleriesSidebarFrame.m_numberPages-1){$('#next_pages_link').hide();}
GalleriesSidebarFrame.paintPages();},showPrevPage:function(){$('#next_pages_link').show();if(GalleriesSidebarFrame.m_currentPage>0){GalleriesSidebarFrame.m_currentPage-=1;}
if(GalleriesSidebarFrame.m_currentPage==0){$('#prev_pages_link').hide();}
GalleriesSidebarFrame.paintPages();},getPageHtml:function(page_id,page_title,page_status,page_depth){var txt='';var icon="images/post.png";var status_class="";var icon="images/post.png";if(page_status=='Draft'){status_class='status_draft';}
else if(page_status=='Private'){status_class='status_private';}
else if(page_status=='Published'){status_class='status_public';}
var selected='';if(page_id==DataStore.m_currentPageID){selected='selected';}
page_depth=0;txt+="<div onclick=\"GalleriesSidebarFrame.onSelectPage('"+page_id+"')\" class='page page_depth_"+page_depth+"' id='page_"+page_id+"' title=''>";txt+="    <img class='page_icon' src='images/web_page2.png'>";txt+="    <span class='page_name "+status_class+" "+selected+"'>"+page_title+"</span>";txt+="</div>";return txt;},onSelectPage:function(page_id){DataStore.m_currentPageID=parseInt(page_id);GalleriesFrame.repaint();GalleriesSidebarFrame.paintPages();}}

var DashboardFrame={m_snapshotMode:'traffic',m_commentsMode:'Pending',m_comments:'',m_summaryData:'',m_crawlerViews:'',m_pageViews:'',m_discUsage:'',m_painted:false,init:function(){},repaint:function(){if(DashboardFrame.m_painted){DashboardFrame.paintSnapshotTab();}
else{$('#apollo_followers_summary').hide();$('#apollo_site_stats_summary').hide();BlogAPI.getComments(DataStore.m_siteID,0,DashboardFrame.gotComments);BlogAPI.getSummary(DataStore.m_siteID,DashboardFrame.gotSummary);DashboardFrame.m_painted=true;}},gotSummary:function(data){DashboardFrame.m_summaryData=data;MediaAPI.getStats(DataStore.m_siteID,DashboardFrame.gotStats);},gotStats:function(disc_usage,page_views,crawler_views){DashboardFrame.m_discUsage=disc_usage;DashboardFrame.m_pageViews=page_views;DashboardFrame.m_crawlerViews=crawler_views;DashboardFrame.paintSnapshotTab();},paintSnapshotTab:function(){if(DashboardFrame.m_snapshotMode=='traffic'){$('#apollo_followers_summary').hide();$('#apollo_site_stats_summary').show();DashboardFrame.paintStats();}
else{$('#apollo_followers_summary').show();$('#apollo_site_stats_summary').hide();DashboardFrame.paintFollowers();}},showTraffic:function(){$('.subFrameCommand').removeClass('selected');$('#showTraffic').addClass('selected');DashboardFrame.m_snapshotMode='traffic';DashboardFrame.paintSnapshotTab();},showFollowers:function(){$('.subFrameCommand').removeClass('selected');$('#showFollowers').addClass('selected');DashboardFrame.m_snapshotMode='followers';DashboardFrame.paintSnapshotTab();},m_discUsePC:0,paintStats:function(){var data=DashboardFrame.m_summaryData;$('#no_comments_approved').html(data.comments_approved);$('#no_comments_pending').html(data.comments_pending);$('#no_comments_spam').html(data.comments_spam);$('#no_comments_trash').html(data.comments_trash);$('#no_posts_published').html(data.posts_published);$('#no_posts_draft').html(data.posts_draft);$('#no_posts_private').html(data.posts_private);$('#no_catgeories').html(data.categories);$('#no_tags').html(data.tags);$('#no_followers').html(data.no_followers);$('#disc_usage').html(AthenaUtils.addCommas(DashboardFrame.m_discUsage,2)+" MB");StatViewer.paintCrawlerGraph("#apollo_crawler_graph_small",DashboardFrame.m_crawlerViews);StatViewer.paintStatGraph("#apollo_stats_graph_small",DashboardFrame.m_pageViews);},paintFollowers:function(){var data=DashboardFrame.m_summaryData;if(!data.top_followers||data.top_followers==undefined||data.top_followers.length==0){return;}
var txt="";txt+='<table class="statsTable"  border="0" cellspacing="2" cellpadding="3">';txt+='<thead class="head" align="left">';txt+='<th>#</th><th>Commenter</th><th>Last Activity</th><th>No Comments</th>';txt+='</thead>';for(var i=0;i<data.top_followers.length;i++){var dt=new Date(data.top_followers[i].last_activity);var dateStr=dateFormat(dt,"ddd, mmm dS yyyy");var namelink=data.top_followers[i].name;if(data.top_followers[i].url!=undefined){namelink="<a href='"+data.top_followers[i].url+"'>"+data.top_followers[i].name+"</a>";}
var className='odd';if(i%2)className='even';txt+='<tr align="left" class="'+className+'">';txt+='    <td>'+(i+1)+'</td>';txt+='    <td class="commentName" id="follower0name">'+namelink+'</td>';txt+='    <td class="commentDate" >'+dateStr+'</td>';txt+='    <td>'+data.top_followers[i].no+'</td>';txt+='</tr>';}
txt+='</table>';$('#apollo_followers_summary').html(txt);},gotComments:function(postID,comments){DashboardFrame.m_comments=comments;DashboardFrame.paintComments(comments);},showComments:function(status){$('.subFrameCommand').removeClass('selected');$('#showComments'+status).addClass('selected');DashboardFrame.m_commentsMode=status;DashboardFrame.paintComments();},paintComments:function(){var txt="";if(!DashboardFrame.m_comments||DashboardFrame.m_comments==undefined||DashboardFrame.m_comments.length==0){$('#apollo_site_comments').html("<div align='center'><p>I'm sorry, you don't have any comments yet</p></div>");return;}
var comments=DashboardFrame.m_comments;for(var i=0;i<comments.length;i++){if(DashboardFrame.m_commentsMode=='All'||comments[i].status==DashboardFrame.m_commentsMode){txt+=DashboardFrame.getCommentHTML(comments[i]);}}
$('#apollo_site_comments').html(txt);},getCommentHTML:function(commentObj){var txt="";var id=commentObj.id;var dt=new Date(commentObj.created);var dateStr=dateFormat(dt,"ddd, mmm dS yyyy, h:MM:ss TT");var classStr="pending_comment";switch(commentObj.status){case'Spam':case'Trash':classStr="trashed_comment";break;}
var post=DataStore.getPost(commentObj.post_id);txt+="<div class='commentWrapper "+classStr+"'>";txt+="    <div class='commentTitle' style='overflow:hidden'>";txt+="    <span class='commentPostTitle'>"+post.title+"</span>";txt+="    </div>"
txt+="    <div class='commentTitle'>";txt+="        By <span class='commentName'>"+commentObj.name+"</span> on <span class='commentDate'>"+dateStr+"</span>";if(commentObj.status!='Spam'){txt+="    <a href='#' class='commentEdit' onclick=\"DashboardFrame.spamComment("+id+")\">spam</a>";}
else{txt+="    <a href='#' class='commentEdit' onclick=\"DashboardFrame.unspamComment("+id+")\">not spam</a>";}
if(commentObj.status!='Spam'){if(commentObj.status=='Trash'){txt+="    <a href='#' class='commentEdit' onclick=\"DashboardFrame.undeleteComment("+id+")\">undelete</a>";}
else{txt+="    <a href='#' class='commentEdit' onclick=\"DashboardFrame.deleteComment("+id+")\">delete</a>";}}
if(commentObj.status=='Pending'){txt+="    <a href='#' class='commentEdit' onclick=\"DashboardFrame.approveComment("+id+")\">approve</a>";}
else if(commentObj.status=='Approved'){txt+="    <a href='#' class='commentEdit' onclick=\"DashboardFrame.unapproveComment("+id+")\">unapprove</a>";}
txt+="    </div>";txt+="    <div class='commentContents'>"+commentObj.content+"</div>";txt+="</div>";return txt;},unspamComment:function(comment_id){MediaAPI.updateCommentStatus(DataStore.m_siteID,comment_id,'Approved',DashboardFrame.onCommentUpdate);},spamComment:function(comment_id){MediaAPI.updateCommentStatus(DataStore.m_siteID,comment_id,'Spam',DashboardFrame.onCommentUpdate);},unapproveComment:function(comment_id){MediaAPI.updateCommentStatus(DataStore.m_siteID,comment_id,'Pending',DashboardFrame.onCommentUpdate);},approveComment:function(comment_id){MediaAPI.updateCommentStatus(DataStore.m_siteID,comment_id,'Approved',DashboardFrame.onCommentUpdate);},deleteComment:function(comment_id){MediaAPI.updateCommentStatus(DataStore.m_siteID,comment_id,'Trash',DashboardFrame.onCommentUpdate);},undeleteComment:function(comment_id){MediaAPI.updateCommentStatus(DataStore.m_siteID,comment_id,'Pending',DashboardFrame.onCommentUpdate);},onCommentUpdate:function(commentID,newStatus){for(var i=0;i<DashboardFrame.m_comments.length;i++){if(DashboardFrame.m_comments[i].id==commentID){DashboardFrame.m_comments[i].status=newStatus;DashboardFrame.paintComments();}}}}

var FilesFrame={m_mode:'',m_currentImagePage:0,m_imagesPerPage:50,m_numberImagePages:0,m_imageList:'',painted:false,init:function(){FilesFrame.painted=false;$('#apollo_image_custom_tags').keyup(function(e){if(e.keyCode==13){FilesFrame.addMediaTag();}});},repaint:function(){if(!FilesFrame.painted){FilesFrame.fullRepaint();FilesFrame.painted=true;}
else{FilesFrame.repaintData();}
ssMain.onResize();},fullRepaint:function(){FilesFrame.m_mode='upload';FilesFrame.paintUploader();FilesFrame.repaintData();$('.more_link').disableSelection();$('.more_link').noContext();},repaintData:function(){if(SidebarFrame.m_folderTagMode){FilesFrame.m_imageList=DataStore.getImagesForCurrentTag();}
else{FilesFrame.m_imageList=DataStore.getImagesForCurrentFolder();}
FilesFrame.calcImagePages();if(FilesFrame.m_mode=='edit_image'){FilesFrame.onSelectImage(FilesFrame.m_currentImageID);}
else{FilesFrame.onShowUploader();}
FilesFrame.paintImages();},onSelectFolder:function(){FilesFrame.m_currentImagePage=0;FilesFrame.repaintData();FilesFrame.onShowUploader();},showPrevImages:function(){FilesFrame.m_currentImagePage--;if(FilesFrame.m_currentImagePage<0){FilesFrame.m_currentImagePage=FilesFrame.m_numberImagePages-1;}
FilesFrame.paintImages();},showNextImages:function(){FilesFrame.m_currentImagePage++;if(FilesFrame.m_currentImagePage>=FilesFrame.m_numberImagePages){FilesFrame.m_currentImagePage=0;}
FilesFrame.paintImages();},updateFolderName:function(name){},m_currentImageID:0,onSelectImage:function(image_id){FilesFrame.m_currentImageID=image_id;if(!DataStore.getImage(image_id)){image_id=FilesFrame.m_imageList[0].id;}
var imageData=DataStore.getImage(image_id);if(!imageData){AthenaDialog.error('Error, could not find image!');return;}
$('#apollo_image_title').val("");$('#apollo_image_date').val("");$('#apollo_image_size').val("");$('#apollo_image_desc').val("");$('#apollo_image_tags').val("");$('#apollo_image_url').attr('src','');$('#imageEditContent').show();$('#flashUploderContent').hide();$('#imageEditContent').width(500);var thumb_url=imageData.thumb_url;var img_width=imageData.width;var img_height=imageData.height;var image_folder_id=imageData.folder_id;var added_date=imageData.date_added;var img_title=imageData.title;var desc=imageData.description;var alt_text=imageData.tags;var image_url=imageData.file_url;var max_img_width=$('#imageEditContent').innerWidth()-20;var max_img_height=0.4*$(window).height();$('#apollo_image_title').val(img_title);$('#apollo_image_date').val(added_date+" (GMT)");$('#apollo_image_size').val(img_width+"px by "+img_height+"px");$('#apollo_image_desc').val(desc);$('#apollo_image_tags').val(alt_text);$('#apollo_image_url').css('max-width',max_img_width);$('#apollo_image_url').css('max-height',max_img_height);$('#apollo_image_url').attr('src',image_url);var txt="";$('#apollo_image_custom_tag_list').html("");if(imageData.media_tags!=undefined&&imageData.media_tags!=null){for(var i=0;i<imageData.media_tags.length;i++){var onclick="FilesFrame.deleteImageTag(\""+imageData.media_tags[i]+"\")";txt+="<div class='postTagCatLine'><span class='postTagCat'>"+imageData.media_tags[i]+"</span><span class='postRemoveTagCat' onclick='"+onclick+"'></span></div>";}
$('#apollo_image_custom_tag_list').html(txt);}
$('#apollo_image_custom_tags').autocomplete('destroy');if(DataStore.m_mediaTags!=undefined&&DataStore.m_mediaTags!=null){$("#apollo_image_custom_tags").autocomplete({source:DataStore.m_mediaTags});}
var prevMode=FilesFrame.m_mode;FilesFrame.m_mode='edit_image';if(prevMode!='edit_image'){FilesFrame.calcImagePages();FilesFrame.paintImages();}},onImageEditorChange:function(){var mediaObj=DataStore.getImage(FilesFrame.m_currentImageID);mediaObj.title=$('#apollo_image_title').val();mediaObj.description=$('#apollo_image_desc').val();mediaObj.tags=$('#apollo_image_tags').val();DataStore.updateMedia(mediaObj,true);},deleteImageTag:function(tag){MediaAPI.removeMediaTag(DataStore.m_siteID,FilesFrame.m_currentImageID,tag,FilesFrame.onMediaTagChanged)},addMediaTag:function(){var csvtags=$('#apollo_image_custom_tags').val();MediaAPI.addMediaCSVTags(DataStore.m_siteID,FilesFrame.m_currentImageID,csvtags,FilesFrame.onMediaTagChanged);},onMediaTagChanged:function(mediaObj,tags){DataStore.updateMedia(mediaObj);DataStore.m_mediaTags=tags;$('#apollo_image_custom_tags').val('');FilesFrame.repaint();},onCancel:function(){FilesFrame.onShowUploader();},onDeleteImage:function(media_id){var media_id=FilesFrame.m_currentImageID;AthenaDialog.confirm("Are you sure you want to delete this image? This can not be undone!",function(){FilesFrame.onDoDelete(media_id);});},onDoDelete:function(media_id){MediaAPI.deleteMedia(DataStore.m_siteID,media_id,FilesFrame.onDeleted);},onDeleted:function(media_id){DataStore.deleteMedia(media_id);FilesFrame.repaint();FilesFrame.onShowUploader();},onShowUploader:function(){$('#imageEditContent').hide();$('#flashUploderContent').show();$('#flashUploderContent').width(200);var prevMode=FilesFrame.m_mode;FilesFrame.m_mode='upload';if(prevMode!='upload'){FilesFrame.calcImagePages();FilesFrame.paintImages();}},paintUploader:function(){var settings={flash_url:defines.code_url+"js/3rdparty/SWFUpload/Flash/swfupload.swf",upload_url:defines.code_url+"php/ProcessUpload.php",post_params:{"PHPSESSID":defines.session_id,"folder_id":DataStore.m_currentFolderID,"site_id":DataStore.m_siteID},file_size_limit:"102400",file_types:"*.jpg; *.gif; *.png; *.jpeg;",file_types_description:"All Files",file_upload_limit:"0",file_queue_limit:"0",custom_settings:{progressTarget:"flashUploaderProgress",cancelButtonId:"flashUploadCancelButton"},debug:false,button_image_url:defines.root_url+"images/FileUploadButton.png",button_width:"61",button_height:"22",button_placeholder_id:"flashUploadButton",file_queued_handler:FlashUploader.fileQueued,file_queue_error_handler:FlashUploader.fileQueueError,file_dialog_complete_handler:FlashUploader.fileDialogComplete,upload_start_handler:FlashUploader.uploadStart,upload_progress_handler:FlashUploader.uploadProgress,upload_error_handler:FlashUploader.uploadError,upload_success_handler:FlashUploader.uploadSuccess,upload_complete_handler:FlashUploader.uploadComplete,queue_complete_handler:FlashUploader.queueComplete};var swfu=new SWFUpload(settings);$('#flashUploaderProgress').height($('#FilesFrame').outerHeight()-$('.uploadControls').outerHeight()-60);},calcImagePages:function(){var h=$(window).height()-150;var w=0;if(FilesFrame.m_mode=='edit_image'){w=$('#FilesFrame').width()-500;}
else{w=$('#FilesFrame').width()-300;}
FilesFrame.m_imagesPerPage=Math.floor((w*h)/4900);FilesFrame.m_numberImagePages=Math.ceil(FilesFrame.m_imageList.length/FilesFrame.m_imagesPerPage);if(FilesFrame.m_numberImagePages<=1){$('.more_link').hide();}
else{$('.more_link').show();}},paintImages:function(){$(".thumb").draggable('destroy');if(FilesFrame.m_imageList==''){if(SidebarFrame.m_folderTagMode){FilesFrame.m_imageList=DataStore.getImagesForCurrentTag();}
else{FilesFrame.m_imageList=DataStore.getImagesForCurrentFolder();}
FilesFrame.calcImagePages();}
var startIndex=FilesFrame.m_imagesPerPage*FilesFrame.m_currentImagePage;var endIndex=Math.min(startIndex+FilesFrame.m_imagesPerPage,FilesFrame.m_imageList.length);var txt="";for(var i=startIndex;i<endIndex;i++){var thumb_url=FilesFrame.m_imageList[i].thumb_url;var post_id=FilesFrame.m_imageList[i].id;var title=FilesFrame.m_imageList[i].title;var thumb_width=FilesFrame.m_imageList[i].thumb_width;var thumb_height=FilesFrame.m_imageList[i].thumb_height;var width=FilesFrame.m_imageList[i].width;var height=FilesFrame.m_imageList[i].height;txt+=FilesFrame.getImageHTML(post_id,thumb_url,title,width,height,thumb_width,thumb_height);}
if(txt==""){txt+="<div style='color:#444444;'>This folder is empty</div>";}
$('#apollo_folder_contents').html(txt);$('#apollo_folder_contents').disableSelection();$('#apollo_folder_contents').noContext();$(".thumb").draggable({revert:true,zIndex:300});},getImageHTML:function(post_id,thumb_url,title,width,height,thumb_width,thumb_height){var txt="";var titleText=title+" ("+width+"px by "+height+"px)";var onclick="FilesFrame.onSelectImage('"+post_id+"')";var mt=0;if(thumb_height<50){mt=(50-thumb_height)/2;}
txt+="<div class='thumbwrapper' align='center' onclick=\""+onclick+"\">";txt+="<span></span>";txt+="<img id='img_"+post_id+"' src='"+thumb_url+"' class='thumb' width='"+thumb_width+"px' height='"+thumb_height+"px' title='"+titleText+"' style='margin-top:"+mt+"px'/>";txt+="</div>";return txt;}}

var GalleriesFrame={m_themeParaID:0,m_currentImagePage:0,m_imagesPerPage:50,m_numberImagePages:0,m_imageList:'',init:function(){},repaint:function(){GalleriesFrame.m_themeParaID=GalleriesFrame.getThemeParaForGalleryPage();if(SidebarFrame.m_folderTagMode){GalleriesFrame.m_imageList=DataStore.getImagesForCurrentTag();}
else{GalleriesFrame.m_imageList=DataStore.getImagesForCurrentFolder();}
GalleriesFrame.calcImagePages();GalleriesFrame.paintGallerySlots();GalleriesFrame.paintImages();},showMultiGalSettings:function(){$('#gallerySettings').show();},calcImagePages:function(){var h=$('#apollo_image_contents_wrapper').height();var w=0;if(GalleriesFrame.m_mode=='edit_image'){w=$('#GalleriesFrame').width()-500;}
else{w=$('#GalleriesFrame').width()-300;}
GalleriesFrame.m_imagesPerPage=Math.floor((w*h)/4900);GalleriesFrame.m_numberImagePages=Math.ceil(GalleriesFrame.m_imageList.length/GalleriesFrame.m_imagesPerPage);if(GalleriesFrame.m_numberImagePages<=1){$('.more_link').hide();}
else{$('.more_link').show();}},showPrevImages:function(){GalleriesFrame.m_currentImagePage--;if(GalleriesFrame.m_currentImagePage<0){GalleriesFrame.m_currentImagePage=GalleriesFrame.m_numberImagePages-1;}
GalleriesFrame.paintImages();},showNextImages:function(){GalleriesFrame.m_currentImagePage++;if(GalleriesFrame.m_currentImagePage>=GalleriesFrame.m_numberImagePages){GalleriesFrame.m_currentImagePage=0;}
GalleriesFrame.paintImages();},getThemeParaForGalleryPage:function(){var page=DataStore.getCurrentPage();for(var i=0;i<DataStore.m_themeParaList.length;i++){if(DataStore.m_themeParaList[i].page_template_name==page.template){if(DataStore.m_themeParaList[i].para_type=='gallery'){return DataStore.m_themeParaList[i].id;}
else if(DataStore.m_themeParaList[i].para_type=='multi-gallery'){GalleriesFrame.showMultiGalSettings();return DataStore.m_themeParaList[i].id;}}}
return 0;},paintGallerySlots:function(){if(!DataStore.isGalleryPage(DataStore.m_currentPageID)){$('#apollo_gallery_contents').html("<p>No gallery selected. Select a gallery from the page list to the left</p>");$('#galleryTitle').html("Gallery Contents");$('#delete_slot').hide();return;}
$('#delete_slot').show();$('.gallery_slot').droppable('destroy');$(".gallery_thumb").draggable('destroy');$('#apollo_gallery_contents').html("");var txt="";var noSlots=23;for(var i=0;i<DataStore.m_galleryImageList.length;i++){var slot=parseInt(DataStore.m_galleryImageList[i].slot_number);if(DataStore.m_galleryImageList[i].theme_para_id==GalleriesFrame.m_themeParaID&&slot>noSlots){noSlots=slot;}}
noSlots=noSlots+2;for(var i=0;i<noSlots;i++){txt+="<div class='gallery_slot' id='slot_"+i+"' align='center'>";txt+="    <div class='gallery_slot_text' align='center'>"+(i+1)+"</div>";txt+="</div>";}
$('#apollo_gallery_contents').html(txt);var page=DataStore.getCurrentPage();$('#galleryTitle').html("Gallery "+page.title);for(var i=0;i<DataStore.m_galleryImageList.length;i++){if((DataStore.m_galleryImageList[i].page_id==DataStore.m_currentPageID)&&(DataStore.m_galleryImageList[i].theme_para_id==GalleriesFrame.m_themeParaID)&&(DataStore.m_galleryImageList[i].gallery_number==DataStore.m_currentGalleryNo)){var img_id=DataStore.m_galleryImageList[i].image_id;var image=DataStore.getImage(img_id);var url=image.thumb_url;var slot_no=DataStore.m_galleryImageList[i].slot_number;$("#slot_"+slot_no).html("<img class='gallery_slot_image gallery_thumb' slot='"+slot_no+"' id='galimg_"+img_id+"' src='"+url+"'/>");}}
$(".gallery_thumb").draggable({revert:false,zIndex:300});$('.gallery_slot').droppable({drop:GalleriesFrame.onDrop,over:function(ev,ui){$(this).addClass('gallery_slot_hover');},out:function(ev,ui){$(this).removeClass('gallery_slot_hover');}});$('#delete_slot').droppable({drop:GalleriesFrame.onRemoveImage,over:function(ev,ui){$(this).addClass('gallery_slot_hover');},out:function(ev,ui){$(this).removeClass('gallery_slot_hover');}});},paintImages:function(){$(".thumb").draggable('destroy');if(GalleriesFrame.m_imageList==''){if(SidebarFrame.m_folderTagMode){GalleriesFrame.m_imageList=DataStore.getImagesForCurrentTag();}
else{GalleriesFrame.m_imageList=DataStore.getImagesForCurrentFolder();}
GalleriesFrame.calcImagePages();}
var startIndex=GalleriesFrame.m_imagesPerPage*GalleriesFrame.m_currentImagePage;var endIndex=Math.min(startIndex+GalleriesFrame.m_imagesPerPage,GalleriesFrame.m_imageList.length);var txt="";for(var i=startIndex;i<endIndex;i++){var thumb_url=GalleriesFrame.m_imageList[i].thumb_url;var post_id=GalleriesFrame.m_imageList[i].id;var title=GalleriesFrame.m_imageList[i].title;var thumb_width=GalleriesFrame.m_imageList[i].thumb_width;var thumb_height=GalleriesFrame.m_imageList[i].thumb_height;var width=GalleriesFrame.m_imageList[i].width;var height=GalleriesFrame.m_imageList[i].height;txt+=GalleriesFrame.getImageHTML(post_id,thumb_url,title,width,height,thumb_width,thumb_height);}
if(txt==""){txt+="<div style='color:#444444;'>This folder is empty</div>";}
$('#apollo_image_contents').html(txt);$('#apollo_image_contents').disableSelection();$('#apollo_image_contents').noContext();$(".thumb").draggable({revert:true,zIndex:300});},getImageHTML:function(post_id,thumb_url,title,width,height,thumb_width,thumb_height){var txt="";var titleText=title+" ("+width+"px by "+height+"px)";var onclick="GalleriesFrame.onSelectImage('"+post_id+"')";txt+="<div class='thumbwrapper' align='center' onclick=\""+onclick+"\">";txt+="<img id='img_"+post_id+"' src='"+thumb_url+"' class='thumb' width='"+thumb_width+"px' height='"+thumb_height+"px' title='"+titleText+"'/>";txt+="</div>";return txt;},onRemoveImage:function(event,ui){img_id=parseInt($(ui.draggable).attr('id').substring(7));prev_slot_id=$(ui.draggable).attr('slot');GalleryAPI.onRemoveImage(DataStore.m_siteID,DataStore.m_currentPageID,img_id,DataStore.m_currentGalleryNo,prev_slot_id,GalleriesFrame.m_themeParaID,GalleriesFrame.onImageRemoved);},onDrop:function(event,ui){var slot_id=0;var img_id=-1;var url='';var image_moved=true;var prev_slot_id=-1;if($(ui.draggable).attr('id').substring(0,3)=='gal'){img_id=parseInt($(ui.draggable).attr('id').substring(7));slot_id=parseInt($(this).attr('id').substring(5));url=$('#galimg_'+img_id).attr('src');prev_slot_id=$(ui.draggable).attr('slot');GalleryAPI.onMoveImage(DataStore.m_siteID,DataStore.m_currentPageID,img_id,prev_slot_id,slot_id,DataStore.m_currentGalleryNo,DataStore.m_currentGalleryNo,GalleriesFrame.m_themeParaID,GalleriesFrame.onImageMoved);}
else{image_moved=false;img_id=parseInt($(ui.draggable).attr('id').substring(4));slot_id=parseInt($(this).attr('id').substring(5));url=$('#img_'+img_id).attr('src');GalleryAPI.onAddImage(DataStore.m_siteID,DataStore.m_currentPageID,img_id,slot_id,DataStore.m_currentGalleryNo,GalleriesFrame.m_themeParaID,GalleriesFrame.onImageAdded);}},onImageMoved:function(gallery_images,gallery_meta){DataStore.onGotGalleryData(gallery_images,gallery_meta);setTimeout("GalleriesFrame.paintGallerySlots()",50);},onImageAdded:function(gallery_images,gallery_meta){DataStore.onGotGalleryData(gallery_images,gallery_meta);setTimeout("GalleriesFrame.paintGallerySlots()",50);},onImageRemoved:function(slot_number){DataStore.removeGalleryImage(slot_number);setTimeout("GalleriesFrame.paintGallerySlots()",50);}}

var PagesFrame={pageObj:false,init:function(){},repaint:function(){$('#postTitle').hide();$('#pageTitle').show();if(DataStore.m_pageList.length==0){AthenaDialog.backgroundMessage("You currently have no pages, you can add a post using the side-bar");return;}
var pageObj=DataStore.getCurrentPage();PagesFrame.repaintData(pageObj);},repaintData:function(pageObj){$('#postSettings').hide();$('#pageSettings').show();oUtil.obj.css=DataStore.m_theme.cms_page_css;oUtil.obj.loadHTML(pageObj.content);$('#pageTitle').val(pageObj.title);$('#pageBrowserTitle').val(pageObj.browser_title)
$('#pageSlug').html(pageObj.slug);$('#pageLastEdit').html(pageObj.last_edit);$('#pageCreated').html(pageObj.created);$('#pageStatusSelector').val(pageObj.status);$('#pageParent').val(pageObj.parent_page_id);$('#pageTemplate').val(pageObj.template);$('#pageOrder').val(pageObj.page_order);$('#pageDesc').val(pageObj.description);var txt="<select id='pageTemplate' onchange=\"PagesFrame.onChange(); PagesFrame.paintThemeParas();\">";for(var i=0;i<DataStore.m_templateList.length;i++){if(DataStore.m_templateList[i].template_file==pageObj.template){txt+="<option value='"+DataStore.m_templateList[i].template_file+"' selected>"+DataStore.m_templateList[i].template_name+"</option>";}
else{txt+="<option value='"+DataStore.m_templateList[i].template_file+"'>"+DataStore.m_templateList[i].template_name+"</option>";}}
txt+="</select>";$('#pageTemplateWrapper').html(txt);PagesFrame.paintParentPages(pageObj);PagesFrame.paintThemeParas();PagesFrame.updatePageLink(pageObj);},updatePageLink:function(pageObj){$('#pageLink').html("View Page");if(pageObj.path=="")pageObj.path="/";$('#pageLink').attr('href','http://'+defines.domain+pageObj.path+pageObj.slug);},updateStatusColor:function(){var status=$('#pageStatusSelector').val();$('#pageStatusSelector').removeClass('status_draft');$('#pageStatusSelector').removeClass('status_private');$('#pageStatusSelector').removeClass('status_public');switch(status){case'Draft':$('#pageStatusSelector').addClass('status_draft');break;case'Private':$('#pageStatusSelector').addClass('status_private');break;case'Published':$('#pageStatusSelector').addClass('status_public');break;}},paintThemeParas:function(){var templateName=$('#pageTemplate').val();var txt=PagesFrame.getThemeParasHTML(templateName,0);if(txt!=""){txt="<p><strong>Custom Parameters</strong></p>"+txt;}
$('#apollo_page_theme_paras').html(txt);},m_themeParaID:0,selectColorPara:function(themeParaID,paraVal){PagesFrame.m_themeParaID=themeParaID;ColorPickerDialog.show('#apollo_color_picker',paraVal,PagesFrame.onParaSelected)},selectImagePara:function(themeParaID){PagesFrame.m_themeParaID=themeParaID;ImagePickerDialog.show('#apollo_image_picker',PagesFrame.onParaSelected)},onParaSelected:function(newParaVal){var page_id=DataStore.m_currentPageID;MediaAPI.setPagePara(PagesFrame.m_themeParaID,newParaVal,page_id,PagesFrame.onPagesParaChanged);},onPagesParaChanged:function(theme_para_id,new_value,page_id){DataStore.updateSitePara(theme_para_id,page_id,new_value);var paraFound=false;for(var i=0;i<DataStore.m_siteParaList.length;i++){if(DataStore.m_siteParaList[i].theme_para_id==theme_para_id){DataStore.m_siteParaList[i].para_value=new_value;paraFound=true;}}
if(!paraFound){var temp=new Object();temp.theme_para_id=theme_para_id;temp.para_value=new_value;temp.page_id=page_id;DataStore.m_siteParaList.push(temp);}
PagesFrame.repaint();},getThemeParasHTML:function(templateName,blogParas){var theme_para_list=DataStore.getPageThemeParas(templateName);var txt="";var noParas=0;for(var i=0;i<theme_para_list.length;i++){if((blogParas==1&&theme_para_list[i].is_blog_para==1)||(blogParas==0&&theme_para_list[i].is_blog_para==0)){var pageID=DataStore.m_currentPageID;if(templateName=='all'){pageID=0;}
var paraVal=DataStore.getSiteParaValue(pageID,theme_para_list[i].id);switch(theme_para_list[i].para_type){case'favicon':case'image':onclick="PagesFrame.selectImagePara("+theme_para_list[i].id+")";txt+="<table border='0'>";txt+="<tr valign='top'>";txt+="    <td width='40px'>";var image_url='';if(paraVal){var image=DataStore.getImage(parseInt(paraVal));if(image){image_url=image.thumb_url}}
txt+="<img src='"+image_url+"' class='thumbBox' width='30px' height='30px' onclick=\""+onclick+"\" >";txt+="    </td>";txt+="    <td>";txt+="        <span class='paraTitle'>"+theme_para_list[i].description+"</span>";txt+="        <span class='paraDesc'>"+theme_para_list[i].help_text+"</span>";txt+="    </td>";txt+="</tr>";txt+="</table>";noParas++;break;case'color':onclick="PagesFrame.selectColorPara("+theme_para_list[i].id+", '"+paraVal+"')";txt+="<table border='0'>";txt+="<tr valign='top'>";txt+="    <td width='40px'>";txt+="        <div class='colorBox' style='background-color:#"+paraVal+";' onclick=\""+onclick+"\"></div>";txt+="    </td>";txt+="    <td>";txt+="        <span class='paraTitle'>"+theme_para_list[i].description+"</span>";txt+="        <span class='paraDesc'>"+theme_para_list[i].help_text+"</span>";txt+="    </td>";txt+="</tr>";txt+="</table>";noParas++;break;case'email':break;case'text':break;case'small-int':break;case'font-family':break;case'font-size':break;case'multi-gallery':case'gallery':break;}}}
if(noParas>0){txt="<table border='0' width='100%'>"+txt+"</table><br/>";}
return txt;},paintParentPages:function(pageObj){var page_id=DataStore.m_currentPageID;var txt='';txt+="<select id='pageParent' onchange=\"PagesFrame.onChange()\">";txt+="    <option value='0'>(none)</selected>";for(var i=0;i<DataStore.m_pageList.length;i++){var isChild=DataStore.isChildOff(page_id,DataStore.m_pageList[i].id);if(DataStore.m_pageList[i].id!=pageObj.id&&!isChild){if(DataStore.m_pageList[i].id==pageObj.parent_page_id){txt+="    <option value='"+DataStore.m_pageList[i].id+"' selected>"+DataStore.m_pageList[i].title+"</selected>";}
else{txt+="    <option value='"+DataStore.m_pageList[i].id+"'>"+DataStore.m_pageList[i].title+"</selected>";}}}
txt+="</select>";$('#parentPageContents').html(txt);},onDeletePage:function(){AthenaDialog.confirm("Are you sure you want to delete this page?",function(){PagesFrame.onDoDelete();});},onDoDelete:function(){MediaAPI.deletePage(DataStore.m_siteID,DataStore.m_currentPageID,PagesFrame.onPageDeleted);},onPageDeleted:function(page_id){DataStore.deletePage(page_id);if(DataStore.m_pageList.length>0){DataStore.m_currentPageID=DataStore.m_pageList[0].id;}
else{DataStore.m_currentPageID=0;}
PagesFrame.repaint();PagesSidebarFrame.repaint();},onChange:function(){var page_id=DataStore.m_currentPageID;var originalPage=DataStore.getPage(page_id);var parent_id=$('#pageParent').val();var pageDepth=DataStore.getPageDepth(DataStore.m_currentPageID);var old_parent_id=originalPage.parent_page_id;originalPage.parent_page_id=parent_id;DataStore.updatePage(originalPage);try{var newDepth=DataStore.getMaxDepth();}
catch(e){var newDepth=99;}
originalPage.parent_page_id=old_parent_id;DataStore.updatePage(originalPage);if((originalPage.parent_page_id!=parent_id)&&(newDepth>DataStore.m_theme.max_page_depth)){AthenaDialog.alert("Sorry, your theme does not support page depths of more than "+DataStore.m_theme.max_page_depth+", please choose another parent page!");return;}
originalPage.content=oUtil.obj.getXHTMLBody();originalPage.title=$('#pageTitle').val();originalPage.browser_title=$('#pageBrowserTitle').val();originalPage.status=$('#pageStatusSelector').val();originalPage.parent_page_id=$('#pageParent').val();originalPage.template=$('#pageTemplate').val();originalPage.page_order=$('#pageOrder').val();originalPage.description=$('#pageDesc').val();originalPage.slug=AthenaUtils.encodeSlug(originalPage.title);originalPage.is_homepage=0;DataStore.updatePage(originalPage);PagesSidebarFrame.repaint();},m_contentChangedTO:'',onContentKeyPress:function(){if(PagesFrame.m_contentChangedTO!=''){clearTimeout(PagesFrame.m_contentChangedTO);}
PagesFrame.m_contentChangedTO=setTimeout(PagesFrame.onChange,500);},saveChildPages:function(){}}

var PostsFrame={postObj:false,init:function(){$('#postTag').keyup(function(e){if(e.keyCode==13){PostsFrame.addTag();}});$('#postCategory').keyup(function(e){if(e.keyCode==13){PostsFrame.addCategory();}});},repaint:function(){$('#postTitle').show();$('#pageTitle').hide();if(DataStore.m_postList.length==0){AthenaDialog.backgroundMessage("You currently have no posts, you can add a post using the side-bar");}
MediaAPI.getPostDetails(DataStore.m_siteID,DataStore.m_currentPostID,PostsFrame.repaintData);},repaintData:function(postObj){PostsFrame.postObj='';PostsFrame.postObj=postObj;$('#postSettings').show();$('#pageSettings').hide();oUtil.obj.css=DataStore.m_theme.cms_blog_css;if(postObj!=undefined){oUtil.obj.loadHTML(postObj.content);$('#postTitle').val(postObj.title);$('#postSlug').html(postObj.slug);$('#postLastEdit').html(postObj.last_edit);$('#postCreated').html(postObj.created);$('#postStatusSelector').val(postObj.status);PostsFrame.updatePostLink(postObj);PostsFrame.updateTagsAndCategoris();}},updatePostLink:function(postObj){var blogPage=DataStore.getBlogPage();if(!blogPage||blogPage==undefined){AthenaDialog.backgroundMessage("You have not set blog page for your site yet.");$('#pageLink').html("");}
else{if(blogPage.status!='Published'){AthenaDialog.backgroundMessage("Your blog page is not public. You can change your blog pages status using the Pages tab");}
var blogslug=blogPage.path+blogPage.slug;var pos=blogslug.indexOf('.html');if(pos>0){blogslug=blogslug.substring(0,pos);}
$('#pageLink').html("View Post");$('#pageLink').attr('href','http://'+defines.domain+blogslug+postObj.path+postObj.slug);}},refreshStatusSelectBox:function(){$('#postStatusSelector').removeClass('select_option_public select_option_draft select_option_private');switch($('#postStatusSelector').val()){case'Published':$('#postStatusSelector').addClass('select_option_public');break;case'Draft':$('#postStatusSelector').addClass('select_option_draft');break;case'Private':$('#postStatusSelector').addClass('select_option_private');break;}},updateTagsAndCategoris:function(){$('#postTag').autocomplete('destroy');$('#postCategory').autocomplete('destroy');$("#postTag").autocomplete({source:DataStore.m_tags});$("#postCategory").autocomplete({source:DataStore.m_categories});var post=PostsFrame.postObj;var txt="";var onclick="";if(post.tags){for(var i=0;i<post.tags.length;i++){onclick="PostsFrame.deleteTag(\""+post.tags[i]+"\")";txt+="<div class='postTagCatLine'><span class='postTagCat'>"+post.tags[i]+"</span><span class='postRemoveTagCat' onclick='"+onclick+"'></span></div>";}
$('#apollo_post_tags').html(txt);}
else{$('#apollo_post_tags').html("");}
if(post.categories){txt="";for(var i=0;i<post.categories.length;i++){onclick="PostsFrame.deleteCategory(\""+post.categories[i]+"\")";txt+="<div class='postTagCatLine'><span class='postTagCat'>"+post.categories[i]+"</span><span class='postRemoveTagCat' onclick='"+onclick+"'></span></div>";}
$('#apollo_post_categories').html(txt);}
else{$('#apollo_post_categories').html("");}},onDeletePost:function(){AthenaDialog.confirm("Are you sure you want to delete this post?",function(){PostsFrame.onDoDelete();});},onDoDelete:function(){MediaAPI.deletePost(DataStore.m_siteID,DataStore.m_currentPostID,PostsFrame.onPostDeleted);},onPostDeleted:function(post_id){DataStore.deletePost(post_id);if(DataStore.m_postList.length>0){DataStore.m_currentPostID=DataStore.m_postList[0].id;}
else{DataStore.m_currentPostID=0;}
PostsFrame.repaint();PostsSidebarFrame.repaint();},onChange:function(){var postObj=DataStore.getPost(DataStore.m_currentPostID);postObj.content=oUtil.obj.getXHTMLBody();postObj.title=$('#postTitle').val();postObj.status=$('#postStatusSelector').val();postObj.canComment=$('#postCanCommentSelector').val();postObj.slug=AthenaUtils.encodeSlug(postObj.title);DataStore.updatePost(postObj);PostsSidebarFrame.repaint();},m_contentChangedTO:'',onContentKeyPress:function(){if(PostsFrame.m_contentChangedTO!=''){clearTimeout(PostsFrame.m_contentChangedTO);}
PostsFrame.m_contentChangedTO=setTimeout(PostsFrame.onChange,500);},addTag:function(){var tag=$('#postTag').val();$('#postTag').val('');MediaAPI.addTag(DataStore.m_siteID,DataStore.m_currentPostID,tag,PostsFrame.onTagAdded);},onTagAdded:function(postObj,tags){DataStore.updatePost(postObj);DataStore.m_tags=tags;PostsFrame.repaint();},addCategory:function(){var cat=$('#postCategory').val();$('#postCategory').val('');MediaAPI.addCategory(DataStore.m_siteID,DataStore.m_currentPostID,cat,PostsFrame.onCategoryAdded);},onCategoryAdded:function(postObj,categories){DataStore.updatePost(postObj);DataStore.m_categories=categories;PostsFrame.repaint();},deleteCategory:function(cat){AthenaDialog.confirm("Are you sure you want to remove this tag from this post?",function(){MediaAPI.removeCategory(DataStore.m_siteID,DataStore.m_currentPostID,cat,PostsFrame.onCategoryDeleted);});},onCategoryDeleted:function(post_id,cat){var post=DataStore.getPost(post_id);var newList=new Array();for(var i=0;i<post.categories.length;i++){if(post.categories[i]!=cat){newList.push(post.categories[i]);}}
post.categories=newList;DataStore.updatePost(post);PostsFrame.repaint();},deleteTag:function(tag){AthenaDialog.confirm("Are you sure you want to remove this tag from this post?",function(){MediaAPI.removeTag(DataStore.m_siteID,DataStore.m_currentPostID,tag,PostsFrame.onTagDeleted);});},onTagDeleted:function(post_id,tag){var post=DataStore.getPost(post_id);var newList=new Array();for(var i=0;i<post.tags.length;i++){if(post.tags[i]!=tag){newList.push(post.tags[i]);}}
post.tags=newList;DataStore.updatePost(post);PostsFrame.repaint();},viewTags:function(){var txt="";for(var i=0;i<DataStore.m_tags.length;i++){onclick="PostsFrame.onDeleteGlobalTag("+i+")";txt+="<div class='postTagCatLine'><span class='postTagCat'>"+DataStore.m_tags[i]+"</span><span class='postRemoveTagCat' onclick='"+onclick+"'></span></div>";}
$('#apollo_dialog').dialog("destroy");$('#apollo_dialog').html(txt);$('#apollo_dialog').dialog({resizable:false,width:$(window).width()*2/3,modal:true,title:"Your Tags",buttons:{Cancel:function(){$(this).dialog('close');}}});},onDeleteGlobalTag:function(tagIndex){AthenaDialog.confirm("Are you sure you want to delete the tag '"+DataStore.m_tags[i]+"' for all your posts? This can not be undone!",function(){PostsFrame.onDoDeleteGlobalTag(tagIndex);});},onDoDeleteGlobalTag:function(tagIndex){MediaAPI.deleteTag(DataStore.m_siteID,DataStore.m_tags[tagIndex],PostsFrame.onGlobalTagDeleted);},onGlobalTagDeleted:function(tag){var new_list=new Array();for(var i=0;i<DataStore.m_tags.length;i++){if(DataStore.m_tags[i]!=tag){new_list.push(DataStore.m_tags[i]);}}
DataStore.m_tags=new_list;PostsFrame.repaint();},viewCategories:function(){var txt="";for(var i=0;i<DataStore.m_categories.length;i++){onclick="PostsFrame.onDeleteGlobalCategory("+i+")";txt+="<div class='postTagCatLine'><span class='postTagCat'>"+DataStore.m_categories[i]+"</span><span class='postRemoveTagCat' onclick='"+onclick+"'></span></div>";}
$('#apollo_dialog').dialog("destroy");$('#apollo_dialog').html(txt);$('#apollo_dialog').dialog({resizable:false,width:$(window).width()*2/3,modal:true,title:"Your Categories",buttons:{Cancel:function(){$(this).dialog('close');}}});},onDeleteGlobalCategory:function(catIndex){AthenaDialog.confirm("Are you sure you want to delete the category '"+DataStore.m_categories[catIndex]+"' for all your posts? This can not be undone!",function(){PostsFrame.onDoDeleteGlobalCategory(catIndex);});},onDoDeleteGlobalCategory:function(catIndex){MediaAPI.deleteCategory(DataStore.m_siteID,DataStore.m_categories[catIndex],PostsFrame.onGlobalCategoryDeleted);},onGlobalCategoryDeleted:function(category){var new_list=new Array();for(var i=0;i<DataStore.m_categories.length;i++){if(DataStore.m_categories[i]!=category){new_list.push(DataStore.m_categories[i]);}}
DataStore.m_categories=new_list;PostsFrame.repaint();}}

var StatsFrame={init:function(){},repaint:function(){}}

var SidebarFrame={m_mode:'',FOLDER_ID_ALL:0,FOLDER_ID_UNASSIGNED:1,FOLDER_ID_LAST_24_HOURS:2,FOLDER_ID_LAST_7_DAYS:3,FOLDER_ID_LAST_1_HOUR:4,init:function(){},repaint:function(){switch(ssMain.view){case ssMain.VIEW_DASHBOARD:case ssMain.VIEW_SETTINGS:case ssMain.VIEW_ACCOUNT:$('#SideBar').html("");SidebarFrame.m_mode='';break;case ssMain.VIEW_POSTS:if(SidebarFrame.m_mode!='Posts'){$('#SideBar').html("");SidebarFrame.m_mode='Posts';SidebarFrame.paintPosts();}
break;case ssMain.VIEW_GALLERIES:if(SidebarFrame.m_mode!='Galleries'){$('#SideBar').html("");SidebarFrame.m_mode='Galleries';SidebarFrame.paintGalleries();SidebarFrame.paintFolders(true);}
break;case ssMain.VIEW_PAGES:if(SidebarFrame.m_mode!='Pages'){$('#SideBar').html("");SidebarFrame.m_mode='Pages';SidebarFrame.paintPages();}
break;case ssMain.VIEW_STATS:if(SidebarFrame.m_mode!='Stats'){$('#SideBar').html("");SidebarFrame.m_mode='Stats';SidebarFrame.paintStatsSidebar();}
break;case ssMain.VIEW_FILES:case ssMain.VIEW_EDITFILES:if(SidebarFrame.m_mode!='Folders'){$('#SideBar').html("");SidebarFrame.m_mode='Folders';SidebarFrame.paintFolders();}
break;}},getHeader:function(){return"<span class='spacer'></span>";},paintPosts:function(){var txt=SidebarFrame.getHeader();txt+="<p>Blog Posts<span class='add_new_project' onclick='PostsSidebarFrame.addPost()' title='Add a new blank post to you blog.'>&nbsp;(add)</span></p>";txt+="<div id='SideBar_Posts'></div>";$('#SideBar').append(txt);PostsSidebarFrame.paint('#SideBar_Posts');},paintGalleries:function(){var txt=SidebarFrame.getHeader();txt+="<p>Pages with Galleries</p>";txt+="<div id='SideBar_Pages'></div>";$('#SideBar').append(txt);GalleriesSidebarFrame.paint('#SideBar_Pages');},paintStatsSidebar:function(){var txt=SidebarFrame.getHeader();txt+="<p>Pages<span class='add_new_project' onclick='PagesSidebarFrame.addPage()' title='Add a new blank page to you site.'>&nbsp;(add)</span></p>";txt+="<div id='SideBar_Pages'></div>";$('#SideBar').append(txt);StatsSidebarFrame.paint('#SideBar_Pages');},paintPages:function(){var txt=SidebarFrame.getHeader();txt+="<p>Pages<span class='add_new_project' onclick='PagesSidebarFrame.addPage()' title='Add a new blank page to you site.'>&nbsp;(add)</span></p>";txt+="<div id='SideBar_Pages'></div>";$('#SideBar').append(txt);PagesSidebarFrame.paint('#SideBar_Pages');},m_folderTagMode:false,showTags:function(){SidebarFrame.m_mode='';SidebarFrame.m_folderTagMode=true;SidebarFrame.repaint();},showFolders:function(){SidebarFrame.m_mode='';SidebarFrame.m_folderTagMode=false;SidebarFrame.repaint();},paintFolders:function(noHeader){var txt="";if(noHeader!=undefined&&noHeader){txt="";}
else{txt=SidebarFrame.getHeader();}
if(!SidebarFrame.m_folderTagMode){txt+="<p>Folders";txt+=" <span class='add_new_project' onclick='FolderSidebarFrame.addFolder()' title='Add a new folder to help organize your images and other media files'>&nbsp;(add)</span>";txt+="</p>";txt+="<div id='SideBar_Folders'></div>";$('#SideBar').append(txt);FolderSidebarFrame.paint('#SideBar_Folders');}
else{txt+="<p>Tags";txt+="</p>";txt+="<div id='SideBar_Folders'></div>";$('#SideBar').append(txt);TagsSidebarFrame.paint('#SideBar_Folders');}}}

var SettingsFrame={init:function(){},repaint:function(){SettingsFrame.paintSiteParas();},paintSiteParas:function(){var txt=SettingsFrame.getThemeParasHTML('all',0);if(txt!=""){$('#apollo_site_settings_custom_paras_2').html(txt);}
var txt=SettingsFrame.getThemeTextParasHTML('all',0);if(txt!=""){$('#apollo_site_settings_custom_paras_1').html(txt);}
$('#apollo_site_settings_custom_paras_1 .customTextInput').typing({stop:SettingsFrame.onSaveTextInputPara,delay:400});},onPaintPostImporter:function(){var txt="";txt+="<p>This tool allows you to import blog posts, comments and followers from other blogging engines.</p>";txt+="<p>To get started, click on the button below that corresponds to the blog you want to import from.</p>";txt+="<br/>";txt+="<div align='center'>";txt+="    <button class='basic_button' onclick='WordpressImporter.show()'>Wordpress</button>";txt+="    <button class='basic_button' onclick='BloggerImporter.show()'>Blogger</button>";txt+="    <button class='basic_button' onclick='LiveJournalImporter.show()'>LiveJournal</button>";txt+="</div>"
txt+="<br/>";txt+="<p>If you need to import from a blog engine not listed above, email us at <a href='mailto:support@apollosites.com?subject=Feature request: New blog import&body=It would be really awesome if you supported imports from my old blog, which is at xxxxx'>support@apollosites.com</a> and we'll try to add that blogging engine to the list as soon as we can!</p>";$('#apollo_dialog').dialog("destroy");$('#apollo_dialog').html(txt);$('#apollo_dialog').dialog({resizable:false,width:400,modal:true,title:"Import Posts",buttons:{Cancel:function(){$(this).dialog('close');}}});},onSaveTextInputPara:function(evt,obj){AthenaDialog.backgroundMessage("Saving new value");var para_id=parseInt(obj.attr('id').substr(7));MediaAPI.setPagePara(para_id,obj.val(),0,SettingsFrame.onTextInputParaSaved);},onTextInputParaSaved:function(theme_para_id,new_value,page_id){DataStore.updateSitePara(theme_para_id,page_id,new_value);},getThemeParasHTML:function(templateName){var theme_para_list=DataStore.getPageThemeParas(templateName);var txt="";var noParas=0;var pageID=DataStore.m_currentPageID;if(templateName=='all')pageID=0;txt+="<p><strong>Images</strong></p>";for(var i=0;i<theme_para_list.length;i++){var blogTxt='';var paraVal=DataStore.getSiteParaValue(pageID,theme_para_list[i].id);if(!paraVal)paraVal="";switch(theme_para_list[i].para_type){case'favicon':case'image':var onclick="SettingsFrame.selectImagePara("+theme_para_list[i].id+")";txt+="<table border='0'>";txt+="<tr valign='top'>";txt+="    <td width='40px'>";var image_url='/admin/images/blank.gif';if(paraVal&&paraVal!=''){var image=DataStore.getImage(parseInt(paraVal));if(image){image_url=image.thumb_url}}
txt+="<img src='"+image_url+"' class='thumbBox' width='30px' height='30px' onclick=\""+onclick+"\" >";txt+="    </td>";txt+="    <td>";txt+="        <span class='paraTitle'>"+theme_para_list[i].description+blogTxt+"</span>";txt+="        <span class='paraDesc'>"+theme_para_list[i].help_text+"</span>";txt+="    </td>";txt+="</tr>";txt+="</table>";noParas++;break;}}
txt+="<p><strong>Colors</strong></p>";for(var i=0;i<theme_para_list.length;i++){var blogTxt='';var paraVal=DataStore.getSiteParaValue(pageID,theme_para_list[i].id);if(!paraVal)paraVal="";switch(theme_para_list[i].para_type){case'color':var onclick="SettingsFrame.selectColorPara("+theme_para_list[i].id+", '"+paraVal+"')";txt+="<table border='0'>";txt+="<tr valign='top'>";txt+="    <td width='40px'>";txt+="        <div class='colorBox' style='background-color:#"+paraVal+";' onclick=\""+onclick+"\"></div>";txt+="    </td>";txt+="    <td>";txt+="        <span class='paraTitle'>"+theme_para_list[i].description+blogTxt+"</span>";txt+="        <span class='paraDesc'>"+theme_para_list[i].help_text+"</span>";txt+="    </td>";txt+="</tr>";txt+="</table>";noParas++;break;}}
if(noParas>0){txt="<table border='0' width='100%'>"+txt+"</table><br/>";}
return txt;},getThemeTextParasHTML:function(templateName){var theme_para_list=DataStore.getPageThemeParas(templateName);var txt="";var noParas=0;var pageID=DataStore.m_currentPageID;if(templateName=='all')pageID=0;txt+="<p><strong>Settings</strong></p>";for(var i=0;i<theme_para_list.length;i++){var blogTxt='';var paraVal=DataStore.getSiteParaValue(pageID,theme_para_list[i].id);if(!paraVal)paraVal="";switch(theme_para_list[i].para_type){case'email':break;case'text':txt+="<table border='0' style='width:100%'>";txt+="    <tr valign='top' rowspan='2' width='100%' style='width:100%'>";txt+="        <td rowspan='2' width='100px'><div class='paraTitle'>"+theme_para_list[i].description+blogTxt+"</div></td>";txt+="        <td><input id='paraID_"+theme_para_list[i].id+"' value='"+paraVal+"' class='customTextInput' style='width:95%;'/></td>";txt+="    </tr>";txt+="    <tr valign='top' width='100%' style='width:100%'>";txt+="        <td><span class='paraDesc' style='width:95%;'>"+theme_para_list[i].help_text+"</span></td>";txt+="    </tr>";txt+="</table>";noParas++;break;case'small-int':break;case'font-family':break;case'font-size':break;case'multi-gallery':case'gallery':break;}}
if(noParas>0){txt="<table border='0' width='100%'>"+txt+"</table><br/>";}
return txt;},m_themeParaID:0,selectColorPara:function(themeParaID,paraVal){SettingsFrame.m_themeParaID=themeParaID;ColorPickerDialog.show('#apollo_color_picker',paraVal,SettingsFrame.onParaSelected)},selectImagePara:function(themeParaID){SettingsFrame.m_themeParaID=themeParaID;ImagePickerDialog.show('#apollo_image_picker',SettingsFrame.onParaSelected)},onParaSelected:function(newParaVal){AthenaDialog.backgroundMessage("Saving new value");page_id=0;MediaAPI.setPagePara(SettingsFrame.m_themeParaID,newParaVal,page_id,SettingsFrame.onPagesParaChanged);},onPagesParaChanged:function(theme_para_id,new_value,page_id){DataStore.updateSitePara(theme_para_id,page_id,new_value);SettingsFrame.repaint();}}
